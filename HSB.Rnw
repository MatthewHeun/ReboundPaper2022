\documentclass[12pt]{article}    % For submission



%% Package imports %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}           % For access to \checkmark.
\usepackage{amsmath}            % For better symbol decorations
\usepackage{authblk}            % For a nice author block
\usepackage{booktabs}           % For nice table rules
\usepackage[official]{eurosym}  % For the euro symbol
\usepackage[figurename=Fig.]{caption} % For changing "Figure" to "Fig." in figure captions
\usepackage{chngcntr}           % To get figure and table numbering correct in the appendices
\usepackage[makeroom]{cancel}   % To show terms go to zero
\usepackage[inline]{enumitem}   % For inline enumeration
\usepackage[letterpaper, left=1in, right=1in, top=1in, bottom=1in, footskip=.25in]{geometry} % For better margins.
\usepackage[pagewise]{lineno}   % For line numbers
% \modulolinenumbers[5]
\usepackage{multicol}           % For multi-column layout
\usepackage{multirow}           % For multi-row layout
\usepackage{natbib}
\usepackage{nccmath}            % For the \useshortskip command above equations
\usepackage{parcolumns}         % For multi-column layout
\usepackage{pdflscape}          % For landscape environment \begin{landscape} ... \end{landscape}
\usepackage{setspace}           % For double spacing
\doublespacing
\usepackage{soul}               % For text highlighting
\usepackage[most]{tcolorbox}    % For color highlighting of text
\usepackage{tikz}               % For diagrams
\usetikzlibrary{arrows,positioning}
\usepackage{ulem}               % For strikeout command (\sout)
\usepackage{xcolor}             % For ... colors

\usepackage{hyperref}           % hyperref should be the last package loaded


%% Macros defined by authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/macros.tex}


%% Bibliography style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{apa-good.bst}

% Author info
\title{Advancing the necessary foundations \\
              for empirical energy rebound estimates: \\
              A partial equilibrium analysis framework}
% \author{Matthew Kuperus Heun, Gregor Semieniuk, Paul E.\ Brockway}
\author[1,*]{Matthew Kuperus Heun}
\author[2]{Gregor Semieniuk}
\author[3]{Paul E.\ Brockway}
\affil[1]{Engineering Department, Calvin University}
\affil[2]{Political Economy Research Institute and 
                            Department of Economics,
                            UMass Amherst}
\affil[3]{Sustainability Research Institute, 
                             School of Earth and Environment,
                             University of Leeds}
\affil[*]{\normalfont{Corresponding author: \texttt{mkh2@calvin.edu}}}
\renewcommand\Affilfont{\itshape\small}

\date{} % Kill the date

\begin{document}

\maketitle


%% Abstract %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
**** This is the old abstract. ****
Widespread implementation of energy efficiency measures
is an important global strategy to meet Paris greenhouse gas emissions reduction targets. 
However, energy rebound can ``take back'' efficiency-based
energy reductions via behavior changes and economic effects.
If rebound effects are larger than typically assumed, 
efficiency-based efforts to reduce carbon emissions 
will be less effective than supposed.
Therefore, the investigation of rebound effects is a high priority. 
% The problem
An operationalized rebound analysis framework is needed
to study energy efficiency upgrades 
for specific energy conversion devices, 
one that discriminates among all rebound effects
in energy, expenditure, and consumption spaces
with a detailed model of consumer responses 
for non-marginal energy efficiency changes.
% Our response
In response, 
we develop a comprehensive, partial equilibrium 
rebound analysis framework to 
describe direct and indirect locations
for emplacement, substitution, and income rebound effects. 
We utilize a macro factor to link
microeconomic to macroeconomic rebound scales.
A sequence of novel graphs shows rebound paths through 
energy, expenditure, and consumption spaces.
The framework is applied to two case studies: 
upgrades of a car and an electric lamp.
% Results
After calibrating the macro factor,
we find total rebound of 48\% and 80\% 
for the car and lamp examples, respectively.
Sensitivity studies are performed, showing the effects of 
energy efficiency, capital cost, energy price, 
energy service price elasticity of energy demand, and 
the macro factor on rebound components.
Implications of rebound for three common energy policies are considered:
energy efficiency standards,
rebates or subsidies, and
carbon pricing or energy taxes.
\end{abstract}




<<setup, echo=FALSE, message=FALSE>>=
library(dplyr)
library(magrittr)
library(MKHthemes)
library(ReboundTools)
library(tidyr)
library(xtable)
@

\linenumbers


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Energy rebound is an interdisciplinary challenge that threatens
a low-carbon future~\citep{Brockway:2017a}.
Rebound makes energy efficiency less effective at reducing carbon emissions
by taking back (or reversing, in the case of ``backfire'') 
energy savings expected from an energy efficiency improvement~\citep{Sorrell:2009cg}.
Rebound is an explanation for why 
energy consumption and carbon emissions 
have never been absolutely decoupled 
from economic growth~\citep{Haberl:2020tf, Brockway:2021ww}.

Recent evidence shows that rebound is both 
(a)~larger than commonly assumed~\citep{Stern2020} and
(b)~mostly missing from large energy and climate models~\citep{Brockway:2021ww},
despite a long history of research on the topic.
Famously, the roots of energy rebound trace back to 
\citeauthor{Jevons:1865} who said 
``[\emph{i}]\emph{t is wholly a confusion of ideas to suppose that the economical 
use of fuel is equivalent to a diminished consumption. 
The very contrary is the truth}'' \citep[p.~103, emphasis in original]{Jevons:1865}.
Less famously, the origins of rebound extend further backward 
from \citeauthor{Jevons:1865}
to \citet{Williams1840} and \citet{Parkes1838}.%
\footnote{
  \citeauthor{Parkes1838} wrote, 
  ``[t]he economy of fuel is the secret of the economy of the steam-engine; 
  it is the fountain of its power, and the adopted measure of its effects. 
  Whatever, therefore, conduces to increase the efficiency of coal, 
  and to diminish the cost of its use, 
  directly tends to augment the value of the steam-engine, 
  and to enlarge the field of its operations''~\citep[p.~161]{Parkes1838}.
}
For nearly 200 years, then, it has been understood 
that efficiency gains may be taken back or, paradoxically even, 
cause growth in energy consumption.

The oil crises of the 1970s shone a light back onto energy efficiency, and 
research into rebound appeared late in that decade~\citep{Madlener:2016to, Saunders:2021te}. 
A modern debate over the magnitude of energy rebound commenced. 
On one side, scholars including \citet{Brookes1979, Brookes1990} and \citet{Khazzoom1980} 
suggested rebound could be large.
Others, including \citet{Lovins1988} and \citet{Grubb1990, Grubb1992},
claimed rebound was likely to be small.
Debate over the size of energy rebound continues today.
Advocates of small rebound (less than, say, 50\%),
suggest ``the rebound effect is overplayed''~\citep[p.~475]{Gillingham:2013aa},
while others, 
including \citet{Saunders2015},
claim the evidence for large rebound
(greater than 50\%)
is growing.

\citeauthor{Turner:2013aa} contends that the lack of consensus 
on the magnitude of rebound 
in the modern empirical literature is caused by 
``a rush to empirical estimation in the absence 
of solid analytical foundations''~\citep[p.~25]{Turner:2013aa}.
\citet{Borenstein:2015aa} made some progress toward solidifying the analytical 
foundations for microeconomic rebound, but
more is needed 
to support empirical estimation efforts.
In the absence of solid analytical foundations, 
the wide variety of rebound estimation approaches yields
a wide range of rebound estimates, 
giving the appearance of uncertainty and
leading energy and climate modelers to either 
(a)~use questionable numbers, or 
(b)~ignore rebound altogether.
We suggest that 
improving the conceptual space around rebound and solidifying the analytical frameworks
will
(a)~help generate more robust estimates of rebound,
(b)~lead to rebound being better included in more energy and climate models, and 
(c)~provide improved policymaking around energy efficiency. 

But why is there an ``absence of solid analytical foundations?''
We propose that development of solid analytical frameworks for rebound
is hampered by the fact that rebound is a decidedly interdisciplinary topic,
involving both economics and energy analysis. 
~\citet[p.~458]{Birol:2000wi} note that 
``different implicit and explicit assumptions of different
research communities (`economists', `engineers') \ldots{} have
in the past led to vastly differing points of view.''%
\footnote{
  We prefer the term ``energy analysts'' over ``engineers,''
  because ``energy analysts'' better describes the group of people 
  interested in topics like rebound and economy-wide energy efficiency.
  **** Should we have a reference to energy analysis here? ****
}
\citeauthor{Turner:2013aa} states that 
``[d]ifferent definitions of energy efficiency will be appropriate in different circumstances. 
However, \ldots{} it is often not clear what different authors 
mean by energy efficiency''~\citep[p.~237--38]{Turner:2013aa}.
If authors from the two disciplines cannot even agree on the terms, 
it is unsurprising that modest progress has been made 
on analytical foundations.
To fully understand rebound, 
economists need to have an energy analyst's understanding of energy, and 
energy analysts need to have an economist's understanding of finance and human behavior.
That's a tall order, indeed.

We contend that new clarity is needed.
A description of rebound is needed that is both
(a)~technically rigorous and
(b)~approachable from both sides
(economics and energy analysis).
In other words, 
the finance and human behavior aspects of rebound need to be presented 
in ways energy analysts can understand. 
And the energy aspects of rebound need to be presented
in ways economists can understand.

Summarizing,
we surmise that reducing global carbon emissions has been hampered, in part, 
by the fact that rebound is not sufficiently included in energy and climate models.
We suspect that one reason rebound is not sufficiently included in energy and climate models
is because of the lack of consensus on rebound estimation methods and, hence, rebound magnitude.
We agree with \citeauthor{Turner:2013aa} that lack of consensus on rebound magnitude
is a symptom of the absence of solid analytical foundations for rebound.
We posit that developing solid analytical frameworks for rebound
is difficult because it is an inherently interdisciplinary topic.

The \emph{objective} of this paper, then, is to 
support the development of a rigorous analytical framework, 
one that
(a)~starts at the microeconomics of rebound
(building upon \citet{Borenstein:2015aa}) and 
(b)~is approachable for both energy analysts and economists.
The key \emph{contributions} of this paper are 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item development of the first (to our knowledge)
        rebound analysis framework that combines 
        embodied energy effects, 
        maintenance and disposal effects, 
        non-marginal energy efficiency increases, and 
        non-marginal energy service price decreases, 

  \item providing the first (to our knowledge) visualizations of rebound effects
        in energy, expenditure, and consumption spaces to assist both 
        energy analysts and economists 
        in understanding nuances of rebound effects,  
        
  \item creating the first (to our knowledge) operationalized link between 
        rebound effects on microeconomic and macroeconomic scales, and 
        
  \item providing tools for other researchers 
        (both energy analysts and economists) 
        to calculate rebound with our framework
        for other energy efficiency upgrades (EEUs).
  
\end{enumerate*}

The remainder of this paper is structured as follows.
Section~\ref{sec:setup} lays the groundwork for our framework and reviews existing literature.
Section~\ref{sec:framework} describes the comprehensive rebound analysis framework.
Section~\ref{sec:examples} provides two examples: 
energy efficiency upgrades to a car and an electric lamp.
Section~\ref{sec:discussion} discusses the results, and 
Section~\ref{sec:conclusion} concludes.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Background}
\label{sec:setup}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%++++++++++++++++++++++++++++++
%\subsection{Rebound analysis frameworks}
%\label{sec:rebound_frameworks}
%++++++++++++++++++++++++++++++

Rebound analysis frameworks are used to estimate the magnitude of rebound effects 
and total rebound from an EEU.
We use the word ``framework'' to mean 
the basic structure for analysis of a system or concept,
in this case energy rebound.
We define a rebound framework to be a rebound typology
applied to the task of estimating rebound for a particular EEU.
A rebound typology is a description and explication of rebound effects, locations, and scales.
Rebound frameworks are operationalized by a series of equations,
typically ending with a summation equation for
total rebound across all effects, locations, and scales.
For accurate analysis of the size of rebound from a given EEU, 
rebound frameworks should be comprehensive, 
accounting for all rebound effects
in energy, expenditure, and consumption spaces
with a detailed model of consumer responses 
to non-marginal energy efficiency changes%
\footnote{
  Note that non-marginal (i.e., large) energy efficiency gains are quite common
  but missing from previous rebound analysis frameworks.
  See Section~\ref{sec:non_marginal_changes}.
}.

In the subsections that follow, 
rebound frameworks are further elucidated, 
starting with features of rebound typologies and analysis spaces.
Thereafter, characteristics of rebound frameworks are discussed, 
including 
the importance of detailed models of consumer preferences, 
the importance of non-marginal energy service price changes, and 
the need for operationality.


%------------------------------
\subsection{Typologies: effects, locations, scales} 
\label{sec:rebound_typologies}
%------------------------------

Any comprehensive rebound framework should include 
in its typology
emplacement, substitution, income, and macro effects.
For a given EEU, 
it cannot be known \emph{a priori}
which rebound effects will be large and which will be small, 
so all effects should be analyzed.
The emplacement effect of an EEU includes 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item expected energy savings, assuming no behavioral changes;
  
  \item embodied energy effects, i.e.\ changes across the EEU of the embodied energy rate 
        of the energy conversion device; and 
        
  \item maintenance and disposal effects 
        (changes in the energy implications of 
        these activities caused by the EEU).
    
\end{enumerate*}
%
The substitution effect accounts for behavior changes across the EEU,
typically increased use of the upgraded device and decreased consumption of other goods due to relative price changes,
assuming no change in device owner utility.
The emplacement and substitution effects create net financial savings
which are spent by the device owner 
in the income effect on more of the energy service and 
more other goods and services. 
Finally, the macro effect accounts for long-run economic expansion 
(and subsequent rising energy consumption),
because the EEU is a cost-saving technological change.

Rebound can occur at direct and indirect locations.
Direct rebound involves takeback of expected savings of energy
consumed by the device.
Indirect rebound arises from increased energy consumption 
in other locations and in other economic sectors
as a result of the EEU.

Rebound scales include microeconomic and macroeconomic.
Rebound at the microeconomic scale arises from the series of adjustments
to the reduction in the implicit price of the energy service. 
A static economy is assumed. 
Microeconomic rebound includes the emplacement, substitution, and income effects.
Rebound at the macroeconomic scale arises from the 
dynamic response of the economy to reach a new stable equilibrium
(between supply and demand for the energy service and other goods)
in response to the EEU.
Macroeconomic rebound involves various short- and long-run effects.

Because a lot is at stake when analyzing energy rebound, 
it is important that rebound analysis frameworks
account for all effects, locations, and scales;
everything is interconnected.
The emplacement effect
frees the device owner's cash to be spent in the income effect,
with energy implications.
The substitution effect describes behavior adjustments that 
provide further net savings to be spent in the income effect, 
again with energy implications.
And greater efficiency gains and 
behavior changes at the microeconomic scale
are likely to lead to larger macroeconomic rebound.
(We note briefly that 
the link between microeconomic and macroeconomic scales 
is largely unexplored territory.
See Section~\ref{sec:macro_effect_main_paper}
for our approach to the macro effect.)


%------------------------------
\subsection{Rebound spaces} 
\label{sec:rebound_spaces}
%------------------------------

A comprehensive rebound framework will enable analyses
in several conceptual ``spaces'' in which changes occur
because of the EEU.
Energy, expenditure, and consumption spaces are all linked together, 
as illustrated by two examples.
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item Net savings from the EEU are determined in the expenditure space.
        Which goods and services are purchased with net savings 
        is determined by consumer preferences and 
        described in the consumption space.
        The energy implications of purchases vary 
        by the types of goods and services purchased
        and is described in the energy space.

  \item The amount of embodied energy in the upgraded device 
        is described in the energy space and
        may be correlated with the cost of device upgrades, 
        which is described in the expenditure space.
        The cost of the upgrade, in turn,
        has implications for what can be consumed, 
        which is described in the consumption space.
    
\end{enumerate*}
%
Tracking changes across all spaces increases understanding 
of causal linkages across rebound effects, locations, and scales.


%------------------------------
\subsection{Consumer preferences} 
\label{sec:consumer_preferences}
%------------------------------

A comprehensive rebound framework will include a detailed description of consumer preferences.
By ``detailed,'' we mean a utility or payoff 
specification that translates
energy service price and device purchase 
cost changes into consumption choices, simultaneously 
decomposing into substitution and income effects. 
These two effects allow for nuanced understanding of behavior
for different commodities and preferences.
Decomposition into substitution and income effects 
has become the standard approach to analyzing
direct and indirect rebound locations 
at the microeconomic scale~\citep{greening2000}.

%------------------------------
\subsection{Non-marginal energy efficiency changes} 
\label{sec:non_marginal_changes}
%------------------------------

A comprehensive rebound analysis framework will allow non-marginal efficiency changes,
because EEUs often involve a large percentage increase in energy efficiency.
A good example of non-marginal energy efficiency changes is 
replacing incandescent lamps with Light Emitting Diode (LED) lamps, 
as discussed in Section~\ref{sec:lamp_example}.
For such EEUs, energy efficiency can increase by nearly a factor of 10.


%------------------------------
\subsection{Operationality} 
\label{sec:operationalizable}
%------------------------------

An operational rebound analysis framework is one that includes
sufficient descriptions of energy rebound 
for all effects, locations, and scales
in all spaces (energy, expenditure, and consumption) to calculate
quantitative estimates of rebound effects with available real-world data.
This is particularly important for microeconomically grounded
rebound frameworks that involve unobserved utility functions and,
by extension, substitution and income effects.


%++++++++++++++++++++++++++++++
\subsection{Previous frameworks} 
\label{sec:previous_frameworks}
%++++++++++++++++++++++++++++++

Bringing together the importance of energy efficiency 
\emph{vis-\`{a}-vis} emissions reduction goals
and the desirable characteristics of rebound frameworks discussed above,
we see that comprehensive frameworks are needed to help develop 
energy efficiency policy to meet emissions targets. 
I.e.\ effective policy should be informed by rebound analyses conducted within
a comprehensive framework.

We develop below (Section~\ref{sec:framework})
a partial equilibrium framework.
Partial equilibrium frameworks provide detailed assessment of individual EEUs
with tractable, easy-to-understand mathematics.
Partial equilibrium frameworks are easy to understand, in part, because
they constrain price variation to the energy service only; 
all other prices remain constant.
In our partial equilibrium framework, 
general equilibrium effects are captured by 
a simplified, one-dimensional, macroeconomic-scale rebound effect
discussed in Section~\ref{sec:macro_effect_main_paper}.

General equilibrium frameworks allow prices of all goods and services 
in an economy to adjust to the EEU.
Recent examples include \citet{Hart2018}, 
\citet{Lemoine:2020aa}, 
\citet{Fullerton2020}, and 
\citet{blackburn2020energy}.
General equilibrium frameworks provide detail and precision 
on economy-wide price adjustments, 
but they give up specificity about individual device upgrades, 
make assumptions during calibration, and
lose simplicity of exposition.  

We are not the first to develop a partial equilibrium rebound analysis framework,
so it is worthwhile to assess previous frameworks for
the key features discussed above: 
analysis at all effects, locations, and scales; 
analysis in energy, expenditure, and consumption spaces; 
level of detail in the consumer preference model;
allowance for non-marginal energy efficiency changes; and 
operationality.
For only when all of the above characteristics are present can  
a comprehensive picture of rebound emerge.
Table~\ref{tab:previous_frameworks} contains our evaluation 
of selected recent partial equilibrium frameworks (in columns)
relative to the characteristics discussed above (in rows).

\renewcommand{\arraystretch}{0.6}

\input{pieces/prev_frameworks_table.tex}

Because all frameworks evaluate the expected decrease 
in direct energy consumption from the EEU,
the ``Direct emplacement effect'' row contains \rating{100} 
in all columns.
Three early papers \citep{Nassen:2009aa, Thomas:2013aa, Thomas:2013ab}
estimate rebound quantitatively, 
earning high marks (\rating{100}) in the ``Operationality'' row. 
Both motivate their frameworks at least partially with microeconomic theory
(consumer preferences and substitution and income effects)
but use simple linear demand functions in their empirical analyses.  
Thus, the connection between economic theory and empirics is tenuous, 
leading to intermediate ratings (\rating{50} or less) in the
``substitution effects,''
``income effects,''
and
``Detailed model of consumer preferences'' rows.
More recently, \citet{Chan2015} and \citet{Wang2021}
anchor the rebound effect firmly in consumer theory, 
earning high ratings (\rating{100}) in the
``substitution effects,''
``income effects,'' and 
``Detailed model of consumer preferences'' rows. 
They extend their frameworks to advanced topics such as
multiple fuels,  
energy services, and
nested utility functions with intermediate inputs. 
However, neither framework exhibits operationality,
earning \rating{0} in the last row of Table~\ref{tab:previous_frameworks}. 
In the middle of the table (and between the other studies in time), 
the framework by \citet{Borenstein:2015aa}
touches on nearly all important characteristics.
However, the \citeauthor{Borenstein:2015aa} framework
cannot separate substitution and income effects cleanly in empirical analysis, 
reverting to partial analyses of both, 
leading to a \rating{50} rating in the ``Detailed model of consumer preferences'' row.

No previous framework engages fully with either the differential financial effects
or the differential energetic effects
of the upfront purchase of the upgraded device, 
leading to low ratings across all previous frameworks in the
``Capital cost and embodied energy effect'' row.
In fact, except for \citet{Nassen:2009aa},
no framework engages with capital costs, 
although all note its importance. 
(\citeauthor{Nassen:2009aa} note that 
capital costs and embodied energy can have very strong effects on rebound.)
\citet{Thomas:2013aa,Thomas:2013ab} provide the only framework 
that traces embodied energy effects
of every consumer good using input-output methods, but
they do not analyze embodied energy of the upgraded device.
\citet{Borenstein:2015aa} notes
the embodied energy of the upgraded device
and the embodied energy of other goods
but does not integrate embodied energy
or financing costs into the framework for empirical analysis. 
\citeauthor{Borenstein:2015aa} is the only author to treat the financial side of 
embodied energy or maintenance and disposal effects. 
\citet{Borenstein:2015aa} postulates the macro effect, 
but does not develop the idea into an operational theory, 
earning \rating{25} in the ``Macro effect'' row. 
No other frameworks even discuss the link between macro and micro rebound effects, 
leading to \rating{0} in the ``Macro effect'' row for all other previous frameworks. 
Finally, all previous frameworks assume constant price elasticities and
implicitly ``marginal'' or small improvements in efficiency, 
excluding the analysis of important non-incremental upgrades
where price elasticities are likely to vary. 
Therefore, all previous frameworks earn \rating{0} in the 
``Non-marginal energy service price changes'' row.

Table~\ref{tab:previous_frameworks} shows that 
previous frameworks contain many needed pieces, 
providing a substantial base from which to develop 
a comprehensive and operational rebound analysis framework.
A left-to-right reading of the table 
demonstrates that previous frameworks start from micoreconomic
consumer theory and move towards more rigorous theoretical treatment over time,
with recent frameworks making important advanced theoretical contributions
at the expense of operationality.
In the end, no previous rebound analysis framework 
combines all rebound effects, locations, and scales
across energy, expenditure, and consumption spaces with 
a detailed model of consumer preferences and
non-marginal energy service price changes
in an operational manner
for the simplest case
of a single fuel and a single energy service.
In particular, non-marginal price changes and the macro effect
require conceptual development and operationalization.
This paper aims to address the gaps in Table~\ref{tab:previous_frameworks},
completing the ``This paper'' column with filled circles (\rating{100}).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods: development of the comprehensive rebound framework}
\label{sec:framework}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we develop a comprehensive energy rebound analysis framework 
(concisely, ``this framework'').
We follow the rebound typology discussed in Section~\ref{sec:rebound_typologies}, 
distinguishing between
microeconomic rebound (at the single device or for the device owner)
and 
macroeconomic rebound (broader, economy-wide responses
to a single device upgrade).
(See \citet{greening2000}, \citet{Barker2009}, and \citet{FontVivanco2018}.) 
We follow others, including \citet{Jenkins2011} and \citet{Walnum2014}, 
in splitting microeconomic rebound into 
direct and indirect locations.
Like other authors, we recognize many macroeconomic effects, 
even if we don't later distinguish among them.
\citet{Sorrell:2009cg} 
sets out five macroeconomic rebound effects:
embodied energy effects, respending effects, output effects, energy market effects, and composition effects.
(We place the embodied energy effect at the microeconomic scale.)
\citet{Santarius2016} and \citet{Lange2021} 
introduce 
meso (i.e., sectoral) level rebound
between the micro and macro levels.
\citet{VandenBergh2011} distinguishes 14 types of rebound, 
providing, perhaps, the greatest complexity. 

Fig.~\ref{fig:flowchart} shows rebound effects
arranged in left-to-right order of their discussion in this paper.
Rebound symbols are shown above each effect ($Re_{empl}$, etc.).
Nomenclature for direct and indirect locations are shown beneath each effect ($Re_{dempl}$, etc.).
Decorations for each stage are shown between rebound effects
($\circ$, $*$, etc.).
Names for the decorations are given at the bottom of the figure
(``orig,'' ``star,'' etc.)%
\footnote{
  Note that
  the vocabulary and mathematical notation for rebound effects is extensive;
  Fig.~\ref{fig:flowchart} and Appendix~\ref{sec:nomenclature} provide guides to 
  notational elements used throughout this paper, including
  symbols, Greek letters, abbreviations, decorations, and subscripts.
  The notational elements 
  can be mixed to provide a rich and expressive ``language'' of energy rebound.
  In several places, we use colored backgrounds on rebound effects for visual convenience. 
}.
The left-to-right order does not necessarily represent 
the progression of rebound effects through time.

\begin{figure}
\centering
  % The file is a Tikz picture.
  \input{pieces/flowchart.tex}
\caption{Flowchart of rebound effects and decorations.}
\label{fig:flowchart}
\end{figure}


%++++++++++++++++++++++++++++++
\subsection{Rebound effects}
\label{sec:rebound_mechanisms}
%++++++++++++++++++++++++++++++

We assume an energy conversion device (say, a car)
that consumes final energy%
\footnote{
  Conventionally, stages of the energy conversion chain are 
  primary energy (e.g., coal, oil, natural gas, wind, and solar),
  final energy (e.g., electricity and refined petroleum),  
  useful energy (e.g., heat, light, and mechanical drive), and 
  energy services (e.g., transport, illumination, and space heating).
}
%
(say, gasoline) at a rate $\rbempl{E}$ (in MJ/year).
The final energy is available at price $p_E$ (in \$/MJ).
The energy conversion device provides a rate of energy service 
$\rbempl{q}_s$ (in vehicle-km/year)
with final-to-service efficiency $\bempl{\eta}$ (in vehicle-km/MJ).
An energy efficiency upgrade (EEU) increases
final-to-service efficiency%
\footnote{
  Note that energy service efficiency ($\eta$) improves
  between the original ($\circ$) and
  post-emplacement ($*$)
  stages of Fig.~\ref{fig:flowchart}, remaining constant thereafter.
  Thus, $\orig{\eta} < \aempl{\eta} = \asub{\eta} = \ainc{\eta} = \amacro{\eta}$,
  as shown in Table~\ref{tab:analysis_assumptions}.
  We refer to all post-emplacement efficiencies 
  ($\aempl{\eta}$, $\asub{\eta}$, $\ainc{\eta}$, and $\amacro{\eta}$)
  as $\amacro{\eta}$
  to match the nomenclature of \citet{Borenstein:2015aa}.
  When convenient, the same approach to nomenclature is taken with other quantities such as 
  the capital cost rate ($\rate{C}_{cap}$) and 
  maintenance and disposal cost rate ($\rate{C}_{md}$).
}
such that
$\amacro{\eta} > \bempl{\eta}$,
possibly at an increased cost to
emplace (capital cost), maintain, and dispose of the device such that
$\bempl{C}_{cap} < \amacro{C}_{cap}$ and 
$\rbempl{C}_{\md} < \ramacro{C}_{\md}$.
(This is not a costless EEU.)
As final-to-service efficiency increases ($\bempl{\eta} < \amacro{\eta}$),
the price of the energy service declines ($\bempl{p}_s > \amacro{p}_s$).
The final energy price ($p_E$) is assumed exogenous
($\bempl{p}_E = \bsub{p}_E = \binc{p}_E = \bmacro{p}_E  = \amacro{p}_E$),
so the final energy purchaser (the device owner) is a price taker%
\footnote{
  Relaxing the exogenous final energy price assumption
  would require a general equilibrium model that is beyond the scope of this paper.
  Rebound due to energy price change is included in the macro effect.
}.
%
Initially, the device owner spends income ($\rorig{M}$)
on final energy for the device ($\rorig{C}_s = p_E \rorig{E}_s$), 
annualized capital costs for the device ($\rorig{C}_{cap}$), 
annualized costs for maintenance and disposal of the device ($\rorig{C}_{\md}$), and 
other goods and services ($\rorig{C}_o$).
The budget constraint
for the device owner is

\begin{equation} \label{eq:budget_constraint}
  \rorig{M} = \rorig{C}_s + \rorig{C}_{cap} + \rorig{C}_{\md} + \rorig{C}_{o} + \cancelto{0}{\rorig{N}} \; ,
\end{equation}
%
where 
original net savings ($\rorig{N}$) is zero.

Later (Sections~\ref{sec:empl_effect_main_paper}--\ref{sec:macro_effect_main_paper}), 
we walk through four rebound effects, 
deriving rebound expressions for each. 
But first 
we define rebound relationships 
(Section~\ref{sec:rebound_relationships}),  
show typical energy and cost relationships 
(Section~\ref{sec:energy_and_cost_relationships}), and 
introduce rebound path graphs
(Section~\ref{sec:rebound_path_graphs}).


%++++++++++++++++++++++++++++++
\subsection{Rebound relationships}
\label{sec:rebound_relationships}
%++++++++++++++++++++++++++++++

Energy rebound is defined as

\begin{equation} \label{eq:Re_def}
  Re \equiv 1 - \frac{\text{actual final energy savings rate}}{\text{expected final energy savings rate}} \; ,
\end{equation}
%
where both actual and expected final energy savings rates are in \$/year 
and expected positive.
Final energy ``takeback'' rate is defined as expected final energy savings rate less 
actual final energy savings rate.
Note that the takeback rate can be negative, indicating that the actual final energy savings rate
is greater than the expected final energy savings rate, 
a condition called hyperconservation.
Thus,

\begin{equation}
  Re = 1 - \frac{\text{expected final energy savings rate} - \text{takeback rate}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Simplifying gives

\begin{equation} \label{eq:Re_takeback}
  Re = \frac{\text{takeback rate}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Energy rebound can be given by either Eq.~(\ref{eq:Re_def}) or Eq.~(\ref{eq:Re_takeback}).

We define rebound at the final energy stage of the energy conversion chain,
because that is the point of energy purchase by the device owner.
To simplify derivations, 
we choose not to apply final-to-primary energy multipliers
to final energy rates in the numerators and denominators of rebound expressions
derived from Eqs.~(\ref{eq:Re_def}) and~(\ref{eq:Re_takeback});
they divide out anyway.
Henceforth, we drop the adjective ``final'' 
from the noun ``energy,''
unless there is reason to indicate a specific stage of the energy conversion chain.


%++++++++++++++++++++++++++++++
\subsection{Typical energy and cost relationships}
\label{sec:energy_and_cost_relationships}
%++++++++++++++++++++++++++++++

With the rebound notation of Appendix~\ref{sec:nomenclature}, 
four typical relationships emerge.
First, the consumption rate of the energy service~($\rate{q}_s$)
is the product of final-to-service efficiency~($\eta$) and
the rate of energy consumption by the energy conversion device~($\rate{E}_s$).
Typical units for automotive transport and illumination
(the examples in Section~\ref{sec:examples}) are shown
beneath each equation%
\footnote{
  Note that ``pass'' is short for ``passenger,'' and
  ``lm'' is the SI notation for the lumen, a unit of lighting energy rate.
}.

\begin{align} \label{eq:typ_qs_eta_Edot}
  \rate{q}_s &= \eta \rate{E}_s \\
  \text{[pass-km/yr]} &= \text{[pass-km/MJ]} \text{[MJ/yr]} \nonumber \\
  \text{[lm-hr/yr]} &= [\text{lm-hr/MJ}] \text{[MJ/yr]} \nonumber
\end{align}
%
Second, the energy service price~($p_s$) is the ratio of energy price~($p_E$) 
to the final-to-service efficiency~($\eta$).

\begin{align} \label{eq:ps_pE_eta}
  p_s &= \frac{p_E}{\eta} \\
  \text{[\$/pass-km]} &= \frac{[\$/\text{MJ}]}{\text{[pass-km/MJ]}} \nonumber \\
  \text{[\$/lm-hr]} &= \frac{[\$/\text{MJ}]}{\text{[lm-hr/MJ]}} \nonumber
\end{align}
%
Third, energy service expenditure rates~($\rate{C}_s$) are the product 
of energy price~($p_E$) and device energy consumption rates~($\rate{E}_s$).

\begin{align}
  \rate{C}_s &= p_E \rate{E}_s \\
  \text{[\$/yr]} &= \text{[\$/MJ]}\text{[MJ/yr]} \nonumber
\end{align}
%
Fourth, indirect energy rates~($\rate{E}_j$)
for maintenance and disposal ($j = \md$) and other goods expenditures ($j = o$)
are the product 
of expenditures rates~($\rate{C}_j$) and energy intensity of the economy~($I_E$).

\begin{align} \label{eq:indirect_energy_rates}
  \rate{E}_j &= \rate{C}_j I_E \\
  \text{[MJ/yr]} &= \text{[\$/yr]}\text{[MJ/\$]} \nonumber
\end{align}


%++++++++++++++++++++++++++++++
\subsection{Rebound path graphs}
\label{sec:rebound_path_graphs}
%++++++++++++++++++++++++++++++

Any comprehensive rebound analysis must track
energy, expenditure, and consumption
at the device (direct location) and elsewhere in the economy (indirect location)
across all adjustments for all rebound effects. 
One novel contribution of this paper is visualization of rebound effects 
in three spaces:
the energy space, the expenditure space, and the consumption space.
Each space is represented by a plane that contains a path graph that illustrates adjustments
to energy, expenditure, or consumption as a result of the EEU.
(See Appendix~\ref{sec:graph_details} for 
detailed mathematical descriptions of rebound path graphs.)
Important quantities for the path graphs are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item direct and indirect energy consumption rates ($\rate{E}_{dir}$, $\rate{E}_{indir}$), 
  
  \item direct and indirect expenditure rates ($\rate{C}_{dir}$ and $\rate{C}_{indir}$), 
  
  \item the consumption rate of the energy service ($\rate{q}_s$), and
  
  \item the expenditure rate on other consumption goods ($\rate{C}_o$).
    
\end{enumerate*}
%
In rebound path graphs, effects at the direct location are placed on the $x$-axis, and 
effects at the indirect location are placed on the $y$-axis.

Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph} show
notional rebound path graphs in energy, expenditure, and consumption spaces.
The notional path graphs are not quantified; there are no scales on the axes.
Later (Section~\ref{sec:examples}), 
rebound path graphs (with scales) illustrate the numerical examples.

Fig.~\ref{fig:ExampleEnergyPathGraph} shows a notional energy path graph, with 
the direct energy consumption rate ($\rate{E}_{dir}$) on the $x$-axis
and
the indirect energy consumption rate ($\rate{E}_{indir}$) on the $y$-axis.
Points $\circ$, $*$, $\wedge$, $-$, and $\sim$ represent the rebound stages
between the rebound effects,
as shown in Fig.~\ref{fig:flowchart}.
Points $a$, $b$, $c$, and $d$ represent intermediate stages.
Lines with negative slope through points 
$\circ$, $a$, $*$, $\wedge$, $-$, and $\sim$
indicate energy consumption isoquants
(sum of direct and indirect components) at key points.
Table~\ref{tab:path_graph_segments} shows 
segments and rebound effects for all rebound path graphs.
Note that segment \bartilde{} appears only on energy path graphs, 
because the framework tracks energy consumption but not expenditures or consumption
in the macro effect.

\begin{table}
\centering % Centered table
\caption{Rebound path graph segments.} 
\begin{tabular}{r l l c}
  \toprule
  Segment      & Rebound effect            & Symbol          & Equation \\
  \midrule
  \circa{}     & Direct emplacement        & $Re_{dempl}$    & (\ref{eq:Re_dempl0}) \\
  \ab{}        & Embodied energy           & $Re_{emb}$      & (\ref{eq:Re_emb}) \\
  \bstar{}     & Maintenance and disposal  & $Re_{\md}$      & (\ref{eq:Re_md}) \\
  \midrule
  \starc{}     & Indirect substitution     & $Re_{isub}$     & (\ref{eq:Re_isub_CES}) \\ 
  \chat{}      & Direct substitution       & $Re_{dsub}$     & (\ref{eq:Re_dsub_CES}) \\ 
  \midrule
  \hatd{}      & Direct income             & $Re_{dinc}$     & (\ref{eq:Re_dinc}) \\ 
  \dbar{}      & Indirect income           & $Re_{iinc}$     & (\ref{eq:Re_iinc}) \\ 
  \midrule
  \bartilde{}  & Macro                     & $Re_{macro}$    & (\ref{eq:Re_macro_def}) \\
  \bottomrule
\end{tabular}
\label{tab:path_graph_segments}
\end{table}

A notional expenditure path graph is shown in Fig.~\ref{fig:ExampleCostPathGraph}, 
with 
the direct expenditure rate on the energy service ($\rate{C}_{dir}$) on the $x$-axis and 
the indirect expenditure rate ($\rate{C}_{indir}$) on the $y$-axis.
Lines with negative slope through points $\circ$, $a$, $*$, and $\wedge$
indicate expenditure isoquants (sum of direct and indirect components).

A notional consumption path graph is shown in Fig.~\ref{fig:ExampleConsPathGraph}.
The indexed rate of energy service demand ($\rate{q}_s/\rbempl{q}_s$) is shown on the $x$-axis, and
the indexed rate of other goods demand ($\rate{C}_o/\rbempl{C}_o$) is shown on the $y$-axis.
Iso-cost loci of energy service and other goods demand
are shown as lines with negative slope. 
Indifference curves are denoted by \iicirc{} and \iibar{}. 
A ray from the origin through the $\wedge$ point is denoted \rr{}.
Note that points $\circ$, $a$, $b$, and $*$ collapse together
on consumption path graphs, because both
the rate of energy service consumption and 
the rate of other goods consumption are
unchanged across the emplacement effect
($\rbempl{q}_s = \raempl{q}_s$ and $\rbempl{C}_o = \raempl{C}_o$, respectively).

<<eeu_data, echo=FALSE>>=
# Load our test cases and perform rebound analyses.
rebound_data <- ReboundTools::load_eeu_data("data/eeu_data.xlsx")
rebound_results <- ReboundTools::rebound_analysis(rebound_data)
@


<<ExampleEnergyPathGraph,  echo=FALSE, warning=FALSE, fig.cap="Notional energy path graph.", fig.width=6, fig.height=4>>=
stage_size <- 10
orig_size <- stage_size
star_size <- stage_size
hat_size <- stage_size - 3
bar_size <- stage_size - 5
tilde_size <- stage_size - 5

stage_colour <- "black"
abcd_size <- 4
abcd_colour <- "darkgray"

annotation_angle <- -45.6
annotation_size <- 4
annotation_colour <- "black"

example_arrow_angle <- 19.0 * pi/180
example_arrow_size <- 0.5 # width

example_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                         1.01, 1.008, 'degree', 
                                           stage_colour, orig_size, 0,
                                         0.11, 1.008, 'a', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.973, 'b', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.95, '"*"', 
                                           stage_colour, star_size, 0,
                                         0.09, 0.935, 'c', 
                                           abcd_colour, abcd_size, 0,
                                         0.2432, 0.923, '"^"', 
                                           stage_colour, hat_size, 0,
                                         0.2727, 0.932, 'd', 
                                           abcd_colour, abcd_size, 0,
                                         0.295, 1.033, 'bold("_")', 
                                           stage_colour, bar_size, 0,
                                         0.29, 1.126, '"~"', 
                                           stage_colour, tilde_size, 0,
                                         0.04, 0.923, 'Hyperconservation', 
                                           annotation_colour, 
                                           annotation_size-1,
                                           annotation_angle,
                                         0.02, 1.043, 'Re[tot] == 0*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.033, 1.004, 'Re[empl]', 
                                           annotation_colour,  
                                           annotation_size - 1, 
                                           annotation_angle + 90,
                                         0.21, 0.90, 'Re[sub]', 
                                           annotation_colour, 
                                           annotation_size - 1,
                                           annotation_angle + 90,
                                         0.39, 0.936, 'Re[inc]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.68, 0.935, 'Re[macro]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.754, 1.1, 'Re[tot] == 100*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.95, 1.1, 'Backfire', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle)
example_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                     # Re_empl arrow
                                     0.078, 1.01, example_arrow_angle, 
                                       -0.063, annotation_colour, example_arrow_size,
                                     # Re_sub arrow
                                     0.249, 0.904, example_arrow_angle, 
                                       0.042, annotation_colour, example_arrow_size,
                                     # Re_inc arrow
                                     0.329, 0.905, example_arrow_angle, 
                                       0.154, annotation_colour, example_arrow_size,
                                     # Re_macro arrow
                                     0.622, 0.904, example_arrow_angle, 
                                       0.14, annotation_colour, example_arrow_size) 
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Energy", 
                               indexed = TRUE) + 
  ggplot2::xlim(0, 1.1) +
  ggplot2::ylim(0.9, 1.15) +
  ggplot2::xlab(expression(dot(E)[dir] * " [MJ/year]")) +
  ggplot2::ylab(expression(dot(E)[indir] * " [MJ/year]")) +
  ggplot2::geom_spoke(data = example_Re_arrows,
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle,
                                               radius = radius,
                                               colour = colour),
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = example_energy_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExampleCostPathGraph, echo=FALSE, fig.cap="Notional expenditure path graph. CV is compensating variation.", fig.width=6, fig.height=4>>=
cost_line_angle <- -14
example_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                       1.01, 1.003, 'degree', 
                                       stage_colour, orig_size, 0,
                                       0.098, 1.003, 'a', 
                                       abcd_colour, abcd_size, 0,
                                       0.09, 0.972, 'b', 
                                       abcd_colour, abcd_size, 0,
                                       0.128, 0.955, '"*"', 
                                       stage_colour, star_size, 0,
                                       0.09, 0.936, 'c', 
                                       abcd_colour, abcd_size, 0,
                                       0.24, 0.9385, '"^"', 
                                       stage_colour, hat_size, 0,
                                       0.283, 0.937, 'd', 
                                       abcd_colour, abcd_size, 0,
                                       0.285, 1.034, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                       0.635, 1.019, 'Original~expenditure', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.43, 0.9445, 'After~emplacement', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.55, 0.9835, 'After~expected~savings', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.17, 0.9425, 'After~CV', 
                                       annotation_colour, annotation_size-1, cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Expenditure", 
                               indexed = TRUE) + 
  # ggplot2::xlim(0, 1.1) +
  # ggplot2::ylim(0.9995, 1.0005) +
  ggplot2::xlab(expression(dot(C)[dir] * " [$/year]")) +
  ggplot2::ylab(expression(dot(C)[indir] * " [$/year]")) +
  
  ggplot2::geom_text(data = example_cost_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExampleConsPathGraph, echo=FALSE, warning=FALSE, fig.cap="Notional consumption path graph.", fig.width=6, fig.height=4>>=
orig_line_label_size <- orig_size - 3
star_line_label_size <- star_size - 4
hat_line_label_size <- hat_size - 3
bar_line_label_size <- bar_size - 1
r_line_label_size <- abcd_size
i_line_label_size <- abcd_size
line_label_colour <- "darkgray"
  
labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                          1.05, 1.005, 'degree', 
                            annotation_colour, orig_size,
                          1.09, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.14, 1.0052, 'a', 
                            abcd_colour, abcd_size,
                          1.18, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.22, 1.006, 'b', 
                            abcd_colour, abcd_size,
                          1.258, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.315, 1.001, '"*"', 
                            annotation_colour, star_size,
                          0.7, 1.01, 'degree', 
                            line_label_colour, orig_line_label_size,
                          1.56, 0.97, 'degree',
                            line_label_colour, orig_line_label_size,
                          0.7, 0.995, '"*"', 
                            line_label_colour, star_line_label_size,
                          3.5, 0.981, '"*"', 
                            line_label_colour, star_line_label_size,
                          0.96, 0.98, 'c', 
                            abcd_colour, abcd_size,
                          2.2, 0.9834, '"^"',  
                            annotation_colour, hat_size,
                          0.7, 0.989, '"^"',
                            line_label_colour, hat_line_label_size,
                          3.5, 0.975, '"^"', 
                            line_label_colour, hat_line_label_size,
                          2.52, 0.984, 'd', 
                            abcd_colour, abcd_size,
                          2.43, 1.085, 'bold("_")',  
                            annotation_colour, bar_size,
                          0.7, 1.0873, '"_"',
                            line_label_colour, bar_line_label_size,
                          3.5, 1.073, '"_"',
                            line_label_colour, bar_line_label_size,
                          2.18, 0.97, 'r',
                            line_label_colour, r_line_label_size,
                          2.6, 1.15, 'r',  
                            line_label_colour, r_line_label_size,
                          0.75, 1.027, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          3.4, 0.981, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          0.75, 1.143, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          3.4, 1.084, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Consumption") + 
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.97, 1.15) +
  ggplot2::geom_text(data = labels, 
                     mapping = ggplot2::aes(x = x, y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


%++++++++++++++++++++++++++++++
\subsection{Rebound effects}
\label{sec:rebound_effects}
%++++++++++++++++++++++++++++++

The four rebound effects
(emplacement, substitution, income, and macro)
shown in the rebound path graphs
are discussed in subsections below.
In each subsection, we
define each effect and
show mathematical expressions for rebound ($Re$) caused by each effect.
The notional rebound path graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph})
serve to illustrate the development of the framework.
Detailed derivations of all rebound expressions 
can be found in Appendix~\ref{sec:derivation}.
See, in particular, Tables~\ref{tab:empleffect}--\ref{tab:macroeffect},
which provide a parallel structure for energy and financial accounting
across all rebound effects.
We begin with the emplacement effect.


%------------------------------
\subsubsection{\Empleffect}
\label{sec:empl_effect_main_paper}
%------------------------------

The emplacement effect (segments \circa{}, \ab{}, and \bstar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph})
accounts for performance of the EEU only;
behavior changes are addressed later, 
in the substitution and income effects. 
The direct emplacement effects of the EEU include
device energy savings ($\Sdot$) and device energy cost savings ($\Delta \raempl{C}_s$),
on segments \circa{} in Figs.~\ref{fig:ExampleEnergyPathGraph} 
and~\ref{fig:ExampleCostPathGraph}, respectively.
The indirect effects of EEU emplacement are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item changes in the embodied energy rate ($\Delta \raempl{E}_{emb}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}), 
  
  \item changes in the capital expenditure rate ($\Delta \raempl{C}_{cap}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleCostPathGraph}), and 
        
  \item changes in the maintenance and disposal energy and expenditure rates 
        ($\Delta \raempl{E}_{\md}$ and $\Delta \raempl{C}_{\md}$)
        (segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and \ref{fig:ExampleCostPathGraph}).
    
\end{enumerate*}

The rate of energy savings
due to the direct emplacement effect  
($\Sdot$, segment \circa{} in Fig.~\ref{fig:ExampleEnergyPathGraph})
is given by

\begin{equation} \label{eq:S_dot_def}
  \Sdot \equiv \rbempl{E}_s - \raempl{E}_s = - \Delta \raempl{E}_s \; .
\end{equation}
%
$\Sdot$ can be rewritten conveniently as

\begin{equation} \label{eq:Sdot}
  \Sdot = \Sdoteqn \; .
\end{equation}
%
(See Appendix~\ref{sec:Sdot} for the derivation.)

Because behavior changes are not considered
in the direct emplacement effect,
actual and expected energy savings rates are identical, and there is no takeback.
By definition, then, the direct emplacement effect causes no rebound.
Thus, 

\begin{equation} \label{eq:Re_dempl0}
  Re_{dempl} = 0 \; .
\end{equation}
%
In the notional energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}, 
point $a$ lies on the $Re_{tot} = 0\%$ line
indicating that point $a$ (and the $Re_{tot} = 0\%$ line)
is the point from which all rebound effects 
($Re_{empl}$, $Re_{sub}$, $Re_{inc}$, and $Re_{\macro}$)
are measured.
If rebound effects cause 
total energy demand to return to the original energy consumption level 
(negative sloping line through the $\circ$ point), 
all expected energy savings are taken back by rebound effects. 
Thus, the line of constant energy consumption through the $\circ$ point is labeled
$Re_{tot} = 100\%$.
The contribution of each rebound effect to total rebound 
is represented by the distance that each component's segment
moves across the rebound isoquants.  
Total rebound ($Re_{tot}$) is measured linearly between and beyond the
$Re_{tot} = 0\%$ and $Re_{tot} = 100\%$ lines, 
with direct rebound in the $x$ direction and 
indirect rebound in the $y$ direction.
The region below and to the left of the $Re_{tot} = 0\%$ line
in Fig.~\ref{fig:ExampleEnergyPathGraph}
exhibits negative rebound, indicating hyperconservation.
The region above and to the right of the $Re_{tot} = 100\%$ line 
shows backfire, 
i.e.\ greater total energy consumption after the EEU than before it. 

Although the direct emplacement effect does not cause rebound, 
Fig.~\ref{fig:ExampleEnergyPathGraph} shows that
indirect emplacement effects may indeed cause rebound.
Indirect emplacement effects 
(segments \ab{} and \bstar{}
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}) 
account for the life cycle of the energy conversion device,
including energy embodied by manufacturing processes (subscript $emb$) and
maintenance and disposal activities (subscript $\md$).
In the notional energy path graph (Fig.~\ref{fig:ExampleEnergyPathGraph}), 
emplacement rebound is negative ($Re_{empl} < 0$),
because the upgraded device has a lesser
embodied energy rate ($\rbempl{E}_{emb} > \raempl{E}_{emb}$)
and a lesser maintenance and disposal expenditure rate ($\rbempl{C}_{\md} > \raempl{C}_{\md}$)
than the original device.
Fig.~\ref{fig:ExampleCostPathGraph} shows segments \ab{} and \bstar{}
moving in the negative $y$ direction,
consistent with a lower capital expenditure rate
($\rbempl{C}_{cap} > \raempl{C}_{cap}$) and 
a reduced maintenance and disposal expenditure rate
($\rbempl{C}_{\md} > \raempl{C}_{\md}$).

One of the unique features of this framework
is that independent analyses of embodied energy and 
capital costs of the EEU are expected.
We note that the different terms 
(embodied energy rate, $\rate{E}_{emb}$, and
capital cost rate, $\rate{C}_{cap}$)
might seem to imply different processes, 
but they actually refer to the same emplacement effect, 
namely segment \ab{} in energy and expenditure path graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph} and
\ref{fig:ExampleCostPathGraph}, respectively).
Purchasing an upgraded device
(which likely leads to $\rbempl{C}_{cap} \neq \raempl{C}_{cap}$)
will likely mean a changed embodied energy rate ($\rbempl{E}_{emb} \neq \raempl{E}_{emb}$) 
to provide the same energy service.
Our names for these aspects of rebound (embodied energy and capital cost)
reflect common usage 
in the energy and economics fields, respectively.
In the notional graphs of
Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}, 
embodied energy rates and capital cost rates
(represented by segments \ab{}) 
move in the same direction (both in the negative $y$ direction).
However, both segments \ab{} could move in the positive $y$ direction, or
they could move in opposite directions, 
depending on the results of the independent analyses for 
embodied energy and capital cost rates.

Consistent with the energy analysis literature, 
we define embodied energy 
to be the sum of all energy
consumed in the production of the energy conversion device, 
all the way back to resource extraction.
Energy is embodied in the device within manufacturing and distribution supply chains
prior to consumer acquisition of the device.
No energy is embodied in the device while in service.
The EEU causes the embodied energy of the energy conversion device to change
from $\orig{E}_{emb}$ to $\aempl{E}_{emb}$.

For simplicity, we spread all embodied energy
over the lifetime of the device
to provide a constant embodied energy rate ($\rate{E}_{emb}$).
(We later take the same approach to capital costs ($\rate{C}_{cap}$) and
maintenance and disposal costs ($\rate{C}_{\md}$).)
A justification for spreading embodied energy purchase costs comes from considering
device replacements by many consumers across several years.
In the aggregate, evenly spaced (in time) replacements
work out to the same embodied energy in every period.

Thus, we allocate embodied energy over the life of the original and upgraded devices
($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to obtain embodied energy rates, such that
$\rbempl{E}_{emb} = \bempl{E}_{emb} / \bempl{t}_{\life}$
and 
$\raempl{E}_{emb} = \aempl{E}_{emb} / \aempl{t}_{\life}$.
The change in embodied final energy due to the EEU (expressed as a rate) is given by
$\Delta \raempl{E}_{emb} = \raempl{E}_{emb} - \rbempl{E}_{emb}$
and is shown as segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
The expression for embodied energy rebound is

\begin{equation} \label{eq:Re_emb}
  Re_{emb} = \Reembeqn{} \; .
\end{equation}
%
(See Appendix~\ref{sec:Re_emb} for details of the derivation.)

Embodied energy rebound ($Re_{emb}$)
can be either positive or negative, depending on 
the sign of the term
$(\aempl{E}_{emb}/\bempl{E}_{emb})(\bempl{t}_{\life}/\aempl{t}_{\life}) - 1$.
Rising energy efficiency can be associated with increased device complexity,
additional energy consumption in manufacturing, and
more embodied energy,
such that $\bempl{E}_{emb} < \aempl{E}_{emb}$ and $Re_{emb} > 0$,
all other things being equal.
However, if the upgraded device has longer life than the original device
($\aempl{t}_{\life} > \bempl{t}_{\life}$),
$\raempl{E}_{emb} - \rbempl{E}_{emb}$ could be negative,
meaning that the upgraded device has a lower embodied energy rate than the original device,
as shown by point \emph{b} being below point \emph{a} 
in the notional energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}.

In addition to embodied energy, 
indirect emplacement effect rebound accounts for
energy demanded by maintenance and disposal~($\md$) activities
(segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}).
Maintenance expenditures are typically modeled as a per-year expense, a rate (e.g., $\rbempl{C}_m$).
Disposal costs (e.g., $\bempl{C}_d$) are one-time expenses incurred 
at the end of the useful life of the energy conversion device.
Like embodied energy, we spread disposal costs across the lifetime 
of the original and upgraded devices ($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to form expenditure rates such that 
$\rbempl{C}_{\md} = \rbempl{C}_m + \bempl{C}_d/\bempl{t}_{\life}$
and
$\raempl{C}_{\md} = \raempl{C}_m + \aempl{C}_d/\aempl{t}_{\life}$.

For simplicity, we assume that maintenance and disposal
expenditures imply energy consumption
elsewhere in the economy at its overall energy intensity~($I_E$).
Therefore, the change in energy consumption rate caused by a change 
in maintenance and disposal expenditures
is given by $\Delta \raempl{C}_{\md} I_E = (\raempl{C}_{\md} - \rbempl{C}_{\md}) I_E$, 
shown as segment \bstar{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
Rebound from maintenance and disposal activities 
is given by 

\begin{equation} \label{eq:Re_md}
  Re_{\md} = \ReOMdeqn{} \; .
\end{equation}
%
(See Appendix~\ref{sec:Re_OMd} for details of the derivation.)


%------------------------------
\subsubsection{\Subeffect}
\label{sec:sub_effect_main_paper}
%------------------------------

Neoclassical consumer theory decomposes price-induced
behavior change into
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item substituting energy service consumption for
        other goods consumption due to the lower post-EEU price of the energy service 
        (the substitution effect) and
  
  \item spending the higher real income (the income effect)%
        \footnote{
          For the original development of the decomposition
          see \citet{Slutsky1915} and \citet{Allen1936}.
          For a modern introduction see \citet{Nicholson2017}.
        }.
    
\end{enumerate*}
%
This section develops mathematical expressions 
for substitution effect rebound ($Re_{sub}$),
thereby accepting the standard neoclassical microeconomic assumptions
about consumer behavior.
(The next section addresses income effect rebound, $Re_{inc}$.)
The substitution effect alters compensated demand, which is the demand for
the expenditure minimizing consumption bundle that
maintains utility at the pre-EEU level, given the new prices.
Compensated demand is a technical term for a thought experiment from welfare economics: 
the device owner's budget is altered so that the owner is ``compensated''
for the change in price while maintaining the same level of utility as before. 
The change in the budget is called ``compensating variation'' (CV).
The substitution effect involves
%
\begin{enumerate*}[label={(\roman*)}]

  \item an increase in consumption of the energy service,
        the direct substitution effect (subscript $dsub$) and

  \item a decrease in consumption of other goods,
        the indirect substitution effect (subscript $isub$).

\end{enumerate*}
%
Thus, two terms comprise substitution effect rebound,
direct substitution rebound ($Re_{dsub}$) and
indirect substitution rebound ($Re_{isub}$).
The substitution effect is shown by segments
\starc{} (the indirect component) and \chat{} (the direct component) 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.

The substitution effect is best described 
with reference to a consumption path graph (e.g., Fig.~\ref{fig:ExampleConsPathGraph}).
Prior to the EEU, the consumption basket (of the energy service and other goods)
is represented by the $\circ$ point. 
The budget constraint,
i.e.\ the amount of money available for final good purchase,
is shown as isoquant \circcirc{}.
The \circcirc{} line is tangent to the lower indifference curve 
(\iicirc{}) at point $\circ$, the optimal consumption
bundle prior to the EEU.
After emplacement of the more efficient device
(but before the substitution effect), 
the price of the energy service decreases ($\bempl{p}_s > \aempl{p}_s$),
pivoting the budget constraint counterclockwise about the $\circ$ point.
The budget line \starstar{} indicates the
cost of purchasing the original consumption bundle
at the new prices.
The substitution effect indicates the cheaper, optimal
consumption bundle at the $\wedge$ point. 
This compensating variation
translates into a lower budget constraint \hathat{} 
in Fig.~\ref{fig:ExampleConsPathGraph}.
The $\wedge$ point shows consumption with new prices yielding utility
at the same level as prior to the EEU and minimizing expenditure, 
by consuming more of the now-lower-cost energy service
and less of the now-relatively-more-expensive other goods.

Rebound from the substitution effect is typically decomposed into 
indirect (the decrease in other goods consumption, segment \starc{}) 
and 
direct (the increase in energy service consumption, segment \chat{})
components.
The impact of the substitution effect on energy consumption rates and expenditure rates
can be seen in Figs.~\ref{fig:ExampleEnergyPathGraph}
and~\ref{fig:ExampleCostPathGraph}, respectively.

An approximate utility model
is often used in the literature
(e.g., see \citet[p.~17, footnote~43]{Borenstein:2015aa})
for determining 
the post-substitution effect point
and therefore $Re_{dsub}$ and $Re_{isub}$.
The approximate utility model assumes that 
the compensated energy service price elasticity of energy service demand ($\eqspsC$) and
the compensated energy service cross-price elasticity of other goods demand ($\eqopsC$)
are constant along an indifference curve.
Whether that is true depends on the utility function used.
Constant price elasticities (as in the approximate utility model)
are approximations that are in general only applicable to marginal price changes. 
Appendix~\ref{sec:Resub_approximate_method}
contains details of the approximate utility model.

Here, we present an exact utility model that allows 
the compensated energy service price elasticity of energy service demand ($\eqspsC$) and
the compensated energy service cross-price elasticity of other goods demand ($\eqopsC$)
to vary along an indifference curve, 
allowing analysis of non-marginal energy service price changes ($\orig{p}_s >\!\!> \aempl{p}_s$). 
We employ a fully specified CES utility model,
which allows the direct calculation
of the utility-maximizing consumption bundle for any constraint.
The utility model describes the device owner's behavior as

\begin{equation} \label{eq:ces_utility}
  \frac{\rate{u}}{\rbempl{u}} = \cesutility{} \; .
\end{equation}

The device owner's utility rate
(relative to the original condition, $\rate{u}/\rorig{u}$)
is determined by
the consumption rate of the energy service ($\rate{q}_s$) and
the consumption rate of other goods and services ($\rate{C}_o$).
The share parameter ($\fCs$) 
between $\rate{q}_s$ and $\rate{C}_o$
is taken from the original (pre-EEU) consumption basket.
The exponent $\rho$ is calculated from the (constant) elasticity of substitution ($\sigma$) 
as $\rho \equiv (\sigma - 1)/\sigma$.
All quantities are normalized to pre-EEU values so that
the cost share of other goods can be used straightforwardly 
in empirical applications rather than having
to construct quantity and price indices.
The normalized specification is commonly used in empirical CES \emph{production}
function applications \citep{Klump2012,Temple2012,Gechert2021}.
See Appendix~\ref{sec:utility_and_elasticities}
for further details of the CES utility model.

Direct substitution effect rebound ($Re_{dsub}$) is

\begin{equation} \label{eq:Re_dsub_def}
  Re_{dsub} = \frac{\Delta \rasub{E}_s}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to

\begin{equation} \label{eq:Re_dsub_prelim}
  Re_{dsub} = \frac{\frac{\rasub{q}_s}{\rbempl{q}_s} - 1}{\frac{\amacro{\eta}}{\bempl{\eta}} - 1} \; .
\end{equation}

Indirect substitution effect rebound ($Re_{isub}$) is given by

\begin{equation} \label{eq:Re_isub_def}
  Re_{isub} = \frac{\Delta \rasub{C}_o I_E}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to 

\begin{equation} \label{eq:Re_isub_prelim}
  Re_{isub} = \frac{\frac{\rasub{C}_o}{\rorig{C}_o} - 1}{\etaratiostacked - 1} \; 
                          \etaratiostacked \; 
                          \frac{\rbempl{C}_o I_E}{\rbempl{E}_s} \; .
\end{equation}

To find the post-substitution effect point ($\wedge$),
we solve for the location on the \iicirc{} indifference curve
where its slope is equal to the slope of the
\starstar{} expenditure line, 
assuming the CES utility model%
\footnote{
  Other utility models could be used.
  However, the Cobb-Douglas utility model is inappropriate for this framework, 
  because it assumes that the sum of substitution and income rebound is 100\% \emph{always}.
  Regardless of the utility model, expressions for
  $\rasub{q}_s/\rorig{q}_s$ and
  $\rasub{C}_o/\rorig{C}_o$
  must be determined
  and substituted into Eqs.~\ref{eq:Re_dsub_prelim} and~\ref{eq:Re_isub_prelim}, 
  respectively.
}.
The results are

\begin{equation} \label{eq:q_s_solution}
  \frac{\rasub{q}_s}{\rbempl{q}_s} = \qssolution{}
\end{equation}
%
and

\begin{equation} \label{eq:C_o_solution}
  \frac{\rasub{C}_o}{\rbempl{C}_o} = \Cosolution{} \; .
\end{equation}

Eq.~(\ref{eq:q_s_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_dsub_prelim})
to obtain an expression for direct substitution rebound ($Re_{dsub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_dsub_CES}
  Re_{dsub} = \RedsubCES{}
\end{equation}

Eq.~(\ref{eq:C_o_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_isub_prelim})
to obtain an expression for indirect substitution rebound ($Re_{isub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_isub_CES}
  Re_{isub} = \ReisubCES{}
\end{equation}

(See Appendix~\ref{sec:Resub_exact_method} for details
of the derivations of Eqs.~(\ref{eq:Re_dsub_prelim}), 
(\ref{eq:Re_isub_prelim}), and 
(\ref{eq:q_s_solution})--(\ref{eq:Re_isub_CES}).)


%------------------------------
\subsubsection{\Inceffect}
\label{sec:inc_effect_main_paper}
%------------------------------

The monetary income rate of the device owner ($\rbempl{M}$)
remains unchanged across the rebound effects, 
such that
$\rbempl{M} = \raempl{M} = \rasub{M} = \rainc{M} = \ramacro{M}$.
Thanks to the energy service price decline, real income rises, 
and freed cash from the EEU is given by Eq.~(\ref{eq:G_dot})
as $\rate{G} = p_E \Sdot$. 
Emplacement effect adjustments and compensating variation
modify freed cash to leave the device owner with
\emph{net} savings ($\rasub{N}$) from the EEU,
as shown in Eq.~(\ref{eq:N_dot_after_sub}).
Derivations of expressions for freed cash from the 
emplacement effect ($\rate{G}$)
and net savings after the substitution effect ($\rasub{N}$)
are presented in Tables~\ref{tab:empleffect} and~\ref{tab:subeffect}.
Rebound from the income effect quantifies the rate of additional energy demand 
that arises when the energy conversion device owner spends net
savings from the EEU
(segments \hatd{} and \dbar{} in 
Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}), 

Additional energy demand from the income effect
is determined by several constraints.
The income effect under utility maximization
satisfies the budget constraint, so that
net savings are zero after
the income effect ($\rainc{N} = 0$).
The budget constraint can be seen in 
expenditure path graphs (e.g., Fig.~\ref{fig:ExampleCostPathGraph})
where the post-income-effect point ($-$) returns to the original expenditure isoquant.
See Appendix~\ref{sec:proof_income_elasticities}
for a mathematical proof that the income preference equations below
(Eqs.~(\ref{eq:qsrat_eqsM}) and~(\ref{eq:qorat_eqoM}))
satisfy the budget constraint.

A second constraint is that net savings are spent completely on
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item additional spending on the energy service ($\rbinc{q}_s < \rainc{q}_s$, segment \hatd{}) and
  
  \item additional spending on other goods ($\rbinc{q}_o < \rainc{q}_o$, segment \dbar{}).
    
\end{enumerate*}
%
This constraint is satisfied by construction below.

The proportions in which income-effect spending is allocated depends on preferences, 
which prescribe an income expansion path. 
The CES utility function 
allocates spending on the energy service and other goods 
in the same proportion as post-substitution-effect 
expenditures on the energy service and other goods,
due to its homotheticity, 
so that the income expansion path is a ray (\rr{}) on consumption path graphs.
This constraint is satisfied by construction below, 
particularly via an effective income term ($\Mdothatprime$).
In the consumption path graph, the pre- and post-income-effect 
points ($\wedge$ and $-$, respectively)
lie along ray \rr{} from the origin through point $\wedge$ in Fig.~\ref{fig:ExampleConsPathGraph}.
However, this framework could accommodate non-homothetic preferences
for spending across the income effect (turning the income
expansion path into a more general curve).

We next show expressions for 
direct and indirect income effect rebound.


%..............................
\paragraph{Direct income effect} 
\label{sec:direct_income_effect}
%..............................

The income elasticity of energy service demand ($\eqsM$)
quantifies the amount of net savings spent 
on more of the energy service ($\rbinc{q}_s < \rainc{q}_s$).
(See Appendix~\ref{sec:utility_and_elasticities} 
for additional information about elasticities.)
Spending of net savings on additional energy service 
leads to direct income effect rebound ($Re_{dinc}$).

The ratio of rates of energy service consumed across the income effect is given by

\begin{equation} \label{eq:qsrat_eqsM}
  \incprefseqn \; .
\end{equation}
%
Homotheticity means that $\eqsM = 1$. 
The increased consumption rate of the energy service is 
represented by segments \hatd{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.

Effective income ($\Mdothatprime$) is given by 

\begin{equation} \label{eq:effective_income}
  \effinceqn{} \; .
\end{equation}
%
For the purposes of the income effect, 
the effective income equation (Eq.~(\ref{eq:effective_income})) 
adjusts income ($\rorig{M}$) to account for 
sunk costs ($\raempl{C}_{cap}$ and $\raempl{C}_{\md}$) and
net savings ($\rasub{N}$).

Direct income rebound is defined as

\begin{equation} \label{eq:Re_dinc_def}
  Re_{dinc} \equiv \frac{\Delta \rainc{E}_s}{\Sdot} \; .
\end{equation}
%
(See Table~\ref{tab:inceffect}.)
After substitution, rearranging, and canceling of terms (Appendix~\ref{sec:Re_dinc}), 
the expression for direct income rebound is

\begin{equation} \label{eq:Re_dinc}
  Re_{dinc} = \Redinceqnexact{} \; .
\end{equation}
%
If there are no net savings after the substitution effect ($\rasub{N} = 0$), 
direct income effect rebound is zero ($Re_{dinc} = 0$), as expected%
\footnote{
  Zero net savings ($\rasub{N} = 0$) could occur if 
  increases in the capital cost rate ($\Delta \raempl{C}_{cap}$) and/or
  the maintenance and disposal cost rate ($\Delta \raempl{C}_{\md}$)
  consume all freed cash ($\rate{G}$) plus savings from the compensating variation.
}.


%..............................
\paragraph{Indirect income effect} 
\label{sec:indirect_income_effect}
%..............................

But not all net savings ($\rbinc{N}$) are spent on more energy for the energy conversion device.
The income elasticity of other goods demand ($\eqoM$)
quantifies the amount of net savings spent 
on additional other goods ($\rbinc{q}_o < \rainc{q}_o$).
Spending of net savings on additional other goods and services
leads to indirect income effect rebound ($Re_{iinc}$).

The ratio of rates of other goods consumed across the income effect is given by

\begin{equation} \label{eq:qorat_eqoM}
  \incprefoeqn \; 
\end{equation}
%
and is represented by segments \dbar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.
Under the assumption that prices of other goods are exogenous
(see Appendix~\ref{sec:other_goods_expenditures}), 
the ratio of rates of other goods consumption ($\rainc{q}_o/\rbinc{q}_o$)
is equal to the ratio of rates of other goods expenditures ($\rainc{C}_o/\rbinc{C}_o$)
such that 

\begin{equation} \label{eq:Corat_eqoM}
  \frac{\rainc{C}_o}{\rbinc{C}_o} = \left( 1 + \frac{\rasub{N}}{\Mdothatprime} \right)^{\eqoM} \; .
\end{equation}
%
Homotheticity means that $\eqoM = 1$.
As shown in Table~\ref{tab:inceffect}, indirect income rebound is defined as

\begin{equation} \label{eq:Re_iinc_def}
  Re_{iinc} \equiv \frac{\Delta \rainc{C}_o I_E}{\Sdot} \; .
\end{equation}
%
After substitution, rearranging, and canceling of terms, 
the expression for indirect income rebound is

\begin{equation} \label{eq:Re_iinc}
  Re_{iinc} = \Reiinceqnexact{} \; .
\end{equation}
%
(See Appendix~\ref{sec:Re_inc} for details of the derivation
of direct and indirect income effect rebound.)


%------------------------------
\subsubsection{\Macroeffect}
\label{sec:macro_effect_main_paper}
%------------------------------

The previous rebound effects 
(emplacement effect, substitution effect, and income effect)
occur at the microeconomic scale. 
However, the changes at the microeconomic scale can 
have important implications at the macroeconomic scale, including
through aggregate economic growth from the energy-augmenting
productivity increase.

\citet{Turner:2013aa} cautions that when households
see the productivity of their non-market activities increase,
GDP remains unchanged. 
That may be true in the short run, but
the question over longer periods is whether the higher productivity
of household production of energy services does not affect also their
<<<<<<< HEAD
capacity to contribute to economic growth. One channel could be
time-saving. If the EEU saves time, then this time
could be spent on more work or on increasing human capital \citep{Sorrell2008}. Either is expected 
to lead to GDP growth relative to a scenario without EEU.
If the EEU saves money (but no time), then the freed cash
could be spent on human capital-increasing activities or even be
used to start a venture. In all
cases, it would be rash to conclude that just because some
EEU imply productivity increases not directly captured in GDP,
it does not eventually lead to additional economic growth.\footnote{
To appreciate the difference, consider one case
where an increased mileage leads to the household saving
on energy per car trip. The household takes more trips
(direct rebound), without effect on GDP.
 In the other case, the household buys the energy
service directly from a taxi company. Here, the taxi company
lowers the price but gains more customers, leading immediately
to growth in inflation-adjusted, i.e. real, GDP. Yet, the
physical change of more car trips is the same in both cases.
=======
capacity to contribute to economic growth. 
One channel could be time-saving. 
If the EEU saves time,
then this time could be spent on more work or on increasing human capital \citep{Sorrell2008}.
Both are is expected to lead to GDP growth relative to a scenario without the EEU.
If the EEU saves money (but no time), 
then the freed cash could be spent on human capital-increasing activities
or even be used to start a venture. 
In all cases, it would be rash to conclude that 
just because some EEUs lead to productivity increases not captured by GDP,
it does not eventually lead to additional economic growth.%
\footnote{
  To appreciate the difference, consider one case
  where an increased mileage leads to the household saving
  on energy per car trip. 
  The household takes more trips
  (direct rebound), without effect on GDP.
  In the other case, 
  the household buys the energy service directly from a taxi company. 
  Here, the taxi company lowers the price but gains more customers, 
  leading immediately to growth in inflation-adjusted, i.e.\ real, GDP. 
  Yet, the physical change of more car trips is the same in both cases.
>>>>>>> c6bb6b6e394aa47d7661fecf12564cf06df1bf13
}

\citeauthor{Borenstein:2015aa} also addressed these macro effects 
from consumer behavior
noting that ``income effect rebound will be larger economy-wide than 
would be inferred from evaluating only the direct income gain from 
the end user's transaction'' \citep[p.~11]{Borenstein:2015aa} and 
likening it to the Keynesian macroeconomic multiplier.
However, the dynamic macro rebound effect 
is not an autonomous expansion of expenditure in an otherwise unchanged economy 
(like the Keynesian multiplier).
Rather, macroeconomic rebound is caused by an energy productivity improvement,
a supply-side shock.
After the EEU, 
it takes less energy (and therefore less energy cost)
to generate the same economic activity, because 
energy efficiency has improved.
That said, \citeauthor{Borenstein:2015aa} is right to highlight that supply-side 
and demand-side effects both play a role as the consequences of the
technology shock play themselves out.
Furthermore, his approach has the advantage that it can be directly
linked to our income effect and its consequences for macroeconomic rebound. 
\citeauthor{Borenstein:2015aa} also notes that scaling from net 
savings ($\rasub{N}$) at the device level
to productivity-driven growth at the macro level is unexplored territory.

Another novel contribution of this paper
(in addition to the framework itself and rebound path graphs)
is the first operationalization of the macro rebound multiplier idea.
To operationalize the macro rebound effect, we scale
the net savings gained by the device owner at the microeconomic scale ($\rasub{N}$)
by a macro factor ($k$) that represents the economic activity generated
by the infinite series of respending of net savings ($\rasub{N}$)
throughout the economy%
\footnote{
  The macro factor ($k$) appears unitless,
  but its units are actually \$ of economic growth created 
  per \$ of net savings spent
  by the device owner in the income effect ($\rbinc{N}$).
}.
%
The macro factor ($k$) can be likened to 
the total respending described by
a marginal propensity to consume ($\MPC$).
$k$ represents respending in the broader economy 
after the income effect has occurred
and is not tied to any particular EEU or economic sector.
$k \ge 0$ is expected.
$k = 0$ means there is no dynamic effect
resulting from the energy efficiency upgrade.
$k > 0$ means that productivity-driven macroeconomic growth has occurred
with consequent implications for additional energy consumption in the wider economy.
The relationship between $k$ and $\MPC$ is given by

\begin{equation} \label{eq:mpc_and_k_converged}
  k = \frac{1}{\frac{1}{\MPC} - 1} \; .
\end{equation}
%
(See Appendix~\ref{sec:income_macro_mpc} for the derivation 
of Eq.~(\ref{eq:mpc_and_k_converged}).)

A further advantage of using the $\MPC$ approach is that there are
many estimates of its magnitude, though we stress again that  $\MPC$ is a
\emph{representation} of the effect, while the cause is higher
energy efficiency on the supply side.
A recent review by \citet{Carroll2017} 
reports that most empirical estimates show $\MPC$ between 0.2 and 0.6, 
with the full range estimates spanning zero to 0.9.
For now, we choose $\MPC = 0.5$ and $k = 1$ as a placeholder value,
with further exploration of the macro effect
in Sections~\ref{sec:effect_of_macro_factor} 
and~\ref{sec:calibrating_k}.
We assume as a first approximation
(following \citet{Antal:2014aa} and \citet{Borenstein:2015aa}) that macro effect respending
implies energy consumption according to 
the average energy intensity of the economy ($I_E$).
Macro rebound is given by

\begin{equation} \label{eq:Re_macro_def}
  Re_{\macro} = \frac{k \rbinc{N} I_E}{\Sdot} \; .
\end{equation}
%
(See Table~\ref{tab:macroeffect}.) 
The macro effect is shown as segment \bartilde{}
in Fig.~\ref{fig:ExampleEnergyPathGraph}.
After some algebra (Appendix~\ref{sec:Re_macro}), 
we arrive at an expression for macro effect rebound:

\begin{equation} \label{eq:Re_macro}
  Re_{\macro} = \Remacroeqn{} \; .
\end{equation}
%

%++++++++++++++++++++++++++++++
\subsection{Rebound sum}
\label{sec:total_rebound_main_paper}
%++++++++++++++++++++++++++++++

The sum of all rebound emerges from the four rebound effects
(emplacement effect, substitution effect, income effect, and macro effect).
Macro effect rebound~($Re_{\macro}$, Eq.~(\ref{eq:Re_macro}))
is expressed in terms of other rebound effects.
(Derivation details can be found in Appendix~\ref{sec:total_rebound}.)
After algebra and canceling of terms,
we find

\begin{align} \label{eq:Re_tot}  
  Re_{tot} = \; \Retoteqn{} \; .
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results: Two applications of the rebound framework}
\label{sec:examples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To demonstrate application of the comprehensive rebound analysis framework
developed in Section~\ref{sec:framework},
we select two case studies:
energy efficiency upgrades to a car and an electric lamp.
We first collect parameter values
for the equations for
eight rebound components:
$Re_{dempl}$ (Eq.~(\ref{eq:Re_dempl0})),
$Re_{emb}$ (Eq.~(\ref{eq:Re_emb})),
$Re_{\md}$ (Eq.~(\ref{eq:Re_md})),
$Re_{dsub}$ (Eqs.~(\ref{eq:Re_dsub_prelim} and~\ref{eq:q_s_solution})),
$Re_{isub}$ (Eq.~(\ref{eq:Re_isub_prelim} and~\ref{eq:C_o_solution})),
$Re_{dinc}$ (Eq.~(\ref{eq:Re_dinc})),
$Re_{iinc}$ (Eq.~(\ref{eq:Re_iinc})), and
$Re_{\macro}$ (Eq.~(\ref{eq:Re_macro})).
The total rebound 
($Re_{tot}$)
is given by the sum of the above components,
which can also be verified against Eq.~(\ref{eq:Re_tot}).

As discussed in Section~\ref{sec:macro_effect_main_paper},
the link between macroeconomic and microeconomic rebound 
is largely unexplored, and 
we assume a placeholder value of $k = 1$ for both case studies.
We return to the matter of calibrating $k$
in the Discussion (Section~\ref{sec:calibrating_k}).
 

%++++++++++++++++++++++++++++++
\subsection{Case 1: Purchase of new car}
\label{sec:car_example}
%++++++++++++++++++++++++++++++

<<CarPrintableNumbers, echo=FALSE>>=
val_to_string <- function(case, val, to_perc = FALSE, scale = 1, digits = 1, format = "f", big.mark = ",") {
  val <- rebound_results %>% 
    dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == case) %>% 
    magrittr::extract2(val) %>% 
    magrittr::multiply_by(scale)
  if (to_perc) {
    val <- val * 100
  }
  val %>% 
    formatC(digits = digits, format = format, big.mark = big.mark)
}
# Parameters for first table
mpg_worse <- val_to_string(case = "Car", val = ReboundTools::orig_vars$eta_engr_units_orig, digits = 0)
mpg_better <- val_to_string(case = "Car", val = ReboundTools::star_vars$eta_engr_units_star, digits = 0)
C_dot_cap_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 0)
C_dot_cap_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_cap_star, digits = 0)
t_own_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_own_orig, digits = 0)
t_own_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_life_orig, digits = 0)
t_life_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$E_emb_orig, digits = 0)
E_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$E_emb_star, digits = 0)
C_dot_md_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 0)
C_dot_md_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_md_star, digits = 0)

# Parameters for second table
q_dot_s_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 2)
f_Cs_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$f_Cs_orig, digits = 3)
k_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$k, digits = 1)

# Parameters for elasticity table
e_qs_ps_UC_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 3)
e_qo_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 3)
e_qs_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Parameters for discussion
Re_dempl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 0)
Re_md_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE, digits = 1)
Re_dsub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
Re_isub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE)
Re_iinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@

For the first example, 
we consider the purchase of a more fuel efficient car, 
namely a gasoline-electric Ford Fusion Hybrid car,
to replace a conventional gasoline Ford Fusion car. 
The cars are matched as closely as possible, 
except for the inclusion of an electric battery 
in the hybrid car.  
The car case study features a larger initial capital investment ($\orig{C}_{cap} < \amacro{C}_{cap}$)
versus the long-term benefit of decreased energy costs ($\rorig{C}_s > \ramacro{C}_s$). 


%------------------------------
\subsubsection{Input parameters} 
\label{sec:Car_input_data}
%------------------------------

We require four sets of data. 
First, the basic car parameters are summarized 
in Table~\ref{tab:car_parameters}.
Second, we require several general parameters, 
mainly relating to the U.S.\ economy and personal finances 
of the average U.S.\ citizen. 
The parameters and the values used in the car example 
are given in Table~\ref{tab:car_economic_parameters}.
Third, we require elasticity parameters, 
as given in Table~\ref{tab:car_elasticity_parameters}.
Fourth, armed with the parameter values from 
Tables~\ref{tab:car_parameters}--\ref{tab:car_elasticity_parameters}, 
and the equations of Section~\ref{sec:framework},
we calculate important values at each rebound stage,
as shown in Table~\ref{tab:car_stages_table}.
Note that Table~\ref{tab:car_stages_table} applies to the car owner.
Across the macro effect (segment \bartilde{} in Fig.~\ref{fig:CarEnergyGraph}), 
changes occur only in the macroeconomy.
For the car owner, no changes are observed across the macro effect.
Thus, the $-$ (bar) and $\sim$ (tilde) columns
of Table~\ref{tab:car_stages_table} are identical.

% Reduce spacing between table rows henceforth.
\renewcommand{\arraystretch}{0.6}

\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Vehicle parameters.} 
\label{tab:car_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Ford Fusion & Ford Fusion & Data sources and notes\\ 
    Parameters [units]                              & (gasoline) & (hybrid EV) &  \\
  \midrule
  Fuel economy                           & \Sexpr{mpg_worse} & \Sexpr{mpg_better} & Combined cycle mpg value taken from \citet{Car_Connection:2020}, \\
  $\bempl{\eta}$, $\amacro{\eta}$ [mpg]             &           &          & for Titanium FWD 2020 model with Intercooled I-4, 2.0 L engine.   \\
                                                    &           &          & Combined cycle mpg value taken from \citet{Car_Connection:2020},\\
                                                    &           &          & for Titanium FWD 2020 model with Gas/Electric I-4, 2.0 L engine. \\
  \midrule
   Capital expenditure rate      & \Sexpr{C_dot_cap_orig_car_char}     & \Sexpr{C_dot_cap_star_car_char}    & Seven year annual, averaged capital costs = purchase + finance costs  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & -- resale value (purchase -- depreciation). Ford Fusion gasoline costs from \\
                                                    &           &          & \citet{Edmunds:2020_fusion_gasoline}. \\
                                                    &           &          & Ford Fusion Hybrid car costs from \citet{Edmunds:2020_fusion_hybrid}. \\
 \midrule
   Ownership duration            & \Sexpr{t_own_orig_car_char}  & \Sexpr{t_own_star_car_char}  & U.S.\ car ownership (from new) length from \citet{BusinessWire:2015}, \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          & and has risen from 52 months (2005) to 79 months (2015), so  \\
                                                    &           &          & taken as 84 months in 2020 (7 years) for our example. \\
 \midrule
   Lifespan                     & \Sexpr{t_life_orig_car_char}  & \Sexpr{t_life_star_car_char} & Lifetime taken as 14 years, based on 13--17 years for U.S.\ cars \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Berla:2016} and 14 years for UK cars from \\
                                                    &           &          & \citet{SMMT:2020}. \\
 \midrule
   Embodied energy             & \Sexpr{E_emb_orig_car_char}    & \Sexpr{E_emb_star_car_char}   & 34,000 MJ for conventional Ford Fusion gasoline car taken from \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & \citet{Argonne_National_Laboratory:2010}. \\
                                                    &           &          & We assume an additional 6,000 MJ added for Ford Fusion \\
                                                    &           &          & Hybrid Electric Vehicle (HEV) battery, as HEV typically adds 10--25\% \\
                                                    &           &          & to total LCA energy of vehicle manufacture \citet{onat2015conventional}. \\
                                                    &           &          & Battery lifetime assumed same as car lifetime, based on \\
                                                    &           &          & \citet{nordelof2014environmental}, and \citet{onat2015conventional}. \\
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_car_char}  & \Sexpr{C_dot_md_star_car_char}    & Seven year annual, averaged maintenance costs = sum of insurance, \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & maintenance, repairs, taxes, and fees \\
                                                    &           &          & (excluding financing, depreciation, fuel). \\
                                                    &           &          & Ford Fusion maintenance costs from \citet{Edmunds:2020_fusion_gasoline}. \\
                                                    &           &          & Ford Fusion Hybrid maintenance costs from \citet{Edmunds:2020_fusion_hybrid}. \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Economic parameters.}
\label{tab:car_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Distance driven prior to upgrade   & \Sexpr{q_dot_s_orig_car_char}        & Average U.S.\ vehicle miles/year, calculated from \citet{Car_Insurance:2019}.  \\
  $\rbempl{q}_s$ [miles/year]                               &               & This is slightly lower than the average driver miles/year (13,476) \\
                                                            &               & \citet{US_DoT:2018},as there are \\
                                                            &               & more registered U.S.\ vehicles than drivers. \\
  \midrule
  Real median personal income U.S., in 2018                 & 34,317        & Taken from \citet{St_Louis_Fed:2019}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ 2018 disposable income /                            & 0.88319       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  real income (minus current taxes)                         &               & National and Products Accounts (NIPA) \\
  {} [--]                                                   &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\ 
  \midrule
  Share of savings from 2018 disposable income              & 0.07848       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  {} [--]                                                   &               & National and Products Accounts (NIPA) \\ 
                                                            &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\
  \midrule
  Personal consumption in 2018                  & \Sexpr{M_dot_orig_car_char}      & Calculation: $(\$34,317\mathrm{/year}) (0.88319) (1 - 0.07848)$ \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of gasoline                       & \Sexpr{p_E_orig_car_char}       & Taken from U.S.\ Energy Information Agency (EIA) data \\
  $p_E$ [\$/gallon]                                         &               & \citet{US_EIA:2020_gasoline} \\
  \midrule  
  Fractional spend on original energy service      & \Sexpr{f_Cs_orig_car_char}      & Calculation: \$1,306 (spend on energy service) \\
  $\fCs$ [--]                                               &               & / [\$19,115 (other goods) + \$1,306 (energy service)] = 0.064, \\
                                                            &               & where spend on energy service = 12,416 miles / 25 mpg \\
                                                            &               & $\times$ \$2.63/gallon = \$1,306. \\
  \midrule
  Macro factor                                              & \Sexpr{k_car_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Elasticity parameters.}
\label{tab:car_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Price elasticity of car use demand  & $\Sexpr{e_qs_ps_UC_car_char}$  & We adopt $-0.2$ as our baseline value, based on U.S.\ studies including \\
  $\eqspsUC$ [--]                                           &           &  \citet{Gillingham:2020aa}, who estimated a value of $-0.1$, \\
                                                           &           &   \citet{goetzke2018}, who estimated values \\
                                                           &          &     between $-0.05$ and $-0.23$, and \citet{Parry2005},\\  
                                                             &           &   who estimated values between $-0.1$ and $-0.3$. \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses values of $-0.1$ to $-0.4$, \\   
                                                            &            &     based on \citet{Parry2005}. \\
  \midrule
  Compensated price elasticity of car use demand                   &   $\Sexpr{e_qs_ps_C_car_char}$   & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &                                &   \\    
  \midrule   
  Compensated cross-price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_C_car_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &                                &   \\ 
  \midrule   
  Income elasticity of demand for car use                 &   \Sexpr{e_qs_M_car_char}      & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &                                &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_car_char}      & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &                                &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<car_stages_table, results="asis", echo=FALSE>>=
digs_car <- matrix(c(rep(1, 7), # eta_engr_units
                     rep(3, 7), # eta
                     rep(3, 7), # p_s
                     rep(0, 7), # q_dot_s
                     rep(0, 7), # E_dot_s
                     rep(0, 7), # E_dot_emb
                     rep(0, 7), # C_dot_s
                     rep(0, 7), # C_dot_cap
                     rep(0, 7), # C_dot_md
                     rep(0, 7), # C_dot_o
                     rep(0, 7), # N_dot
                     rep(0, 7)), # M_dot
                   nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:car_stages_table", 
                             caption = "Results for car example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_car, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@

  
%------------------------------
\subsubsection{Results} 
\label{sec:Car_results}
%------------------------------

Results are represented graphically in quantified energy, expenditure, and consumption path graphs
in Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:CarConsGraph}.
The energy path graph (Fig.~\ref{fig:CarEnergyGraph})
shows the size of each rebound effect
for the car example.


<<CarGraphReResults, include=FALSE>>=
Re_empl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<CarEnergyGraph, echo=FALSE, fig.cap="Energy path graph for the car example. Macro factor ($k$) is assumed to be 1.", fig.width=6, fig.height=4>>=
car_Re_label_angle <- -77
car_Re_arrow_angle <- pi/180 * 3.1

car_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                     63500, 73270, 'degree', 
                                       stage_colour, orig_size, 0,
                                     36900, 73150, 'a', 
                                       abcd_colour, abcd_size, 0,
                                     37520, 73750, 'b', 
                                       abcd_colour, abcd_size, 0,
                                     38200, 73400, '"*"', 
                                       stage_colour, star_size, 0,
                                     36900, 73300, 'c',
                                       abcd_colour, abcd_size, 0,
                                     40650, 73360, '"^"', 
                                       stage_colour, hat_size, 0,
                                     42000, 73370, 'd', 
                                       abcd_colour, abcd_size, 0,
                                     42200, 75300, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                     42200, 77200, '"~"', 
                                       stage_colour, tilde_size, 0,
                                     34800, 73800, 'Hyperconservation', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle,
                                     35150, 74760, 'Re[tot] == 0*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     36830, 74800, paste0("Re[empl] == '", Re_empl_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     36000, 76150, 'Re[sub]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     36300, 75950, paste0("'", Re_sub_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     38800, 76300, 'Re[inc]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     39000, 76090, paste0("'", Re_inc_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     43650, 74050, 'Re[macro]', 
                                       annotation_colour, 
                                       annotation_size - 2,
                                       car_Re_label_angle + 90,
                                     43890, 73900, paste0("'", Re_macro_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     44500, 75000, paste0("Re[tot] == '", Re_tot_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     59600, 75700, 'Re[tot] == 100*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     62000, 76600, 'Backfire', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle)

car_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                 34730, 76250, car_Re_arrow_angle, 2250, annotation_colour, 0.5, # Re_sub
                                 37150, 76383, car_Re_arrow_angle, 2900, annotation_colour, 0.5, # Re_inc
                                 42650, 74100, car_Re_arrow_angle, 1800, annotation_colour, 0.5) # Re_macro

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Energy") +
  ggplot2::geom_spoke(data = car_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = car_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<CarCostGraph, echo=FALSE, fig.cap="Expenditure path graph for the car example. CV is compensating variation.", fig.width=6, fig.height=4>>=
car_cost_line_angle <- -33
car_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                   1295, 26600, 'degree', 
                                   stage_colour, orig_size, 0,
                                   777, 26640, 'a', 
                                   abcd_colour, abcd_size, 0,
                                   767, 26576, 'b', 
                                   abcd_colour, abcd_size, 0,
                                   791, 26530, '"*"', 
                                   stage_colour, star_size, 0,
                                   766, 26475, 'c', 
                                   abcd_colour, abcd_size, 0,
                                   835, 26435, '"^"', 
                                   stage_colour, hat_size, 0,
                                   873, 26480, 'd', 
                                   abcd_colour, abcd_size, 0,
                                   845, 27070, 'bold("_")', 
                                   stage_colour, bar_size, 0,
                                   1075, 26885, 'Original~expenditure', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   930, 26495, 'After~exp.~sav.', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   720, 26620, 'After~empl.', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle,
                                   705, 26580, 'After~CV', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Expenditure") + 
  ggplot2::geom_text(data = car_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  ggplot2::scale_x_continuous(limits = c(700, NA)) +
  MKHthemes::xy_theme()
@


<<CarConsGraph, echo=FALSE, warning=FALSE, fig.cap="Consumption path graph for the car example.", fig.width=6, fig.height=4>>=
car_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                    1.005, 1.0016, 'degree', 
                                      stage_colour, orig_size, 
                                    1.012, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.02, 1.0016, 'a',
                                      abcd_colour, abcd_size,
                                    1.0258, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.034, 1.0017, 'b',
                                      abcd_colour, abcd_size,
                                    1.041, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.05, 1.0002, '"*"', 
                                      annotation_colour, star_size,
                                    1.071, 0.998, '"^"',  
                                      stage_colour, hat_size, 
                                    1.118, 1.0283, 'bold("_")',  
                                      stage_colour, bar_size, 
                                    0.9, 1.008, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    1.165, 0.99, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    0.9, 1.0042, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    1.258, 0.9895, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    0.995, 0.9958, 'c',
                                      abcd_colour, abcd_size,
                                    0.9, 1.0017, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.22, 0.9888, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.115, 0.9965, 'd', 
                                      abcd_colour, abcd_size,
                                    0.9, 1.037, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.275, 1.0215, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.125, 1.037, 'r', 
                                      line_label_colour, r_line_label_size,
                                    1.075, 0.992, 'r', 
                                      line_label_colour, r_line_label_size,
                                    0.91, 1.0109, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.27, 0.9933, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    0.97, 1.0385, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    1.275, 1.025, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    )

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Consumption") + 
  ggplot2::geom_text(data = car_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.9, 1.3) + 
  ggplot2::ylim(NA, 1.04) +
  MKHthemes::xy_theme()
@


The results for the car upgrade are shown in Table~\ref{tab:car_results}.

<<car_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:car_results", 
                                      caption = "Car example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","), 
        math.style.negative = TRUE)
@


The \empleffect{} has three components:
the direct emplacement effect, 
the embodied energy effect, and 
the maintenance and disposal effect.
Rebound from the direct emplacement effect 
($Re_{dempl}$) is \Sexpr{Re_dempl_car_char_perc}\% always, 
because energy takeback (and, therefore, rebound)
occurs after the EEU is emplaced.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is \Sexpr{Re_emb_car_char_perc}\%,  
due to the higher embodied energy rate
($\Delta \raempl{E}_{emb} = \Sexpr{Delta_E_dot_emb_star_car_char}$~MJ/year)
stemming from the electric battery in the hybrid EV car.
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is small and negative
($\Sexpr{Re_md_car_char_perc}$\%),
because of the slightly lower maintenance and disposal costs
for the hybrid EV car.

The \subeffect{} has two components:
direct and indirect substitution effect rebound.
Rebound from direct substitution ($Re_{dsub}$) is 
positive, as expected (\Sexpr{Re_dsub_car_char_perc}\%). 
The car owner will, on average, prefer more driving, 
because of fuel economy enhancements (\Sexpr{mpg_better}~mpg $>$ \Sexpr{mpg_worse}~mpg).
In other words, with no other changes, 
the more fuel-efficient car is driven \Sexpr{Re_dsub_car_char_perc}\% further per year. 
Conversely, the indirect substitution effect ($Re_{isub}$)
is slightly negative ($\Sexpr{Re_isub_car_char_perc}$\%)
to achieve the same level of utility after increased driving. 
Indeed, less money is spent on other goods
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_car_char}$~\$/year).

The \inceffect{} also has two components:
direct and indirect income effect rebound.
The direct income effect
($Re_{dinc}$) is positive
(\Sexpr{Re_dinc_car_char_perc}\%), 
because the car owner allocates some
net savings to additional driving. 
Rebound from the indirect income effect 
($Re_{iinc}$) is positive (\Sexpr{Re_iinc_car_char_perc}\%)
due to higher spending on other goods. 
Thus, the net income after the substitution effect
($\rasub{N} = \Sexpr{N_dot_hat_car_char}$~\$/year) 
translates into positive direct and indirect income
rebound at the microeconomic scale. 
Total microeconomic rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_car_char_perc}$\%.

Finally, 
the \macroeffect{} leads to macroeconomic rebound
($Re_{\macro}$) of \Sexpr{Re_macro_car_char_perc}\%,
with $k$ assumed to be 1,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (transportation).


%++++++++++++++++++++++++++++++
\subsection{Case 2: Purchase of new electric lamp}
\label{sec:lamp_example}
%++++++++++++++++++++++++++++++

<<LampPrintableNumbers, echo=FALSE>>=
# First table
efficacy_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # lm-hr/W-hr
efficacy_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # lm-hr/W-hr
C_dot_cap_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 3)
C_dot_cap_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_cap_star, digits = 3)
t_own_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_own_orig, digits = 1)
t_own_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_life_orig, digits = 1)
t_life_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
C_dot_md_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 2)
C_dot_md_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_md_star, digits = 2)

# Second table
q_dot_s_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 4)
f_Cs_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$f_Cs_orig, digits = 7)
k_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$k, digits = 1)

# Third table
e_qs_ps_UC_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 4)
e_qo_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 5)
e_qs_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Results discussion
Re_dempl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 2)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
E_dot_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_dot_emb_orig, digits = 2)
E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_dot_emb_star, digits = 2)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Re_md_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE)
Re_dsub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
eta_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # In lm/W
eta_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # In lm/W
q_dot_s_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$q_dot_s_star, digits = 0) # In lm-hr/year
q_dot_s_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$q_dot_s_hat, digits = 0) # In lm-hr/year
Re_isub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE, digits = 2)
Re_iinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Delta_C_dot_o_bar_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_bar, digits = 2)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@


For the second example, 
we consider purchasing a Light Emitting Diode (LED) electric lamp
to replace a baseline incandescent electric lamp. 
Both lamps are matched as closely as possible 
in terms of energy service delivery (measured in lumen output per lamp), 
the key difference being the energy required to provide that energy service. 
The LED lamp has a low 
initial capital investment rate
(less than the incumbent incandescent lamp, actually)
and a long-term benefit of decreased direct energy expenditures
at the same energy service delivery rate (lm-hr/year).


%------------------------------
\subsubsection{Input parameters} 
\label{sec:lamp_input_data}
%------------------------------

Again, four sets of data are required. 
First, the basic lamp parameters are summarized in Table~\ref{tab:lamp_parameters}. 
Second, several general parameters, 
mainly relating to the U.S.\ economy and 
personal finances of the average U.S.\ citizen are 
given in Table~\ref{tab:lamp_economic_parameters}.
Third, we require the elasticity parameters, 
as shown in Table~\ref{tab:lamp_elasticity_parameters}.
Fourth, with the parameter values from 
Tables~\ref{tab:lamp_parameters}--\ref{tab:lamp_elasticity_parameters} 
and the equations of Section~\ref{sec:framework} in hand,
we calculate important values at each rebound stage,
as shown in Table~\ref{tab:lamp_stages_table}.
Similar to Table~\ref{tab:car_stages_table}, 
Table~\ref{tab:lamp_stages_table} applies to the lamp owner, 
so no changes are observed across the macro effect, and
the $-$ (bar) and $\sim$ (tilde) columns
of Table~\ref{tab:lamp_stages_table} are identical.


\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Electric lamp parameters.} 
\label{tab:lamp_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Incandescent lamp & LED lamp & Data sources and notes\\ 
    Parameters [units]                                &  &  & \\
  \midrule
  Lamp efficacy                   & \Sexpr{efficacy_worse}      & \Sexpr{efficacy_better}     & Incandescent: 530 lm output / 60 W energy input. \\
  $\bempl{\eta}$, $\amacro{\eta}$ [lm-hr/W-hr]       &           &          & LED: 450 lm output / 5.5 W energy input. \\
  \midrule
   Capital expenditure rate       & \Sexpr{C_dot_cap_orig_lamp_char}   & \Sexpr{C_dot_cap_star_lamp_char}    & Purchase costs: \$1.88 for incandescent lamp from  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & \citet{Home_Depot:2020_Inc_bulb}, \\
                                                    &           &          & and \$1.21 for LED lamp from \\
                                                    &           &          & \citet{Home_Depot:2020_LED_bulb}. \\
  \midrule
   Ownership duration      & \Sexpr{t_own_orig_lamp_char}       & \Sexpr{t_own_star_lamp_char}       & Assumed same as lamp lifespan \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          &  \\
 \midrule
   Lifespan               & \Sexpr{t_life_orig_lamp_char}       & \Sexpr{t_life_star_lamp_char}       & Based on assumed 3 hours/day  \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Home_Depot:2020_Inc_bulb} \\
                                                    &           &          & and  \citet{Home_Depot:2020_LED_bulb}. \\
   \midrule
   Life cycle analysis (LCA) embodied energy  & \Sexpr{E_emb_orig_lamp_char}      & \Sexpr{E_emb_star_lamp_char}     & Base document: Table 4.5 Manufacturing Phase Primary  \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & Energy (MJ/20 million lumen-hours), contained in \\
                                                    &           &          & U.S.\ DoE Life-cycle assessment of energy and environmental \\
                                                    &           &          & impacts of LED lighting products \citep{US_DoE:2012}.\\
                                                    &           &          & Incandescent lamp: \\
                                                    &           &          & LCA energy = 42.2 MJ/20 million lumen-hours.  \\
                                                    &           &          & Lifetime output = 530 lumens $\times$ 3 hours/day \\
                                                    &           &          & $\times$ 365 days/year $\times$ 1.8 years = 1,044,630 lumen-hrs.\\
                                                    &           &          & Thus LCA energy / lamp =  42.2 $\times$ 1.0446/20 = 2.21 MJ. \\
                                                    &           &          & LED lamp:  \\
                                                    &           &          & LCA energy = 132 MJ/20 Million lumen-hours \\
                                                    &           &          & for pack of 5 LED lamps. \\
                                                    &           &          & Lifetime output = 450 lumens $\times$ 3 hours/day  \\
                                                    &           &          & $\times$ 365 days/year $\times$ 10 years = 4,926,405 lumen-hrs. \\
                                                    &           &          & Thus LCA energy / lamp =  132 MJ/5 $\times$ 4.9264/20 = 6.5 MJ. \\ 
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_lamp_char}      & \Sexpr{C_dot_md_star_lamp_char}     & Assumed negligible. \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}






\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Economic parameters.}
\label{tab:lamp_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description  & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Lighting consumption prior to upgrade   & \Sexpr{q_dot_s_orig_lamp_char}  & Calculation: (530 lm) (3 hrs/day) (365 days/year). \\
  $\rbempl{q}_s$ [lm-hr/year]                               &               & \\
  \midrule
  Real median personal income U.S.\, in 2018                & 34,317        & Refer to Table~\ref{tab:car_economic_parameters}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ 2018 disposable income /                            & 0.88319       & Refer to Table~\ref{tab:car_economic_parameters}. \\
  real income (minus current taxes)                         &               &  \\
  {} [--]                                                   &               &  \\
  \midrule
  Share of savings from 2018 disposable income              & 0.07848       & Refer to Table~\ref{tab:car_economic_parameters}. \\
  {} [--]                                                   &               &  \\ 
  \midrule
  Personal consumption in 2018                   & \Sexpr{M_dot_orig_lamp_char}     & Calculation: $(\$34,317\mathrm{/year}) (0.88319) (1 - 0.07848)$. \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of electricity                  & \Sexpr{p_E_orig_lamp_char}        & U.S.\ 2018 average U.S.\ household electricity price \\
  $p_E$ [\$/kW-hr]                                          &               & \citep{US_EIA:2020_electricity}.  \\
  \midrule
  Fractional spend on original energy service    & \Sexpr{f_Cs_orig_lamp_char}       & Calculation: \$8.5/year (spend on energy service) / \\
  $\fCs$ [--]                                               &               & [\$27,920/year (other goods) + \$8.5/year (energy service)] = 0.00030, \\
                                                            &               & where spend on energy service = 580,350 lm-hrs/year /  \\
                                                            &               & 8.83 lm/W / 1000 W/kW $\times$ \$0.1287/kW-hr = \$8.5/year.  \\
  \midrule
  Macro factor                                              & \Sexpr{k_lamp_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Elasticity parameters.}
\label{tab:lamp_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Price elasticity of lighting demand  &   $\Sexpr{e_qs_ps_UC_lamp_char}$  & We adopt $-0.4$ as our baseline value, as the average of last 50 years \\
  $\eqspsUC$ [--]                                                             &           &   from \citep[Fig.~4]{Fouquet2014} \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses a range of $-0.4$ to $-0.8$, \\   
                                                            &            &     based on \citet{Fouquet2011}. \\
  \midrule
  Compensated price elasticity of lighting demand                 &  $\Sexpr{e_qs_ps_lamp_C_char}$      & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &           &   \\    
  \midrule   
  Compensated cross-price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_lamp_C_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &           &   \\ 
  \midrule   
  Income elasticity of lighting demand                &   \Sexpr{e_qs_M_lamp_char}     & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &           &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_lamp_char}     & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &           &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<lamp_stages_table, results="asis", echo=FALSE>>=
digs_lamp <- matrix(c(rep(0, 7), # eta_engr_units
                      rep(0, 7), # eta
                      rep(8, 7), # p_s
                      rep(0, 7), # q_dot_s
                      rep(1, 7), # E_dot_s
                      rep(3, 7), # E_dot_emb
                      rep(2, 7), # C_dot_s
                      rep(2, 7), # C_dot_cap
                      rep(2, 7), # C_dot_md
                      rep(0, 7), # C_dot_o
                      rep(2, 7), # N_dot
                      rep(0, 7)), # M_dot
                    nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:lamp_stages_table", 
                             caption = "Results for lamp example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_lamp, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


<<LampGraphReResults, include=FALSE>>=
Re_empl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<LampEnergyGraph, echo = FALSE, warning=FALSE, fig.cap="Energy path graph for the lamp example. Macro factor ($k$) is assumed to be 1.", fig.width=6, fig.height=4>>=
lamp_Re_label_angle <- -65
lamp_Re_arrow_angle <- pi/180 * 13
lamp_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                      240, 90411, 'degree', 
                                        stage_colour, orig_size, 0,
                                      27, 90411.5, 'a', 
                                        abcd_colour, abcd_size, 0,
                                      14, 90408.5, '"b,"', 
                                        abcd_colour, abcd_size, 0,
                                      20, 90406.5, '"*"', 
                                        stage_colour, star_size, 0,
                                      23, 90393, 'c', 
                                        abcd_colour, abcd_size, 0,
                                      61, 90391, '"^"', 
                                        stage_colour, hat_size, 0,
                                      67, 90395, '"d"', 
                                        abcd_colour, abcd_size, 0,
                                      68, 90433, 'bold("_")',
                                        stage_colour, bar_size, 0,
                                      68, 90467, '"~"', 
                                        stage_colour, tilde_size, 0,
                                      0, 90405, 'Hyperconservation', 
                                        annotation_colour, 
                                        annotation_size - 1,
                                        lamp_Re_label_angle,
                                      16, 90425, 'Re[tot] == 0*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                     6, 90422, paste0("Re[empl] == '", Re_empl_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle,
                                      1, 90444.2, 'Re[sub]', 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      6, 90440.5, paste0("'", Re_sub_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      24, 90450, 'Re[inc]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      29, 90446, paste0("'", Re_inc_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      86, 90425.7, 'Re[macro]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      91, 90421, paste0("'", Re_macro_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      202, 90450, 'Re[tot] == 100*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      105, 90432, paste0("Re[tot] == '", Re_tot_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      230, 90457, 'Backfire',
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle)

lamp_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                  -6, 90440, lamp_Re_arrow_angle, 18.8, annotation_colour, example_arrow_size, # Re_sub arrow
                                  13, 90444.35, lamp_Re_arrow_angle, 30, annotation_colour, example_arrow_size, # Re_inc arrow
                                  74, 90420, lamp_Re_arrow_angle, 30, annotation_colour, example_arrow_size) # Re_macro arrow

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Energy") + 
  ggplot2::geom_spoke(data = lamp_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = lamp_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<LampCostGraph, echo = FALSE, fig.cap="Expenditure pathgraph for the lamp example. CV is compensating variation.", fig.width=6, fig.height=4>>=
lamp_cost_line_angle <- -23.6
lamp_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                    8.6, 27921.7, 'degree', 
                                      stage_colour, orig_size, 0,
                                    0.85, 27921.7, 'a', 
                                      abcd_colour, abcd_size, 0,
                                    1.05, 27920.7, '"b"', 
                                      abcd_colour, abcd_size, 0,
                                    0.75, 27920, '"*"',
                                      stage_colour, star_size, 0,
                                    0.8, 27916.5, 'c', 
                                      abcd_colour, abcd_size, 0,
                                    2.2, 27915.7, '"^"', 
                                      stage_colour, hat_size, 0,
                                    2.36, 27916.5, 'd', 
                                      abcd_colour, abcd_size, 0,
                                    2.45, 27927.7, 'bold("_")', 
                                      stage_colour, bar_size, 0,
                                    5.25, 27925, 'Original~expenditure',
                                      annotation_colour, annotation_size, lamp_cost_line_angle,
                                    3.75, 27917.2, 'After~emplacement',
                                      annotation_colour, annotation_size, lamp_cost_line_angle,
                                    1.54, 27917.3, 'After~CV',
                                      annotation_colour, annotation_size-1, lamp_cost_line_angle,
                                    4.1, 27918.6, 'After~expected~savings',
                                      annotation_colour, annotation_size, lamp_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Expenditure") + 
  ggplot2::geom_text(data = lamp_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  ggplot2::scale_x_continuous(breaks = seq(2, 8, by = 2)) +
  ggplot2::scale_y_continuous(breaks = seq(27916, 27928, by = 2)) +

  MKHthemes::xy_theme()
@


<<LampConsGraph, echo=FALSE, warning=FALSE, fig.cap="Consumption path for the lamp example.", fig.width=6, fig.height=4>>=
lamp_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                     1.05, 1.00002, 'degree', 
                                       stage_colour, orig_size,
                                     1.097, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.155, 1.000019, 'a', 
                                       abcd_colour, abcd_size,
                                     1.2, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.26, 1.0000195, 'b', 
                                       abcd_colour, abcd_size,
                                     1.3, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.37, 1.000001, '"*"', 
                                       stage_colour, star_size,
                                     0.7, 1.000074, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     1.57, 0.999811, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     0.7, 0.999988, '"*"', 
                                       line_label_colour, star_line_label_size,
                                     3.5, 0.999897, '"*"',
                                       line_label_colour, star_line_label_size,
                                     0.96, 0.99984, 'c', 
                                       abcd_colour, abcd_size,
                                     2.4, 0.999825, '"^"',
                                       stage_colour, hat_size,
                                     0.7, 0.999892, '"^"',
                                       line_label_colour, hat_line_label_size,
                                     3.4, 0.999804, '"^"', 
                                       line_label_colour, hat_line_label_size,
                                     2.49, 0.999865, 'd',
                                       abcd_colour, abcd_size,
                                     2.5, 1.00027, 'bold("_")', 
                                       stage_colour, bar_size,
                                     0.7, 1.000305, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     3.5, 1.000215, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     2.46, 0.9998, 'r', 
                                       abcd_colour, r_line_label_size,
                                     2.46, 1.0004, 'r',
                                       abcd_colour, r_line_label_size,
                                     0.75, 1.00016, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     3.4, 0.99985, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     1.21, 1.00038, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     3.4, 1.000255, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Consumption") + 
    ggplot2::geom_text(data = lamp_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.99979, 1.0004) +
  MKHthemes::xy_theme()
@


%------------------------------
\subsubsection{Results} 
\label{sec:lamp_results}
%------------------------------

Results are represented graphically in energy, expenditure, and consumption path graphs
in Figs.~\ref{fig:LampEnergyGraph}--\ref{fig:LampConsGraph}.
The energy path graph (Fig.~\ref{fig:LampEnergyGraph})
shows the size of each rebound effect
for the lamp example.

The results for the lamp upgrade are shown in Table~\ref{tab:lamp_results}.

<<lamp_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:lamp_results", 
                                      caption = "Lamp example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


The \empleffect{} rebound components start with
the direct emplacement effect ($Re_{dempl}$),
which is always $\Sexpr{Re_dempl_lamp_char_perc}$\%.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is $\Sexpr{Re_emb_lamp_char_perc}$\%.
Although the LED lamp has higher embodied energy 
($\aempl{E}_{emb} = \Sexpr{E_emb_star_lamp_char}$~MJ)
than the incandescent lamp 
($\bempl{E}_{emb} = \Sexpr{E_emb_orig_lamp_char}$~MJ),
the LED lamp has a much longer lifetime,
meaning that the LED embodied energy \emph{rate}
($\raempl{E}_{emb} = \Sexpr{E_dot_emb_star_lamp_char}$~MJ/year)
is less than the incandescent embodied energy rate
($\rbempl{E}_{emb} = \Sexpr{E_dot_emb_orig_lamp_char}$~MJ/year).
Thus, the change in embodied energy rate ($\Delta \raempl{E}_{emb}$)
is $\Sexpr{Delta_E_dot_emb_star_lamp_char}$~MJ/year, 
and embodied energy rebound is negative
($Re_{emb} = \Sexpr{Re_emb_lamp_char_perc}$\%).
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is \Sexpr{Re_md_lamp_char_perc}\%,
because we assume no difference in maintenance and disposal costs between 
the incandescent lamp and the LED lamp%
\footnote{
  Maintenance cost rates for both incandescent and LED lamps are likely to be equal 
  and negligible;
  lamps are usually installed and forgotten.
  Real-world disposal cost differences between the incandescent and LED technologies
  are also likely to be negligible. 
  However, if ``disposal'' includes recycling processes, 
  cost rates may be different between the two technologies
  due to the wide variety of materials in LED lamps compared to incandescent lamps.
}.

Direct \subeffect{} rebound 
($Re_{dsub}$) is \Sexpr{Re_dsub_lamp_char_perc}\%
due to the much higher LED lamp efficacy
($\amacro{\eta} = \Sexpr{eta_better}$~lm/W) 
compared to the incandescent lamp
($\bempl{\eta} = \Sexpr{eta_worse}$~lm/W),
leading to increased demand for lighting
(from $\rbsub{q}_s = \Sexpr{q_dot_s_star_lamp_char}$~lm-hr/year
to $\rasub{q}_s = \Sexpr{q_dot_s_hat_lamp_char}$~lm-hr/year)
as shown by segment \chat{} in Fig.~\ref{fig:LampConsGraph}.
To maintain constant utility, 
consumption of other goods is reduced
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_lamp_char}$~\$/year), 
as shown by segment \starc{} in Fig.~\ref{fig:LampConsGraph},
yielding indirect substitution effect rebound
($Re_{isub}$) of $\Sexpr{Re_isub_lamp_char_perc}$\%.

\Inceffect{} rebound arises from spending net energy cost savings
associated with converting from the incandescent lamp to the LED lamp
($\rbinc{N} = \Sexpr{N_dot_hat_lamp_char}$~\$/year).
Direct income effect rebound 
($Re_{dinc}$) is \Sexpr{Re_dinc_lamp_char_perc}\%,
positive but small, 
as the lamp owner allocates 
some of the net savings to increased demand for lighting. 
The indirect income effect rebound is large
($Re_{iinc} = \Sexpr{Re_iinc_lamp_char_perc}$\%), 
due to the energy implications of increased spending on other goods.
Total microeconomic scale rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_lamp_char_perc}$\%.

Finally, \macroeffect{} rebound
($Re_{\macro}$) is coincidentally also \Sexpr{Re_macro_lamp_char_perc}\%
with $k$ assumed to be 1,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (lighting).


%++++++++++++++++++++++++++++++
\subsection{Sensitivity analyses}
\label{sec:sensitivity_analyses}
%++++++++++++++++++++++++++++++

Sensitivity analyses show the effect of 
independently varied parameters on total rebound and rebound components.
In the context of this framework,
sensitivity analyses
can show important trends, tendencies, and relationships
between rebound parameters and rebound magnitudes.
Key rebound parameters include 
post-EEU efficiency ($\amacro{\eta}$),
capital cost ($\amacro{C}_{cap}$),
energy price ($p_E$),
uncompensated price elasticity of energy service demand ($\eqspsUC$), 
and the macro factor ($k$).
Sensitivity analyses must be interpreted carefully,
because rebound parameters are not expected to be 
independent of each other.

In each subsection below, a series of graphs
shows the effects of varying each of these five key rebound parameters
($\amacro{\eta}$, 
$\amacro{C}_{cap}$, 
$p_E$, 
$\eqspsUC$, 
and $k$)
on total energy rebound ($Re_{tot}$) and its components
($Re_{emb}$, $Re_{md}$, $Re_{dsub}$, $Re_{isub}$,
$Re_{dinc}$, $Re_{iinc}$, and $Re_{\macro}$).
In the graphs, 
nominal values for the rebound parameters are shown as points, 
and sensitivity trends are shown as lines. 
A limitation of each sensitivity analysis 
is noted at the end of each subsection.


%------------------------------
\subsubsection{Effect of post-EEU efficiency ($\amacro{\eta}$)} 
\label{sec:effect_of_efficiency}
%------------------------------

<<efficiency_ratios, echo=FALSE>>=
car_efficiency_ratio <- (rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)

lamp_efficacy_ratio <- (rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)
@

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
both the energy takeback rate and expected energy savings ($\Sdot$)
increase with post-EEU efficiency ($\amacro{\eta}$), 
but the relationship is asymptotic.
Each unit increase of fuel economy or lighting efficacy is less effective than
the previous unit increase of fuel economy or lighting efficacy
for saving energy.
At very high levels of fuel economy economy or lighting efficacy, 
a unit increase leads to almost no additional energy savings.
Thus, we can say there are diminishing returns of fuel economy and lighting efficacy,
leading to saturation of energy savings at very high levels of fuel economy and lighting efficacy.
A simple example illustrates.
A $\bempl{\eta} = 25$ mpg car drives $\bempl{q}_s = 100$ miles 
using $\bempl{E}_s = 4$ gallons of gasoline.
A more-efficient car ($\amacro{\eta} = 30$ mpg) is expected to use
$\aempl{E}_s = 3.33$ gallons to drive the same distance,
a savings of $\Sdot = 0.67$ gallons.
Another 5 mpg boost in efficiency (to $\amacro{\eta} = 35$ mpg)
will use $\aempl{E}_s = 2.86$ gal to drive 100 miles, 
a further expected savings of only $\Sdot = 0.47$ gallons.
Each successive 5 mpg boost in fuel economy 
saves less energy than the previous 5 mpg boost in fuel economy.


<<eta_tilde_takeback_Sdot_sens_graph, echo=FALSE, fig.cap="Expected energy savings rate ($\\Sdot$, solid line) and takeback rate (dashed line) sensitivity to post-EEU efficiency ($\\amacro{\\eta}$). (Note different $x$- and $y$-axis scales.)", fig.width=6, fig.height=4>>=
actual_cases <- rebound_data %>% 
  dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] %in% c("Car", "Lamp"))

eta_sens_params = list(Car = list(eta_engr_units_star = seq(35, 50, by = 0.5)), 
                       Lamp = list(eta_engr_units_star = seq(70000, 90000, by = 5000)))

eta_sens_data <- ReboundTools::parametric_analysis(original_cases = actual_cases,
                                                   parameterization = eta_sens_params) %>%
  dplyr::mutate(
    takeback = .data[[ReboundTools::rebound_terms$Re_tot]] * .data[[ReboundTools::star_vars$S_dot_dev]]
  )

# This is a hacky formatter function 
# that formats the x-axis numbers of the graphs.
# The argument x_breaks is the breaks for an axis.
# The function checks to see if the breaks are > 1000 and divides by 1000 in that case.
# This approach works, because lm-hr/kW-hr values are > 1000 for the lamp example
# but the car example has mpg (which are all less than 100).
# So this function divides the Lm-hr/kW-hr values by 1000 while leaving the mpg values unchanged.
eta_tilde_formatter <- function(x_breaks) {
  if (all(x_breaks > 1000)) {
    # To convert Lm-hr/kW-hr to Lm-hr/W-hr.
    return(x_breaks/1000)
  }
  # To leave mpg alone.
  return(x_breaks)
}

sensitivity_graphs(.parametric_data = eta_sens_data,
                   x_var = "eta_engr_units_star", 
                   y_var = c(ReboundTools::star_vars$S_dot_dev, "takeback")) +
  ggplot2::facet_wrap(facets = "Case", scales = "free") +
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::scale_y_continuous(limits = c(0, NA)) +
  ggplot2::scale_colour_manual(values = c(S_dot_dev = "black", takeback = "black"), guide = "none") + 
  ggplot2::scale_size_manual(values = c(S_dot_dev = 0.5, takeback = 0.5), guide = "none") + 
  ggplot2::scale_linetype_manual(values = c(S_dot_dev = "solid", takeback = "dashed"), guide = "none") +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = expression("Takeback rate and "*dot(S)[dev]*" [MJ/yr]"),
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() + 
  ggplot2::theme(        
    # Move the facet labels out of the graphs slightly.
    strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2))
  )
@


Saturation can be seen mathematically, too.
Taking the limit as $\amacro{\eta} \rightarrow \infty$ 
in Eq.~(\ref{eq:Sdot}) gives $\Sdot = \rbempl{E}_s$, 
not $\infty$. 
Thus, efficiency saturation must occur.
Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}
shows that this framework correctly replicates
expected efficiency saturation trends.

Saturation is especially noticeable in the lamp example
compared to the car example,
the difference being that 
the LED lamp is already much more efficient than the incandescent lamp
(\Sexpr{lamp_efficacy_ratio}$\times$),
whereas the hybrid car is only 
\Sexpr{car_efficiency_ratio}$\times$ more efficient than the conventional gasoline car. 
Thus, at $\amacro{\eta} = \Sexpr{efficacy_better}$ lm-hr/W-hr, 
the energy efficient LED
is far closer to efficiency saturation than the hybrid vehicle 
(at $\amacro{\eta} = \Sexpr{mpg_better}$ mpg).
As a result, further increases in the LED lamp's efficiency 
are less effective than further increases in the hybrid car's efficiency.

That said, actual savings is the difference between the expected energy savings line (solid line)
and the takeback line (dashed line) in Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}.
Because the gap between the lines grows, 
higher efficiency yields greater energy savings,
even after accounting for rebound effects.
But the actual savings are always less than expected savings, due to takeback.

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
expected energy savings ($\Sdot$) increase faster than takeback 
as $\amacro{\eta}$ increases.
Thus, total rebound ($Re_{tot}$, the ratio of 
takeback rate to expected energy savings rate in Eq.~(\ref{eq:Re_takeback})),
decreases as efficiency grows.
The lamp exhibits a relatively smaller rebound decline with efficiency,
because the lamp example is closer to saturation than the car example.

Fig.~\ref{fig:all_Re_terms_eta_graph} shows the variation of all rebound components
with post-EEU efficiency ($\amacro{\eta}$).
In the car and lamp examples, 
direct substitution rebound ($Re_{dsub}$) is the 
rebound component 
most sensitive to changes in post-EEU efficiency ($\amacro{\eta}$).

A limitation of the energy efficiency sensitivity analysis is that 
post-EEU efficiency ($\amacro{\eta}$)
is unlikely to be independent of other factors, 
such as capital cost ($\amacro{C}_{cap}$).

Note that the sensitivity analysis on post-upgrade efficiency 
($\amacro{\eta}$, Fig.~\ref{fig:all_Re_terms_eta_graph})
is the only sensitivity analysis that requires careful explication
of both the numerator and denominator of Eq.~(\ref{eq:Re_takeback}),
as in Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}, 
because both the numerator and denominator of Eq.~(\ref{eq:Re_takeback})
change when post-upgrade efficiency ($\amacro{\eta}$) changes.
The denominator of Eq.~(\ref{eq:Re_takeback}) doesn't change for
the sensitivity analyses of Figs.~\ref{fig:all_Re_terms_C_cap_graph}--\ref{fig:all_Re_terms_k_graph}.
Thus, for the remaining sensitivity analyses, 
when the rebound percentage increases (decreases), 
the energy takeback rate in the numerator of Eq.~(\ref{eq:Re_takeback})
increases (decreases) proportionally,
and the actual energy savings rate decreases (increases) accordingly.


<<all_Re_terms_eta_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to post-EEU efficiency ($\\amacro{\\eta}$).", fig.width=6, fig.height=4>>=
Re_graph_params <- ReboundTools::sens_graph_params
Re_graph_params[["include_x_axis"]] <- TRUE
Re_graph_params[["use_latex_legend"]] <- TRUE

Re_terms_order <- ReboundTools::rebound_terms[c(ReboundTools::rebound_terms$Re_tot,
                                                ReboundTools::rebound_terms$Re_macro,
                                                ReboundTools::rebound_terms$Re_dinc,
                                                ReboundTools::rebound_terms$Re_iinc,
                                                ReboundTools::rebound_terms$Re_dsub,
                                                ReboundTools::rebound_terms$Re_isub,
                                                ReboundTools::rebound_terms$Re_dempl,
                                                ReboundTools::rebound_terms$Re_emb,
                                                ReboundTools::rebound_terms$Re_md)] %>% 
  unlist()

rebound_terms_graph(rebound_data = actual_cases, parameterization = eta_sens_params, 
                    x_var = "eta_engr_units_tilde", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() + 
  ggplot2::theme(legend.text.align = 0, 
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of capital cost ($\amacro{C}_{cap}$)} 
\label{sec:effect_of_capital_cost}
%------------------------------

The sensitivity of energy rebound
to capital cost ($\amacro{C}_{cap}$) is shown
in Fig.~\ref{fig:all_Re_terms_C_cap_graph}.
All other things being equal,
as capital cost of the EEU rises, 
less net savings result from the emplacement effect,
leading to smaller income, macro, and total rebound.
The same effects would be observed
with increasing maintenance and disposal cost rate ($\ramacro{C}_{\md}$).

A limitation of the capital cost sensitivity analysis is that
capital cost ($\amacro{C}_{cap}$) is unlikely to be
independent of $\amacro{\eta}$.
Within a given energy efficiency technology
(e.g., hybrid cars or LED lamps),
greater capital cost ($\amacro{C}_{cap}$) may be associated with
greater service efficiency ($\amacro{\eta}$).
$\amacro{C}_{cap}$ and $\amacro{\eta}$ should probably be varied jointly,
not independently.

<<all_Re_terms_C_cap_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to capital cost ($\\amacro{C}_{cap}$).", fig.width=6, fig.height=4>>=
C_dot_cap_sens_params <- list(Car = list(C_cap_star = seq(30000, 36000, by = 1000)),
                              Lamp = list(C_cap_star = seq(0.5, 10.0, by = 0.1)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = C_dot_cap_sens_params,
                    x_var = "C_cap_star", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::scale_x_continuous(breaks = c(1, 2, 4, 6, 8, 10, seq(30000, 36000, by = 2000))) + 
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::labs(x = expression(tilde(C)[cap]*" [$]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of energy price ($p_E$)} 
\label{sec:effect_of_energy_price}
%------------------------------

<<Germany_results, echo=FALSE>>=
# In the calculations, we include same parameters for German energy prices.
# Extract that information here for use in the paragraph below.
Car_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Car - Germany") %>% 
  dplyr::select("Re_tot")
Lamp_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Lamp - Germany") %>% 
  dplyr::select("Re_tot")
@


The effect of energy price on rebound is shown in Fig.~\ref{fig:all_Re_terms_p_E_graph}.
Increasing energy prices lead to larger total rebound ($Re_{tot}$),
because higher energy prices lead to more net savings ($\rasub{N}$)
to be spent by the device owner.
All other things being equal, more net savings leads to 
more spending on other goods and services that demand energy.

Fig.~\ref{fig:all_Re_terms_p_E_graph} also 
shows the effect of energy price ($p_E$)
on all rebound components.
Most rebound components increase with energy price, 
with the car and lamp examples exhibiting different sensitivities. 
Substitution effects ($Re_{dsub}$ and $Re_{isub}$)
are the only rebound components that decrease with energy price ($p_E$).
Substitution effects decrease with energy price, because 
at high energy price, less behavior adjustment is needed to re-equilibrate 
after emplacement of the efficient device.

<<GermanPrices, echo=FALSE>>=
price_data <- tibble::tribble(~Case, ~Country, ~p_E_engr_units,
                              "Car", "DEU", rebound_data %>% 
                                dplyr::filter(Case == "Car - Germany") %>% 
                                magrittr::extract2("p_E_engr_units"),     # $/USgal
                              "Lamp", "DEU", rebound_data %>% 
                                dplyr::filter(Case == "Lamp - Germany") %>% 
                                magrittr::extract2("p_E_engr_units"))     # $/W-hr
@

German energy prices%
\footnote{
  For the car example,
  the gasoline price in Germany is taken as 1.42 \euro{}/liter for the average ``super gasoline'' (95 octane) 
  price in 2018~\citep{finanzen}.
  For the lamp example,
  the electricity price in Germany is taken as 0.3 \euro{}/kW-hr for the 2018 price of a household using 3.5~MWh/year,
  an average value for German households~\citep{bundesministerium}.
  Converting currency (at 1 \euro{} = \$1.21) and
  physical units gives 
  \Sexpr{price_data %>% 
           dplyr::filter(Country == "DEU" & Case == "Car") %>% 
           magrittr::extract2("p_E_engr_units")}~\$/US~gallon and 
  \Sexpr{price_data %>% 
           dplyr::filter(Country == "DEU" & Case == "Lamp") %>% 
           magrittr::extract2("p_E_engr_units")}~\$/kW-hr.}
%
are shown as vertical lines,
providing an indication of possible energy price variations.
All other things being equal, 
if U.S.\ residents paid Germany's energy prices,
energy rebound would be 
$\Sexpr{formatC(unlist(Car_Germany_Re_tot * 100), digits = 3)}$\%
for the car example and 
$\Sexpr{formatC(unlist(Lamp_Germany_Re_tot * 100), digits = 3)}$\%
for the lamp example, assuming $k = 1$.

A limitation of the energy price sensitivity analysis arises from the fact that
energy price is not independent of other parameters.
Indeed, other rebound parameters
would change along with energy price
(especially if moving from one country to another),
including capital cost ($\amacro{C}_{cap}$), 
maintenance and disposal expenditure rate ($\ramacro{C}_{\md}$),
energy intensity of the economy ($I_E$), and
energy service consumption rate ($\rbempl{q}_s$).

<<all_Re_terms_p_E_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to energy price ($p_E$). German energy prices denoted by vertical lines.", fig.width=6, fig.height=4>>=
p_E_sens_params <- list(Car = list(p_E_engr_units = seq(1, 8, by = 0.5)),
                        Lamp = list(p_E_engr_units = seq(0.05, 0.4, by = 0.01)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = p_E_sens_params, 
                    x_var = "p_E_engr_units", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::geom_vline(data = price_data, 
                      mapping = ggplot2::aes_string(xintercept = "p_E_engr_units"), 
                      size = 0.1) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 1, by = 0.2)) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::labs(x = expression(p[E]*" [$/gal (Car) or $/kW-hr (Lamp)]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of elasticity ($\eqspsUC$)} 
\label{sec:effect_of_elasticity}
%------------------------------

Fig.~\ref{fig:all_Re_terms_eps_graph} shows the variation of total rebound ($Re_{tot}$)
with the uncompensated price elasticity of energy service demand ($\eqspsUC$).
The effect is exponential, and
total rebound increases with larger negative values of $\eqspsUC$, as expected.
The lamp example also shows stronger exponential variation than the car example.
The main reason that total rebound values 
are different between the two examples
is the larger absolute value of elasticity ($\eqspsUC$) 
for the lamp ($-0.4$) compared to the car ($-0.2$).
Were the car to have the same elasticity as the lamp ($-0.4$), 
total rebound would be approximately the same for both examples ($\sim 50$\%).
Fig.~\ref{fig:all_Re_terms_eps_graph} shows that direct substitution rebound 
($Re_{dsub}$) is the most sensitive rebound component to changes in $\eqspsUC$.
For the lamp example, indirect income rebound ($Re_{iinc}$) also increases
substantially with $\eqspsUC$, 
because net income increases substantially with $\eqspsUC$. 

A limitation of the elasticity sensitivity study derives from limitations of the 
CES utility model itself, which constrains price elasticity variation
given an elasticity of substitution.
Uneconomic conditions should be avoided.
For example, negative direct substitution rebound ($Re_{dsub} < 0$)
is obtained when $\left| \eqspsUC \right| < \fCs$,
because Eq.~(\ref{eq:sigma}) pushes 
the elasticity of substitution negative ($\sigma < 0$).
In reality, smaller negative (closer to 0) price elasticity ($\eqspsUC$)
would correlate with a smaller fraction of expenses spent on the energy service ($\fCs$), 
thereby avoiding the uneconomic condition.
However, a univariate sensitivity study cannot capture this effect and is
best used for smaller variations in $\eqspsUC$
about a nominal value.

<<all_Re_terms_eps_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to uncompensated energy service price elasticity of energy demand ($\\eqspsUC$). (Note reversed $x$-axis scale.)", fig.width=6, fig.height=4>>=
eps_sens_params <- list(Car = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)),
                        Lamp = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = eps_sens_params,
                    x_var = "e_qs_ps_UC", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::scale_x_reverse() +
  ggplot2::labs(x = expression(epsilon[dot(q)[s]*","*p[s]]),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of macro factor ($k$)} 
\label{sec:effect_of_macro_factor}
%------------------------------

The sensitivity of energy rebound 
to the macro factor ($k$) is shown 
in Fig.~\ref{fig:all_Re_terms_k_graph}.
The macro factor has a linear effect on total rebound ($Re_{tot}$)
through the macro rebound component ($Re_{\macro}$).
All other rebound components are constant when $k$ is varied independently.

A limitation of the macro factor sensitivity analysis is that
the macro factor ($k$) is unlikely to be 
independent of $I_E$, because 
different values of $k$ imply a different macroeconomy.

<<all_Re_terms_k_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to the macro factor ($k$).", fig.width=6, fig.height=4>>=
k_sens_params <- list(Car = list(k = seq(0.5, 3.5, by = 0.5)),
                      Lamp = list(k = seq(0.5, 3.5, by = 0.5)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = k_sens_params,
                    x_var = "k", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 1, by = 0.2)) + 
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::labs(x = expression("k [-]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion}
\label{sec:discussion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we revisit and discuss the contributions indicated 
in Section~\ref{sec:aim_contribution_structure}.
Then we show how the framework enables insights
on energy policy, especially policies to encourage energy efficiency. 
Finally, we discuss and calibrate the macro factor ($k$).


%++++++++++++++++++++++++++++++
\subsection{Contributions}
\label{sec:framework_novelties}
%++++++++++++++++++++++++++++++

In Section~\ref{sec:aim_contribution_structure}, 
we claimed four contributions.
Here, we reiterate and discuss each.

First, we believe we have developed 
the first comprehensive rebound analysis framework to include both
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item capital cost, embodied energy, and maintenance and disposal effects and         
  
  \item non-marginal energy service price decreases and non-marginal energy efficiency increases.
    
\end{enumerate*}
%
The embodied energy and maintenance and disposal effects
are the energy manifestation of the important difference 
between costless technology upgrades and
(costly) mandated efficiency increases \citep{Gillingham:2013aa,Fullerton2020}.
Costly EEUs are not typically 
included in partial equilibrium rebound frameworks \citep{Azevedo2014,Gillingham:2020aa};
most rebound analysis frameworks assume costless upgrade in both financial and energy terms.
One surprising result from including costly upgrades is
that accounting for differential capital cost ($\Delta \raempl{C}_{cap}$)
can \emph{increase} rebound when
the capital cost rate decreases
($\rorig{C}_{cap} > \raempl{C}_{cap}$).
The lamp example of Section~\ref{sec:lamp_example} illustrates this result.
This finding demonstrates that the costless EEU does not provide an upper bound to rebound,
as previously suggested by \citet{Thomas:2013ab}.

The accommodation of non-marginal energy efficiency increases and 
non-marginal energy service price decreases
is made possible by direct calculation of consumption positions 
via the CES utility model of Eqs.~\ref{eq:q_s_solution}--\ref{eq:Re_isub_CES}, 
rather than relying on the approximate utility model and price elasticities. 

The possibility of precisely decomposing microeconomic rebound into 
substitution and income effects in direct and indirect locations
was outlined by \citet{Khazzoom1980}, 
spelled out clearly by \citet{greening2000}, and 
numerically approximated by \citet{Borenstein:2015aa}. 
Yet, authors of previous operational frameworks of microeconomic rebound
typically show only stylized graphs of indifference curves in the consumption space, 
even if they are numerically precise in other respects 
\citep{Thomas:2013aa,Moshiri2017,Li2018}.

The stylized indifference curves of previous frameworks 
lead to the second contribution of this paper, 
namely the first visualizations of rebound effects
in energy, expenditure, and consumption spaces. 
We call these visualizations ``rebound path graphs,'' and
they can be seen in Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:LampConsGraph}. 
Our precisely drawn and quantified rebound path graphs
through energy, expenditure, and consumption spaces
aid comprehension of and intuition about the various rebound effects.

Segment \bartilde{} in energy path graphs is the macro effect,
the third contribution.
We have developed the first operational link between 
rebound effects on macroeconomic and microeconomic scales. 
We both operationalize the link and show how it should be applied:
scaling net income after the substitution effect.
We further draw upon the MPC literature to show how macro effects 
operate via economic expansion over the long term.
This micro-to-macro link can be seen in Eq.~(\ref{eq:Re_macro_def}) and
Figs.~\ref{fig:ExampleEnergyPathGraph}, \ref{fig:CarEnergyGraph}, and \ref{fig:LampEnergyGraph}.
We make the first calibration of the macro factor ($k$) 
in Section~\ref{sec:calibrating_k} below.

The fourth contribution is tools for calculating
rebound for other EEUs with this framework.
The tools include an Excel workbook and an \texttt{R} package.
See the Leeds University data repository and
the ReboundTools \texttt{R} package~\citep{Heun:2021us}.


%++++++++++++++++++++++++++++++
\subsection{Policy considerations}
\label{sec:policy}
%++++++++++++++++++++++++++++++

We take for granted that it is desirable
to use energy efficiency to reduce energy consumption and CO$_2$ emissions.
For energy efficiency to be as effective as possible
at reducing CO$_2$ emissions,
rebound should be taken into account.
The sensitivity analyses of Section~\ref{sec:sensitivity_analyses}
enable exploration of policy options that are often suggested
to promote energy efficiency and reduce CO$_2$ emissions:
energy efficiency standards, 
rebates or subsidies, and
carbon pricing or energy taxes.
In the subsections below, 
we discuss the rebound implications of each policy option with reference to the sensitivity analyses
of Section~\ref{sec:sensitivity_analyses}.


%------------------------------
\subsubsection{Energy efficiency standards} 
\label{sec:policy:standards}
%------------------------------

Energy efficiency standards mandate minimum efficiency levels for selling 
energy conversion devices into a market.
One example of energy efficiency standards is 
the Corporate Average Fuel Economy (CAFE) standards for U.S.\ cars.

Fig.~\ref{fig:all_Re_terms_eta_graph} shows that rebound falls
as post-upgrade energy efficiency ($\amacro{\eta}$) rises. 
This result is driven mainly by
decreasing direct substitution effect rebound ($Re_{dsub}$)
as efficiency goes up.
Declining $Re_{dsub}$ is driven by declining (i.e., closer to zero)
compensated own price elasticity of energy service demand ($\eqspsC$),
which leads to an equally declining
uncompensated price elasticity of energy service demand ($\eqspsUC$), 
an observable quantity.
(See also Fig.~\ref{fig:all_Re_terms_eps_graph}.)
As a result, raising the minimum efficiency 
required to participate in a market is beneficial
for reducing energy consumption.
Indeed, Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows the gap between 
the expected energy savings rate and the takeback rate grows with post-emplacement efficiency, so
absolute energy savings are expected to increase as efficiency grows, 
at least for the examples in Section~\ref{sec:examples}.
(We note in passing that this change in price elasticity is 
tractable only because the framework accommodates
non-marginal efficiency changes by calculating the new
consumption bundle directly from the CES utility model.)

However, larger efficiency increases can require higher overnight capital investment
within a given technology, 
which hinders adoption of energy-efficient devices.
One measure often employed to boost adoption is 
financial rebates or subsidies, the subject of the next section.


%------------------------------
\subsubsection{Rebates or subsidies} 
\label{sec:policy:rebates_or_subsidies}
%------------------------------

Larger efficiency increases can require higher capital investment 
within a given technology for an EEU.
To encourage market penetration of higher-efficiency devices, 
rebates or subsidies can be offered to device purchasers to incentivize adoption of 
energy-efficient technologies and grow their markets.
(One example of this approach is current subsidies for battery electric vehicles.)
Providing rebates or subsidies
effectively reduces the capital cost ($\amacro{C}_{cap}$) for the purchaser 
of energy-efficient devices.
However, Fig.~\ref{fig:all_Re_terms_C_cap_graph} shows that reducing capital cost 
increases energy rebound, 
mostly due to the income effect
in which more net savings (thanks to the rebate) 
are available to spend on the energy service and other goods.
Thus, policymakers should be aware that rebound will 
reduce the effectiveness of rebates and subsidies
to generate actual energy savings.

That said, a rebate or subsidy could be used as a tool 
to stimulate initial take-up of a new EEU technology.
From a rebound perspective, 
the subsidy-related stimulus should be removed when
cost reductions due to scale effects and learning by doing \citep{Wilson2012} 
take hold, and
the EEU uptake goes mainstream.

A potential downside to rebates and subsidies is inequities:
only those wealthy enough to afford expensive EEUs 
benefit from the subsidies.
To reduce inequities, income-dependent subsidies 
should be implemented%
\footnote{
  For a discussion of financing difficulties and the requisite size of rebates, see \citet{Fowlie2018}.
}.
Moreover, to avoid rebound generated by rebates or subsidies, 
policymakers may choose to implement energy taxes simultaneously,
effectively raising the price of energy, the topic of the next section.


%------------------------------
\subsubsection{Carbon pricing or energy taxes} 
\label{sec:splicy:energy_taxes}
%------------------------------

An energy tax or other penalty on energy consumption, 
preferably limited to fossil energy, 
likely by a price on carbon 
and enacted alongside the EEU,
does two things at the microeconomic scale.
First, a fossil-energy tax raises the effective price of fossil energy ($p_E$) and 
the price of any fossil-energy-powered energy service ($p_s$).
By raising the relative price of the energy service,
substitution effect rebound ($Re_{sub}$) shrinks, 
as shown in Fig.~\ref{fig:all_Re_terms_p_E_graph}. 
Second, a fossil-energy tax raises net financial savings earned 
by the device owner after emplacing the EEU.
The gross savings of the emplacement effect grows with the effective energy price,
driving higher income effect rebound ($Re_{inc}$).
Higher energy prices lead to higher macro rebound ($Re_{macro}$), too, 
again due to increased gross savings from the emplacement effect, 
assuming a constant value for the product of the macro factor
and the energy intensity of the economy ($k I_E$).
Larger income effect and macro effect rebounds overwhelm
the decrease in substitution effect rebound, 
leading to higher overall rebound 
from the effectively higher energy price,
as shown in Fig.~\ref{fig:all_Re_terms_p_E_graph}. 
But so long as backfire is avoided
(i.e., total rebound remains less than 100\%),
absolute energy savings will still occur, 
though at a lower rate than expected. 

That said, another outcome of carbon pricing or fossil-energy taxes could be 
reduction of the energy intensity of the economy ($I_E$), 
a dynamic effect not captured by the univariate sensitivity study 
of Fig.~\ref{fig:all_Re_terms_p_E_graph}.
The energy intensity of the economy could drop because
at the macroeconomic scale
higher energy prices are likely to induce both 
energy-saving technical change and
structural change toward an overall lower-energy-intensity economy.
To avoid the price penalty, 
consumers might buy other, more-efficient devices or consume substitutes
both for the energy service and in other areas of life,
thereby contributing to reducing $I_E$.
(See \citet{Hart2018} for a related discussion.)
A less-energy-intensive economy could be further encouraged by policymakers 
with complementary policies 
to encourage use of efficient substitutes,
such as public transport.

If carbon pricing or a fossil-energy tax reduces the energy intensity of the economy ($I_E$), 
all rebound terms whose equations include $I_E$ will be affected.
Thus, although the introduction of carbon prices or fossil-energy taxes
can induce higher income-effect rebound and higher macro-effect rebound, 
those increases might be less than predicted 
by the sensitivity study of Fig.~\ref{fig:all_Re_terms_p_E_graph},
due to reduction of the energy intensity of the economy ($I_E$).
And any reduction of $I_E$ due to fossil-energy taxes
will tend to reduce total rebound ($Re_{tot}$),
increasing the likelihood that backfire will be avoided and
absolute energy savings will occur.
Thus, total rebound estimated by this framework
(which assumes static $I_E$)
could provide an upper bound on rebound
for carbon pricing or fossil-energy taxes.

Carbon pricing or fossil-energy taxes are likely to be an effective policy option
to reduce energy consumption, rebound effects, and CO$_2$ emissions.
But the rebound implications of these policies deserve further study,
perhaps building on \citet{Chan2015}
to untangle the web of interconnected dynamic effects
when multiple fuels are involved.
One note of caution:
across-the-board carbon pricing or fossil-energy taxes could raise further equity issues
by limiting the ability of people in low-income groups to purchase energy \citep{Owen2020}. 
To ameliorate inequities, progressive feebates could be implemented%
\footnote{
  Feebates route energy tax revenues to lower-income EEU purchasers. 
  See \citet{Boyce2018}.
}.



%++++++++++++++++++++++++++++++
\subsection{Calibrating $k$}
\label{sec:calibrating_k}
%++++++++++++++++++++++++++++++

<<Calibrate_k, echo = FALSE>>=
Re_tot_expected <- 0.54
calibrated_k <- rebound_results %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::calibrate_k(Re_tot_expected)

# Land on k = 3 as a median value.
# Do a sensitivity study with those k values to recalculate everything.
k_cal_vals <- list(Car = list(k = 3),
                   Lamp = list(k = 3))

rebound_analysis_with_cal_k <- rebound_data %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::parametric_analysis(parameterization = k_cal_vals,
                                    include_orig_point = FALSE)
Re_macro_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_macro")
Re_macro_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_macro")
Re_tot_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_tot")
Re_tot_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_tot")
@

The framework developed in Section~\ref{sec:framework} 
links macroeconomic rebound to microeconomic rebound 
via a term that scales magnitudes in the microeconomic portion of the framework. 
Few rebound studies have explored the macroeconomic scale
between microeconomic and total rebound.
Inspired by \citet{Borenstein:2015aa} and others, 
we bridge macroeconomic and microeconomic scales with the macro factor ($k$), 
as discussed in Section~\ref{sec:macro_effect_main_paper}.
For the results presented in Section~\ref{sec:examples}, 
we assumed a placeholder value of $k = 1$,
meaning that every \$1 of spending by the device owner in the income effect
generates \$1 of additional economic activity in the broader economy.
In combination, the framework presented in Section~\ref{sec:framework}, 
the results obtained in Section~\ref{sec:examples}, and
recent estimates of total rebound allow, 
for the first time, 
a discussion about calibrating $k$.

To calibrate the macro factor ($k$),
we treat macro rebound ($Re_{\macro}$) as a residual.
The macro factor ($k$) becomes an unknown parameter whose value is to be chosen
such that $Re_{\macro}$
is sufficient to achieve an expected value for total rebound ($Re_{tot}$).
We take the expected value for $Re_{tot}$ from 
\citet{Brockway2021} among whose surveyed 33 recent studies where four
that examined total rebound only from consumer EEU in a computable general
equilibrium framework. The average total rebound ($Re_{tot}$) 
among these four is \Sexpr{Re_tot_expected*100}\%%
\footnote{
  The average total rebound among all 33 studies stood at 63\%,
  supporting the claim by \citeauthor{Turner:2013aa} that consumer
  and producer rebound vary.
}.
%
The calibrated values of $k$ that give identical $Re_{tot} = \Sexpr{Re_tot_expected*100}$\% 
for both examples are
$k = \Sexpr{formatC(calibrated_k[["Car"]], digits = 2)}$
for the car example and
$k = \Sexpr{formatC(calibrated_k[["Lamp"]], digits = 2)}$ 
for the lamp example.

Qualitative differences in benefits from EEUs as well as the considerable 
variance in $Re_{tot}$ in 33 surveyed studies 
indicates that total rebound from one EEU is likely to be different from 
total rebound from another EEU. 
For the purposes of illustration we set $k = 3$,
being between the values of $k$ 
estimated from the car and lamp examples.
Note that $k = 3$ implies that 
every \$1 of net savings spent by the device owner
generates \$3 of additional economic 
activity in the broader economy
after the income effect.
We multiply $k \rasub{N}$ by the energy intensity of the economy ($I_E$) to 
find the energy implications of macro-effect respending throughout the economy, 
as shown in Eq.~(\ref{eq:Re_macro_def}).

There are three ways to interpret $k = 3$.
First, $k = 3$ can be considered the average long-run 
economic growth generated by the device owner.
Efficiency increases in equipment drive a significant part of 
long-run productivity growth \citep{Greenwood1997}, therefore a large,
long-run multiplier is plausible even if the initial productivity
change occurred in household production, not accounted for in GDP.
Second, it could be that growth is less than 
\$3 but that the macroeconomic ``energy price effect" (a decline in 
energy prices due to the fallen demand) induces consumption at a higher
energy intensity than that of the pre-EEU economy. 
Third, from the demand-side perspective
entertained by \citet{Borenstein:2015aa}, 
$k = 3$ could be interpreted as $\MPC = 0.75$. 
(See Appendix~\ref{sec:income_macro_mpc}.)
$\MPC = 0.75$ is a reasonable value, 
being in the upper half of recent estimates by \citet{Carroll2017}.
Although the cause of the growth in economic activity and energy consumption from an EEU 
is a supply-side productivity shock,
the subsequent demand-side effects may well be interpreted as a multiplier effect, 
caused by higher real income instead of by higher monetary income.

After calibrating $k = 3$, we see that choosing a placeholder value of $k = 1$
in Section~\ref{sec:examples}
underestimated $Re_{\macro}$ and, therefore, $Re_{tot}$.
In Figs.~\ref{fig:CarEnergyGraph} and~\ref{fig:LampEnergyGraph},
the macro effect segments (\bartilde{})
should be three times longer than they appear.
In Tables~\ref{tab:car_results} and~\ref{tab:lamp_results},
the values of macro rebound ($Re_{\macro}$) should triple to
\Sexpr{formatC(Re_macro_car_k_3*100, digits = 3)}\% and
\Sexpr{formatC(Re_macro_lamp_k_3*100, digits = 3)}\%, and
the values of total rebound ($Re_{tot}$) should increase to 
\Sexpr{sprintf("%.1f", round(Re_tot_car_k_3*100, 1))}\% and
\Sexpr{formatC(Re_tot_lamp_k_3*100, digits = 3)}\%
for the car and lamp examples,
respectively.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this paper,
we developed a comprehensive, partial equilibrium rebound analysis framework that
combines all rebound effects, locations, and scales
across energy, expenditure, and consumption spaces with 
a detailed model of consumer preferences and
non-marginal energy service price changes
in an operational manner
for the 
simplest case of a single fuel and a single energy service.
This paper also contributes the first visualizations of 
rebound path graphs in energy, expenditure, and consumption spaces.
And we operationalize and calibrate the macro factor ($k = 3$)
to provide a link between effects at microeconomic and macroeconomic scales,
missing from previous partial equilibrium frameworks. 

From the development and application of the framework, 
we draw four important conclusions.
First, the car and lamp examples (Section~\ref{sec:examples}) show that
        the framework enables
        quantification of rebound magnitudes at microeconomic and macroeconomic scales, including 
        direct and indirect locations 
        for emplacement, substitution, income, and macro effects.
Second, the examples show that magnitudes of rebound effects
        vary with the type of EEU performed.
Third, the framework enables evaluation of rebound sensitivities to important parameters
        (Section~\ref{sec:sensitivity_analyses}). 
        For the examples in this paper, total rebound is   
        more sensitive to
        the price of energy ($p_E$),
        the elasticity of energy service demand ($\eqspsUC$), and
        the macro factor ($k$) 
        than either
        energy efficiency ($\amacro{\eta}$) or
        the capital cost ($\amacro{C}_{cap}$) of the upgraded device.
Fourth, the discussion (Section~\ref{sec:discussion}) shows that
        rebound is a headwind for efficiency-led reduction of energy consumption 
        and CO$_2$ mitigation policies.
        Quantification of rebound effect magnitudes
        is an important precursor to devising effective energy policies
        that would 
        encourage energy efficiency, 
        limit rebound effects, and
        reduce CO$_2$ emissions.

Future work could be pursued in several areas. 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item Other utility models (besides the CES utility model) 
        could be explored for the substitution effect.
  
  \item Further empirical studies could be performed
        to estimate the magnitude of different 
        rebound effects in a variety of real-life EEUs.

  \item Deeper study of macro rebound is needed, including improved estimates 
        for the macro factor ($k$) and its relation to the MPC.
        
  \item The rebound implications of the distribution of $\MPC$ values 
        across socioeconomic groups~\citep{Carroll2017}
        could be explored.

  \item This framework could be extended to producer-sided energy rebound effects.
  
  \item The rebound effects of fossil-energy taxes 
        could be studied further,
        especially for the web of interconnected dynamic effects
        among rebound components that are functions
        of the energy intensity of the economy ($I_E$).
    
  \item This framework could be embedded 
        in energy-economy models to better include rebound effects in discussions of 
        macro energy modeling, 
        energy policy, and 
        CO$_2$ emissions mitigation.

\end{enumerate*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Competing interests}
\label{sec:competing_interests}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Declarations of interest: none.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Author contributions}
\label{sec:author_contributions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{table}[h]
\begin{center}
\begin{tabular}{r c c c}
  \toprule
                              & MKH          & GS           & PEB          \\
  \midrule
  Conceptualization           & \rating{100} & \rating{100} &              \\
  Methodology                 & \rating{100} & \rating{100} & \rating{100} \\
  Software                    & \rating{100} &              &              \\
  Validation                  & \rating{100} &              & \rating{100} \\
  Formal analysis             & \rating{100} & \rating{100} & \rating{100} \\
  Investigation               & \rating{100} & \rating{100} & \rating{100} \\
  Resources                   & \rating{100} &              &              \\
  Data curation               &              &              & \rating{100} \\
  Writing--original draft     & \rating{100} & \rating{100} & \rating{100} \\
  Writing--review \& editing  & \rating{100} & \rating{100} & \rating{100} \\
  Visualization               & \rating{100} & \rating{100} &              \\
  Supervision                 & \rating{100} &              &              \\
  Project administration      & \rating{100} &              &              \\
  Funding acquisition         &              &              &              \\
\bottomrule
\end{tabular}
\label{tab:credit}
\end{center}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data repository}
\label{sec:data_repository}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

All data and calculations are stored at **** Leeds data repository URL. ****.
An \texttt{R} package for performing all rebound calculations
can be found at \url{https://github.com/MatthewHeun/ReboundTools}.
(See \citet{Heun:2021us}.)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
\label{sec:acknowledgements}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%List funding sources in this standard way to facilitate compliance to funder's requirements: Funding: This work was supported by the National Institutes of Health [grant numbers xxxx, yyyy]; the Bill \& Melinda Gates Foundation, Seattle, WA [grant number zzzz]; and the United States Institutes of Peace [grant number aaaa].

%It is not necessary to include detailed descriptions on the program or type of grants and awards. When funding is from a block grant or other resources available toa university, college, or other research institution, submit the name of the institute or organization that provided the funding.

%If no funding has been provided for the research, please include the following sentence: This research did not receive any specific grant from funding agencies  in the public, commercial, or not-for-profit sectors.

Paul Brockways time was funded by the UK Research and Innovation (UKRI) 
Council, supported under EPSRC Fellowship award EP/R024254/1.
The authors are grateful for comments from internal reviewers
Becky Haney and Jeremy Van Antwerp (Calvin University); 
Nathan Chan (University of Massachusetts at Amherst); and 
Zeke Marshall (University of Leeds).
The authors benefitted from discussions with 
Daniele Girardi (University of Massachusetts at Amherst) and 
Christopher Blackburn (Bureau of Economic Analysis).
Finally, the authors thank the students of MKH's Fall 2019 
Thermal Systems Design course (ENGR333) at Calvin University
who studied energy rebound for many energy conversion devices
using an early version of this framework.

% No need for this section label, because BibTeX already provides a "References" heading.
% \section*{References}

\bibliography{HSB_refs}



\appendix
\counterwithin{figure}{section}
\counterwithin{table}{section}

% Gives a helpful "Appendices" label
\section*{Appendices}

% Labels each appendix as A, B, C, etc. instead of Appendix A, Appendix B, Appendix C, etc.
\renewcommand{\thesection}{\Alph{section}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nomenclature}
\label{sec:nomenclature}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/nomenclature.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mathematical details of rebound path graphs}
\label{sec:graph_details}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/rebound_path_graph_details.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Derivation of comprehensive, consumer-based rebound analysis framework}
\label{sec:derivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/derivation.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Utility models and elasticities}
\label{sec:utility_and_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

<<UtilityAppendix, child="pieces/utility_and_elasticities.Rnw">>=
@



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proof: Income preference equations satisfy the budget constraint}
\label{sec:proof_income_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/proof_income_elasticities.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Other goods expenditures and constant $p_o$}
\label{sec:other_goods_expenditures}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/other_goods_expenditures.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Income and macro effects and relation to the
marginal propensity to consume (MPC)}
\label{sec:income_macro_mpc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \input{pieces/mpc.tex}

<<MPCAppendix, child="pieces/mpc.Rnw">>=
@



\end{document}
