\documentclass[12pt]{article}    % For submission



%% Package imports %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}           % For access to \checkmark.
\usepackage{amsmath}            % For better symbol decorations
\usepackage{authblk}            % For a nice author block
\usepackage{booktabs}           % For nice table rules
\usepackage[official]{eurosym}  % For the euro symbol
\usepackage[figurename=Fig.]{caption} % For changing "Figure" to "Fig." in figure captions
\usepackage{chngcntr}           % To get figure and table numbering correct in the appendices
\usepackage[makeroom]{cancel}   % To show terms go to zero
\usepackage[inline]{enumitem}   % For inline enumeration
\usepackage[letterpaper, left=0.75in, right=0.75in, top=0.75in, bottom=0.75in, footskip=.25in]{geometry} % For better margins.
\usepackage[]{lineno}           % For line numbers
% \modulolinenumbers[5]
\usepackage{microtype}          % For beautify typesetting
\usepackage{multicol}           % For multi-column layout
\usepackage{multirow}           % For multi-row layout
\usepackage{natbib}
\setlength{\bibsep}{0.0pt}      % To set the separation between entries to 0.
\usepackage{nccmath}            % For the \useshortskip command above equations
\usepackage{parcolumns}         % For multi-column layout
\usepackage{pdflscape}          % For landscape environment \begin{landscape} ... \end{landscape}
\usepackage{setspace}           % For double spacing
\doublespacing
\usepackage{soul}               % For text highlighting
\usepackage[most]{tcolorbox}    % For color highlighting of text
\usepackage{tikz}               % For diagrams
\usetikzlibrary{arrows,positioning}
\usepackage{ulem}               % For strikeout command (\sout)
\usepackage{xcolor}             % For ... colors
\usepackage{xr}                 % For external references to the framework paper
\externaldocument[PartI-]{HSB_framework}

\usepackage{hyperref}           % hyperref should be the last package loaded


%% Macros defined by authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/macros.tex}


%% Bibliography style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{apa-good.bst}

% Author info
\title{Energy, expenditure, and consumption aspects of rebound,\\
          Part II: Applications}
\author[1,*]{Matthew Kuperus Heun}
\author[2]{Gregor Semieniuk}
\author[3]{Paul E.\ Brockway}
\affil[1]{Engineering Department, Calvin University, 3201 Burton St. SE, Grand Rapids, MI, 49546}
\affil[2]{Political Economy Research Institute and 
                            Department of Economics,
                            UMass Amherst}
\affil[3]{Sustainability Research Institute, 
                             School of Earth and Environment,
                             University of Leeds}
\affil[*]{\normalfont{Corresponding author: \texttt{mkh2@calvin.edu}}}
\renewcommand\Affilfont{\itshape\small}

\date{} % Kill the date

\singlespace

\begin{document}

\maketitle


%% Abstract %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
Widespread implementation of energy efficiency
is a key greenhouse gas emissions mitigation measure, 
but rebound can ``take back'' energy savings.
However, the absence of solid analytical foundations hinders
empirical determination of the size of rebound.
A new clarity is needed, one that is built upon solid analytical frameworks
involving both economics and energy analysis.
In Part~I, we developed a rigorous analytical framework
built upon the microeconomics of rebound
that is approachable for both energy analysts and economists alike. 
In this paper (Part~II of a two-part paper),
we bring further clarity to energy rebound by 
developing energy, expenditure, and consumption rebound planes, 
a novel way to visualize and illustrate those three aspects of rebound.
Further, we perform the first calibration of the macro factor
for macroeconomic rebound, finding $k \approx 3$. 
Finally, we apply
the framework developed in Part~I 
and the visualization advances described in Part~II 
to calculate and show total rebound for two case studies: 
energy efficiency upgrades of
a car (47\%) and
an electric lamp (67\%).
Comparison of our rebound values to previous values is provided.
\end{abstract}

Keywords: Energy efficiency, Energy rebound, Energy services, Microeconomic rebound, Substitution and income effects, Macroeconomic rebound



<<setup, echo=FALSE, message=FALSE>>=
library(dplyr)
library(latex2exp)
library(magrittr)
library(MKHthemes)
library(ReboundTools)
library(tidyr)
library(xtable)
@

\linenumbers


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In Part I of this two-part paper, we argued that improved clarity is needed
about energy rebound. 
We said that
%
\begin{quote}
  a description of rebound is needed that is both
  %
  \begin{enumerate*}[label={(\roman*)}]

    \item technically rigorous and
  
    \item approachable from both sides
        (economics and energy analysis).

  \end{enumerate*}
  %
  In other words, 
  the finance and human behavior aspects of rebound need to be presented 
  in ways energy analysts can understand. 
  And the energy aspects of rebound need to be presented
  in ways economists can understand.
\end{quote}

To move improve clarity in the rebound field, 
we developed in Part~I a framework 
for analyzing energy rebound, 
one that is tractable for both energy analysts and economists.
Three aspects of rebound are analyzed in the framework:
energy, expenditure, and consumption.
The framework contains both
direct and indirect rebound
($d$ and $i$, respectively) and 
four rebound effects
(emplacement, substitution, income, and macro) 
between five stages ($\circ$, $*$, $\wedge$, $-$, and $\sim$).
Rebound terms and symbol decorations are
shown in Fig.~\ref{fig:flowchart}.
(See Table~\ref{PartI-tab:rebound_typology} in Part~I for details.)

\begin{figure}
\centering
  % The file is a Tikz picture.
  \input{pieces/flowchart.tex}
\caption{Flowchart of rebound effects and decorations.}
\label{fig:flowchart}
\end{figure}

In this paper (Part~II), we make further progress toward the goal of clarity
in three ways.
First, we develop a new way to visualize 
components and mechanisms of rebound
(rebound planes).
Second, we apply the framework to two energy efficiency upgrades (EEUs) 
(an electric lamp and an automobile)
with detailed explication of the examples.
Finally, we show 
calculations of rebound magnitudes for both examples.

The key contributions of Part~II are 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item development of the first (to our knowledge) 
        visualizations of rebound effects
        in energy, expenditure, and consumption planes,
        
  \item documentation of new rebound values for automobile and lighting 
        upgrades based on a calibrated version of our framework from Part~I, and 
        
  \item creation of open source software tools to calculate and visualize rebound 
        for any EEU.
  
\end{enumerate*}

The remainder of this paper is structured as follows.
Section~\ref{sec:methods} describes 
data for examples, 
our method of visualizing rebound, and 
software tools for calculating and visualizing rebound.
Section~\ref{sec:results} provides two examples: 
energy efficiency upgrades to a car and an electric lamp.
Section~\ref{sec:discussion} discusses the results, and 
Section~\ref{sec:conclusion} concludes.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Data and methods}
\label{sec:methods}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This section contains data for the examples
(Section~\ref{sec:data}), 
an explication of our new method for visualizing rebound effects and magnitudes
(Section~\ref{sec:path_graphs}), and
a description of new software tools for rebound calculations and visualization
(Section~\ref{sec:software_tools}).


%++++++++++++++++++++++++++++++
\subsection{Data}
\label{sec:data}
%++++++++++++++++++++++++++++++

<<eeu_data, echo=FALSE>>=
# Load our test cases and perform rebound analyses.
rebound_data <- ReboundTools::load_eeu_data("data/eeu_data.xlsx")
rebound_results <- ReboundTools::rebound_analysis(rebound_data)
@

To demonstrate application of the rebound analysis framework
developed in Part~I,
we analyze two case studies:
energy efficiency upgrades to a car and an electric lamp.
The case studies are presented with much detail here
to support our goal of bringing clarity to the process
of calculating the magnitude of rebound effects.
Here, we collect parameter values
for the equations to calculate
eight rebound components:
$Re_{dempl}$,
$Re_{emb}$,
$Re_{\md}$,
$Re_{dsub}$,
$Re_{isub}$,
$Re_{dinc}$,
$Re_{iinc}$, and
$Re_{\macro}$.
Total rebound 
($Re_{tot}$)
is given by the sum of the above components
or equivalently by Eq.~\ref{PartI-eq:Re_tot} of Part~I.


%------------------------------
\subsubsection{Data for car example} 
\label{sec:data_car_example}
%------------------------------

<<CarPrintableNumbers, echo=FALSE>>=
val_to_string <- function(case, val, to_perc = FALSE, scale = 1, digits = 1, format = "f", big.mark = ",") {
  val <- rebound_results %>% 
    dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == case) %>% 
    magrittr::extract2(val) %>% 
    magrittr::multiply_by(scale)
  if (to_perc) {
    val <- val * 100
  }
  val %>% 
    formatC(digits = digits, format = format, big.mark = big.mark)
}
# Parameters for first table
mpg_worse <- val_to_string(case = "Car", val = ReboundTools::orig_vars$eta_engr_units_orig, digits = 0)
mpg_better <- val_to_string(case = "Car", val = ReboundTools::star_vars$eta_engr_units_star, digits = 0)
C_dot_cap_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 0)
C_dot_cap_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_cap_star, digits = 0)
t_own_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_own_orig, digits = 0)
t_own_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_life_orig, digits = 0)
t_life_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$E_emb_orig, digits = 0)
E_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$E_emb_star, digits = 0)
C_dot_md_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 0)
C_dot_md_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_md_star, digits = 0)

# Parameters for second table
q_dot_s_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 2)
f_Cs_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$f_Cs_orig, digits = 3)
k_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$k, digits = 1)

# Parameters for elasticity table
e_qs_ps_UC_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 3)
e_qo_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 3)
e_qs_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Parameters for discussion
Re_dempl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 0)
Re_md_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE, digits = 1)
Re_dsub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
Re_isub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE)
Re_iinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
q_dot_s_orig_car <- rebound_results %>% 
  dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == "Car") %>% 
  magrittr::extract2("q_dot_s_orig")
q_dot_s_hat_car <- rebound_results %>% 
  dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == "Car") %>% 
  magrittr::extract2("q_dot_s_hat")
perc_increase_driving <- (q_dot_s_hat_car / q_dot_s_orig_car - 1) * 100
perc_increase_driving_char <- formatC(perc_increase_driving, digits = 1, format = "f", big.mark = ",")
@

For the first example, 
we consider the purchase of a more fuel efficient car, 
namely a gasoline-electric Ford Fusion Hybrid car,
to replace a conventional gasoline Ford Fusion car. 
The cars are matched as closely as possible, 
except for the inclusion of an electric battery 
in the hybrid car.  
The car case study features a larger initial capital investment ($\orig{C}_{cap} < \amacro{C}_{cap}$)
versus the long-term benefit of decreased energy service costs ($\rorig{C}_s > \ramacro{C}_s$). 

We require three sets of data. 
First, basic car parameters are summarized 
in Table~\ref{tab:car_parameters}.
Second, we require several general economic parameters, 
mainly relating to the U.S.\ economy and personal finances 
of the average U.S.\ citizen, shown in Table~\ref{tab:car_economic_parameters}.
Third, we require elasticity parameters, 
as given in Table~\ref{tab:car_elasticity_parameters}.



% Reduce spacing between table rows henceforth.
\renewcommand{\arraystretch}{0.6}

\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Car example: Vehicle parameters.} 
\label{tab:car_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Ford Fusion & Ford Fusion & Data sources and notes\\ 
    Parameters [units]                              & (gasoline) & (hybrid EV) &  \\
  \midrule
  Fuel economy                           & \Sexpr{mpg_worse} & \Sexpr{mpg_better} & Combined cycle mpg value taken from \citet{Car_Connection:2020}, \\
  $\bempl{\eta}$, $\amacro{\eta}$ [mpg]             &           &          & for Titanium FWD 2020 model with Intercooled I-4, 2.0 L engine.   \\
                                                    &           &          & Combined cycle mpg value taken from \citet{Car_Connection:2020},\\
                                                    &           &          & for Titanium FWD 2020 model with Gas/Electric I-4, 2.0 L engine. \\
  \midrule
   Capital expenditure rate      & \Sexpr{C_dot_cap_orig_car_char}     & \Sexpr{C_dot_cap_star_car_char}    & Seven year annual, averaged capital costs = purchase + finance costs  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & -- resale value (purchase -- depreciation). Ford Fusion gasoline costs from \\
                                                    &           &          & \citet{Edmunds:2020_fusion_gasoline}. \\
                                                    &           &          & Ford Fusion Hybrid car costs from \citet{Edmunds:2020_fusion_hybrid}. \\
 \midrule
   Ownership duration            & \Sexpr{t_own_orig_car_char}  & \Sexpr{t_own_star_car_char}  & U.S.\ car ownership (from new) duration from \citet{BusinessWire:2015}, \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          & and has risen from 52 months (2005) to 79 months (2015), so  \\
                                                    &           &          & taken as 84 months in 2018 (7 years) for our example. \\
 \midrule
   Lifespan                     & \Sexpr{t_life_orig_car_char}  & \Sexpr{t_life_star_car_char} & Lifetime taken as 14 years, based on 13--17 years for U.S.\ cars \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Berla:2016} and 14 years for UK cars from \\
                                                    &           &          & \citet{SMMT:2020}. \\
 \midrule
   Embodied energy             & \Sexpr{E_emb_orig_car_char}    & \Sexpr{E_emb_star_car_char}   & 34,000 MJ for conventional Ford Fusion gasoline car taken from \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & \citet{Argonne_National_Laboratory:2010}. \\
                                                    &           &          & We assume an additional 6,000 MJ added for Ford Fusion \\
                                                    &           &          & Hybrid Electric Vehicle (HEV) battery, as HEV typically adds 10--25\% \\
                                                    &           &          & to total LCA energy of vehicle manufacture \citep{onat2015conventional}. \\
                                                    &           &          & Battery lifetime assumed same as car lifetime, based on \\
                                                    &           &          & \citet{nordelof2014environmental} and \citet{onat2015conventional}. \\
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_car_char}  & \Sexpr{C_dot_md_star_car_char}    & Seven year annual, averaged maintenance costs = sum of insurance, \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & maintenance, repairs, taxes, and fees \\
                                                    &           &          & (excluding financing, depreciation, fuel). \\
                                                    &           &          & Ford Fusion maintenance costs from \citet{Edmunds:2020_fusion_gasoline}. \\
                                                    &           &          & Ford Fusion Hybrid maintenance costs from \citet{Edmunds:2020_fusion_hybrid}. \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Car example: Economic parameters (2020).}
\label{tab:car_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Distance driven prior to upgrade   & \Sexpr{q_dot_s_orig_car_char}        & Average U.S.\ vehicle miles/year, calculated from \citet{Car_Insurance:2019}.  \\
  $\rbempl{q}_s$ [miles/year]                               &               & This is slightly lower than the average driver miles/year (13,476) \\
                                                            &               & \citep{US_DoT:2018}, as there are \\
                                                            &               & more registered U.S.\ vehicles than drivers. \\
  \midrule
  Real median personal income U.S., in 2018                 & 34,317        & Taken from \citet{St_Louis_Fed:2019}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ 2018 disposable income /                            & 0.88319       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  real income (minus current taxes)                         &               & National and Products Accounts (NIPA) \\
  {} [--]                                                   &               & Table 2.1.\ Personal Income and Its Disposition \\
                                                            &               & \citep{US_BEA:2020}. \\ 
  \midrule
  Share of savings from 2018 disposable income              & 0.07848       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  {} [--]                                                   &               & National and Products Accounts (NIPA) \\ 
                                                            &               & Table 2.1.\ Personal Income and Its Disposition \\
                                                            &               & \citep{US_BEA:2020}. \\
  \midrule
  Personal consumption in 2018                  & \Sexpr{M_dot_orig_car_char}      & Calculation: $(\$34,317\mathrm{/year}) (0.88319) (1 - 0.07848)$ \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of gasoline                       & \Sexpr{p_E_orig_car_char}       & Source: \citet{US_EIA:2020_gasoline} \\
  $p_E$ [\$/gallon]                                         &               &  \\
  \midrule  
  Fractional spend on original energy service      & \Sexpr{f_Cs_orig_car_char}      & Calculation: \$1,306 (spend on energy service) \\
  $\fCs$ [--]                                               &               & / [\$19,115 (other goods) + \$1,306 (energy service)] = 0.064, \\
                                                            &               & where spend on energy service = 12,416 miles / 25 mpg \\
                                                            &               & $\times$ \$2.63/gallon = \$1,306. \\
  \midrule
  Macro factor                                              & \Sexpr{k_car_char}           & An initial value. See Section~\ref{sec:calibrating_k} for additional details. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Car example: Elasticity parameters.}
\label{tab:car_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Uncompensated own price elasticity of car use demand  & $\Sexpr{e_qs_ps_UC_car_char}$  & We adopt $-0.2$ as our baseline value, based on U.S.\ studies including \\
  $\eqspsUCorig$ [--]                                           &           &  \citet{Gillingham:2020aa} who estimated a value of $-0.1$, \\
                                                           &           &   \citet{goetzke2018} who estimated values \\
                                                           &          &     between $-0.05$ and $-0.23$, and \citet{Parry2005} \\  
                                                             &           &   who estimated values between $-0.1$ and $-0.3$. \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses values of $-0.1$ to $-0.4$ \\   
                                                            &            &     based on \citet{Parry2005}. \\
  \midrule
  Compensated price elasticity of car use demand                   &   $\Sexpr{e_qs_ps_C_car_char}$   & Calculated via the Slutsky Equation (Eq.~(\ref{PartI-eq:slutsky}) in Part~I).  \\
  $\eqspsCorig$ [--]                                           &                                &   \\    
  \midrule   
  Compensated cross price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_C_car_char}     & Calculated via Eq.~(\ref{PartI-eq:eqops}) in Part~I.  \\
  $\eqopsCorig$ [--]                                           &                                &   \\ 
  \midrule   
  Income elasticity of demand for car use                 &   \Sexpr{e_qs_M_car_char}      & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &                                &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_car_char}      & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &                                &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





%------------------------------
\subsubsection{Data for lamp example} 
\label{sec:data_lamp_example}
%------------------------------

<<LampPrintableNumbers, echo=FALSE>>=
# First table
efficacy_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # lm-hr/W-hr
efficacy_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # lm-hr/W-hr
C_dot_cap_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 3)
C_dot_cap_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_cap_star, digits = 3)
t_own_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_own_orig, digits = 1)
t_own_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_life_orig, digits = 1)
t_life_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
C_dot_md_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 2)
C_dot_md_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_md_star, digits = 2)

# Second table
q_dot_s_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 4)
f_Cs_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$f_Cs_orig, digits = 7)
k_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$k, digits = 1)

# Third table
e_qs_ps_UC_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 4)
e_qo_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 5)
e_qs_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Results discussion
Re_dempl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 2)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
E_dot_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_dot_emb_orig, digits = 2)
E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_dot_emb_star, digits = 2)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Re_md_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE)
Re_dsub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
eta_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # In lm/W
eta_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # In lm/W
q_dot_s_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$q_dot_s_star, digits = 0) # In lm-hr/year
q_dot_s_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$q_dot_s_hat, digits = 0) # In lm-hr/year
Re_isub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE, digits = 2)
Re_iinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Delta_C_dot_o_bar_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_bar, digits = 2)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@


For the second example, 
we consider purchasing a Light Emitting Diode (LED) electric lamp
to replace a baseline incandescent electric lamp. 
Both lamps are matched as closely as possible 
in terms of energy service delivery (measured in lumen output per lamp), 
the key difference being the energy required to provide that energy service. 
The LED lamp has a low 
initial capital investment rate
when spread out over the lifetime of the lamp
(less than the incumbent incandescent lamp, actually)
and a long-term benefit of decreased direct energy expenditures
at the same energy service delivery rate (lm-hr/year).

Again, three sets of data are required. 
First, basic lamp parameters are summarized in Table~\ref{tab:lamp_parameters}. 
Second, several general economic parameters, 
mainly relating to the U.S.\ economy and 
personal finances of the average U.S.\ citizen are 
given in Table~\ref{tab:lamp_economic_parameters}.
Third, we require the elasticity parameters, 
as shown in Table~\ref{tab:lamp_elasticity_parameters}.


\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Lamp example: Electric lamp parameters.} 
\label{tab:lamp_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Incandescent lamp & LED lamp & Data sources and notes\\ 
    Parameters [units]                                &  &  & \\
  \midrule
  Lamp efficacy                   & \Sexpr{efficacy_worse}      & \Sexpr{efficacy_better}     & Incandescent: 530 lm output / 60 W energy input. \\
  $\bempl{\eta}$, $\amacro{\eta}$ [lm-hr/W-hr]       &           &          & LED: 450 lm output / 5.5 W energy input. \\
  \midrule
   Capital expenditure rate       & \Sexpr{C_dot_cap_orig_lamp_char}   & \Sexpr{C_dot_cap_star_lamp_char}    & Purchase costs: \$1.88 for incandescent lamp from  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & \citet{Home_Depot:2020_Inc_bulb}, \\
                                                    &           &          & and \$1.21 for LED lamp from \\
                                                    &           &          & \citet{Home_Depot:2020_LED_bulb}. \\
  \midrule
   Ownership duration      & \Sexpr{t_own_orig_lamp_char}       & \Sexpr{t_own_star_lamp_char}       & Assumed same as lamp lifespan \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          &  \\
 \midrule
   Lifespan               & \Sexpr{t_life_orig_lamp_char}       & \Sexpr{t_life_star_lamp_char}       & Based on assumed 3 hours/day  \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Home_Depot:2020_Inc_bulb} \\
                                                    &           &          & and  \citet{Home_Depot:2020_LED_bulb}. \\
   \midrule
   Life cycle analysis (LCA) embodied energy  & \Sexpr{E_emb_orig_lamp_char}      & \Sexpr{E_emb_star_lamp_char}     & Base document: Table 4.5 Manufacturing Phase Primary  \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & Energy (MJ/20 million lumen-hours), contained in \\
                                                    &           &          & U.S.\ DoE Life-cycle assessment of energy and environmental \\
                                                    &           &          & impacts of LED lighting products \citep{US_DoE:2012}.\\
                                                    &           &          & Incandescent lamp: \\
                                                    &           &          & LCA energy = 42.2 MJ/20 million lumen-hours.  \\
                                                    &           &          & Lifetime output = 530 lumens $\times$ 3 hours/day \\
                                                    &           &          & $\times$ 365 days/year $\times$ 1.8 years = 1,044,630 lumen-hrs.\\
                                                    &           &          & Thus LCA energy / lamp =  42.2 $\times$ 1.0446/20 = 2.21 MJ. \\
                                                    &           &          & LED lamp:  \\
                                                    &           &          & LCA energy = 132 MJ/20 Million lumen-hours \\
                                                    &           &          & for pack of 5 LED lamps. \\
                                                    &           &          & Lifetime output = 450 lumens $\times$ 3 hours/day  \\
                                                    &           &          & $\times$ 365 days/year $\times$ 10 years = 4,926,405 lumen-hrs. \\
                                                    &           &          & Thus LCA energy / lamp =  132 MJ/5 $\times$ 4.9264/20 = 6.5 MJ. \\ 
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_lamp_char}      & \Sexpr{C_dot_md_star_lamp_char}     & Assumed negligible. \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}






\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Lamp example: Economic parameters (2020).}
\label{tab:lamp_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description  & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Lighting consumption prior to upgrade   & \Sexpr{q_dot_s_orig_lamp_char}  & Calculation: (530 lm) (3 hrs/day) (365 days/year). \\
  $\rbempl{q}_s$ [lm-hr/year]                               &               & \\
  \midrule
  Real median personal income U.S.\, in 2018                & 34,317        & Refer to Table~\ref{tab:car_economic_parameters}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ 2018 disposable income /                            & 0.88319       & Refer to Table~\ref{tab:car_economic_parameters}. \\
  real income (minus current taxes)                         &               &  \\
  {} [--]                                                   &               &  \\
  \midrule
  Share of savings from 2018 disposable income              & 0.07848       & Refer to Table~\ref{tab:car_economic_parameters}. \\
  {} [--]                                                   &               &  \\ 
  \midrule
  Personal consumption in 2018                   & \Sexpr{M_dot_orig_lamp_char}     & Calculation: $(\$34,317\mathrm{/year}) (0.88319) (1 - 0.07848)$. \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of electricity                  & \Sexpr{p_E_orig_lamp_char}        & U.S.\ 2018 average U.S.\ household electricity price \\
  $p_E$ [\$/kW-hr]                                          &               & \citep{US_EIA:2020_electricity}.  \\
  \midrule
  Fractional spend on original energy service    & \Sexpr{f_Cs_orig_lamp_char}       & Calculation: \$8.5/year (spend on energy service) / \\
  $\fCs$ [--]                                               &               & [\$27,920/year (other goods) + \$8.5/year (energy service)] = 0.00030, \\
                                                            &               & where spend on energy service = 580,350 lm-hrs/year /  \\
                                                            &               & 8.83 lm/W / 1000 W/kW $\times$ \$0.1287/kW-hr = \$8.5/year.  \\
                                                            &               & Note: this is energy service from a single lamp. \\
  \midrule
  Macro factor                                              & \Sexpr{k_lamp_char}           & An initial value. See Section~\ref{sec:calibrating_k} for additional details. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




\begin{landscape}
\begin{table}
\footnotesize
\begin{center}
\caption{Lamp example: Elasticity parameters.}
\label{tab:lamp_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Uncompensated own price elasticity of lighting demand  &   $\Sexpr{e_qs_ps_UC_lamp_char}$  & We adopt $-0.4$ as our baseline value, as the average of last 50 years \\
  $\eqspsUCorig$ [--]                                                             &           &   from \citet[Fig.~4]{Fouquet2014}. \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses a range of $-0.4$ to $-0.8$, \\   
                                                            &            &     based on \citet{Fouquet2011}. \\
  \midrule
  Compensated own price elasticity of lighting demand                 &  $\Sexpr{e_qs_ps_lamp_C_char}$      & Calculated via the Slutsky Equation (Eq.~(\ref{PartI-eq:slutsky}) in Part~I).  \\
  $\eqspsCorig$ [--]                                           &           &   \\    
  \midrule   
  Compensated cross price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_lamp_C_char}     & Calculated via Eq.~(\ref{PartI-eq:eqops}) in Part~I.  \\
  $\eqopsCorig$ [--]                                           &           &   \\ 
  \midrule   
  Income elasticity of lighting demand                &   \Sexpr{e_qs_M_lamp_char}     & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &           &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_lamp_char}     & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &           &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}



%++++++++++++++++++++++++++++++
\subsection{Visualization}
\label{sec:path_graphs}
%++++++++++++++++++++++++++++++

A comprehensive rebound analysis should track
energy, expenditure, and consumption
aspects of rebound 
at the device (direct rebound) and elsewhere in the economy (indirect rebound)
across all adjustments for all rebound effects
(emplacement, substitution, income, and macro). 
Doing so involves many terms and much complexity.
To date, visualizing the energy, expenditure, and consumption 
aspects of rebound phenomena has not been 
done in a set of mutually consistent graphs.

We introduce rebound planes
to bring clarity to
(direct and indirect) rebound and 
adjustments (via emplacement, substitution, income, and macro effects)
across all aspects (energy, expenditure, and consumption).
Each aspect is represented by a path in its own plane,
showing adjustments in response to the EEU.

Axes of the rebound planes
represent direct and indirect rebound, with 
direct rebound shown on the $x$-axis, and 
indirect rebound shown on the $y$-axis.
Specifically, 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item direct and indirect energy consumption rates ($\rate{E}_{dir}$, $\rate{E}_{indir}$) are placed on
        the $x$- and $y$-axes of the energy plane, respectively;
  
  \item direct and indirect expenditure rates ($\rate{C}_{dir}$ and $\rate{C}_{indir}$) are placed on 
        the $x$- and $y$-axes of the expenditure plane, respectively; and
  
  \item the indexed consumption rate of the energy service ($\rate{q}_s$) and
        the indexed expenditure rate of other consumption goods ($\rate{C}_o$) are placed on
        the $x$- and $y$-axes of the consumption plane, respectively.
    
\end{enumerate*}
%
Paths through energy, expenditure, and consumption planes
consist of segments that represent changes due to the various rebound effects.
Table~\ref{tab:path_graph_segments} provides the key for rebound path segments.
Effects that include both direct and indirect rebound
will show displacement along both axes and 
create a path in the $x$-$y$ plane.
(See Appendix~\ref{sec:graph_details} for 
detailed mathematical descriptions for constructing paths on the rebound planes.)

Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph} show
notional energy, expenditure, and consumption planes,
respectively.
The notional planes are not quantified, i.e.\ there are no scales on the axes.
Later (Section~\ref{sec:results}), 
rebound planes with numerical scales illustrate the car and lamp examples.

\begin{table}
\centering % Centered table
\caption{Segments in rebound planes.} 
\begin{tabular}{r l l c}
  \toprule
  \multicolumn{1}{c}{Segment} & Rebound effect            & Symbol           \\
  \midrule
  \circa{} \hspace{52.0mm}    & Direct emplacement        & $Re_{dempl}$     \\
  \ab{}    \hspace{45.0mm}    & Embodied energy           & $Re_{emb}$       \\
  \bstar{} \hspace{37.8mm}    & Maintenance and disposal  & $Re_{\md}$       \\
  \midrule
  \starc{} \hspace{30.9mm}    & Indirect substitution     & $Re_{isub}$      \\ 
  \chat{}  \hspace{23.2mm}    & Direct substitution       & $Re_{dsub}$      \\ 
  \midrule
  \hatd{}  \hspace{16.0mm}    & Direct income             & $Re_{dinc}$      \\ 
  \dbar{}  \hspace{ 7.7mm}    & Indirect income           & $Re_{iinc}$      \\ 
  \midrule
  \bartilde{}                 & Macro                     & $Re_{macro}$     \\
  \bottomrule
\end{tabular}
\label{tab:path_graph_segments}
\end{table}


%------------------------------
\subsubsection{The energy plane}
\label{sec:energy_path_graphs}
%------------------------------

Fig.~\ref{fig:ExampleEnergyPathGraph} shows a notional energy plane, with 
the direct energy consumption rate ($\rate{E}_{dir}$) on the $x$-axis
and
the indirect energy consumption rate ($\rate{E}_{indir}$) on the $y$-axis.%
\footnote{
  A related, notional-only (not quantified as in Section~\ref{sec:results}), 
  one-dimensional visualization of direct and indirect energy rebound 
  (but not on expenditure or consumption planes)
  can be found in Fig.~1 of \cite{Exadaktylos:2021aa}.}
%
Points $\circ$, $*$, $\wedge$, $-$, and $\sim$ represent the rebound stages
between the rebound effects.
Points $a$, $b$, $c$, and $d$ represent intermediate stages.
Lines with negative slope through points 
$\circ$, $a$, $*$, $\wedge$, $-$, and $\sim$
indicate energy consumption isoquants
at key points.
Table~\ref{tab:path_graph_segments} shows 
segments and rebound effects for all rebound planes.
Note that segment \bartilde{} appears only in the energy plane, 
because the framework tracks energy consumption but not expenditures or consumption
for the macro effect.

<<ExampleEnergyPathGraph, echo=FALSE, warning=FALSE, fig.cap="Notional energy plane. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
stage_size <- 10
orig_size <- stage_size
star_size <- stage_size
hat_size <- stage_size - 3
bar_size <- stage_size - 5
tilde_size <- stage_size - 5

stage_colour <- "black"
abcd_size <- 4
abcd_colour <- "darkgray"

annotation_angle <- -45.6
annotation_size <- 4
annotation_colour <- "black"

example_arrow_angle <- 19.0 * pi/180
example_arrow_size <- 0.5 # width

example_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                         1.01, 1.008, 'degree', 
                                           stage_colour, orig_size, 0,
                                         0.11, 1.008, 'a', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.973, 'b', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.95, '"*"', 
                                           stage_colour, star_size, 0,
                                         0.09, 0.935, 'c', 
                                           abcd_colour, abcd_size, 0,
                                         0.2432, 0.923, '"^"', 
                                           stage_colour, hat_size, 0,
                                         0.2727, 0.932, 'd', 
                                           abcd_colour, abcd_size, 0,
                                         0.295, 1.033, 'bold("_")', 
                                           stage_colour, bar_size, 0,
                                         0.29, 1.126, '"~"', 
                                           stage_colour, tilde_size, 0,
                                         0.04, 0.923, 'Hyperconservation', 
                                           annotation_colour, 
                                           annotation_size-1,
                                           annotation_angle,
                                         0.02, 1.043, 'Re[tot] == 0*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.033, 1.004, 'Re[empl]', 
                                           annotation_colour,  
                                           annotation_size - 1, 
                                           annotation_angle + 90,
                                         0.21, 0.90, 'Re[sub]', 
                                           annotation_colour, 
                                           annotation_size - 1,
                                           annotation_angle + 90,
                                         0.39, 0.936, 'Re[inc]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.68, 0.935, 'Re[macro]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.754, 1.1, 'Re[tot] == 100*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.95, 1.1, 'Backfire', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle)
example_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                     # Re_empl arrow
                                     0.078, 1.01, example_arrow_angle, 
                                       -0.063, annotation_colour, example_arrow_size,
                                     # Re_sub arrow
                                     0.249, 0.904, example_arrow_angle, 
                                       0.042, annotation_colour, example_arrow_size,
                                     # Re_inc arrow
                                     0.329, 0.905, example_arrow_angle, 
                                       0.154, annotation_colour, example_arrow_size,
                                     # Re_macro arrow
                                     0.622, 0.904, example_arrow_angle, 
                                       0.14, annotation_colour, example_arrow_size) 
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Energy", 
                               indexed = TRUE) + 
  ggplot2::xlim(0, 1.1) +
  ggplot2::ylim(0.9, 1.15) +
  ggplot2::xlab(expression(dot(E)[dir] * " [MJ/year]")) +
  ggplot2::ylab(expression(dot(E)[indir] * " [MJ/year]")) +
  ggplot2::geom_spoke(data = example_Re_arrows,
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle,
                                               radius = radius,
                                               colour = colour),
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = example_energy_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@

In the notional energy plane of Fig.~\ref{fig:ExampleEnergyPathGraph}, 
point $a$ lies on the $Re_{tot} = 0\%$ line
indicating that point $a$ (and the $Re_{tot} = 0\%$ line)
is the point from which all rebound effects 
($Re_{empl}$, $Re_{sub}$, $Re_{inc}$, and $Re_{\macro}$)
are measured.
If rebound effects cause 
total energy demand to return to the original energy consumption level 
(negative sloping line through the $\circ$ point), 
all expected energy savings are taken back by rebound effects. 
Thus, the line of constant energy consumption through the $\circ$ point is labeled
$Re_{tot} = 100\%$.
The contribution of each rebound effect to total rebound 
is represented by the distance that each component's segment
moves across the rebound isoquants.  
Total rebound ($Re_{tot}$) is measured linearly between and beyond the
$Re_{tot} = 0\%$ and $Re_{tot} = 100\%$ lines, 
with direct rebound in the $x$ direction and 
indirect rebound in the $y$ direction.
The region below and to the left of the $Re_{tot} = 0\%$ line
in Fig.~\ref{fig:ExampleEnergyPathGraph}
exhibits negative rebound, indicating hyperconservation.
The region above and to the right of the $Re_{tot} = 100\%$ line 
shows backfire, 
i.e.\ greater total energy consumption after the EEU than before it. 

In the notional energy plane (Fig.~\ref{fig:ExampleEnergyPathGraph}), 
emplacement rebound is negative ($Re_{empl} < 0$),
because the upgraded device has a lesser
embodied energy rate ($\rbempl{E}_{emb} > \raempl{E}_{emb}$,
as shown by point \emph{b} being below point \emph{a})
and has a lesser energy consumption rate for maintenance and disposal 
($\rbempl{E}_{\md} > \raempl{E}_{\md}$, 
as shown by point $*$ being below point \emph{b})
due to lower expenditure rates on these two categories
compared to the original device.

In Fig.~\ref{fig:ExampleCostPathGraph} segments \ab{} and \bstar{}
move in the negative $y$ direction,
consistent with the description above.
Segment \starc{} is negative by definition of the indirect substitution effect 
and segment \chat{} is positive by the same definition. 
Both income effect segments (\hatd{} and \dbar{}) will always
lead to more energy consumption, because net savings are spent
on goods and services that rely on at least some energy consumption.
Segment \bartilde{} always moves in the positive $y$ direction,
because macro effects lead to additional indirect energy consumption.


%------------------------------
\subsubsection{The expenditure plane}
\label{sec:expenditure_path_graphs}
%------------------------------

A notional expenditure plane is shown in Fig.~\ref{fig:ExampleCostPathGraph}, 
with 
the direct expenditure rate on the energy service ($\rate{C}_{dir}$) on the $x$-axis and 
the indirect expenditure rate ($\rate{C}_{indir}$) on the $y$-axis.
Lines with negative slope through points $\circ$, $a$, $*$, and $\wedge$
indicate expenditure isoquants.
The line through the $\circ$ point is an isoquant for the
cost of purchasing the original consumption bundle
at the original prices.
The line through the $*$ point is an isoquant for the
cost of purchasing the original consumption bundle
at the new prices.


<<ExampleCostPathGraph, echo=FALSE, fig.cap="Notional expenditure plane. CV is compensating variation, the increase in consumption of the energy service and decrease in consumption of other goods and services to maintain constant utility. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
cost_line_angle <- -14
example_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                       1.01, 1.003, 'degree', 
                                       stage_colour, orig_size, 0,
                                       0.098, 1.003, 'a', 
                                       abcd_colour, abcd_size, 0,
                                       0.09, 0.972, 'b', 
                                       abcd_colour, abcd_size, 0,
                                       0.128, 0.955, '"*"', 
                                       stage_colour, star_size, 0,
                                       0.09, 0.936, 'c', 
                                       abcd_colour, abcd_size, 0,
                                       0.24, 0.9385, '"^"', 
                                       stage_colour, hat_size, 0,
                                       0.283, 0.937, 'd', 
                                       abcd_colour, abcd_size, 0,
                                       0.285, 1.034, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                       0.635, 1.019, 'Original~expenditure', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.43, 0.9445, 'After~emplacement', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.55, 0.9835, 'After~expected~savings', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.17, 0.9425, 'After~CV', 
                                       annotation_colour, annotation_size-1, cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Expenditure", 
                               indexed = TRUE) + 
  # ggplot2::xlim(0, 1.1) +
  # ggplot2::ylim(0.9995, 1.0005) +
  ggplot2::xlab(expression(dot(C)[dir] * " [$/year]")) +
  ggplot2::ylab(expression(dot(C)[indir] * " [$/year]")) +
  
  ggplot2::geom_text(data = example_cost_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@

In the notional planes of
Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}, 
embodied energy rates and capital cost rates
(represented by segments \ab{} and \bstar{}) 
move in the same direction (both in the negative $y$ direction).
However, segments \ab{} and \bstar{} 
could both move in the positive $y$ direction, or
they could move in opposite directions, 
depending on the results of the independent analyses for 
embodied energy and capital cost rates.
The substitution effect along segments \starc{} and \chat{}
will, by definition, lead to a lower expenditure 
due to the price decline and hence the budget reducing compensating variation (CV). 
The income effect (segments \hatd{} and \dbar{}) must bring expenditure
back to the original expenditure line 
(equal to the budget constraint set by income in dollar or nominal terms) 
by assumptions about non-satiation and utility maximization 
in the device owner's decision function.


%------------------------------
\subsubsection{The consumption plane}
\label{sec:consumption_path_graphs}
%------------------------------

A notional consumption plane is shown in Fig.~\ref{fig:ExampleConsPathGraph}.
The indexed rate of energy service consumption ($\rate{q}_s/\rbempl{q}_s$) is shown on the $x$-axis, and
the indexed rate of other goods consumption ($\rate{C}_o/\rbempl{C}_o$) is shown on the $y$-axis.
Iso-consumption loci of indexed energy service and other goods demand
are shown as lines with negative slope
(lines \circcirc{}, \starstar{}, \hathat{}, and \barbar{}). 
Note that isoquants \circcirc{} and \barbar{} 
intersect at the $y$-axis,
because the prices of other goods and services don't change
as a result of the EEU.
(The $x$-axis of Fig.~\ref{fig:ExampleConsPathGraph} does not extend to $0$ at the left, 
so the intersection is not visible.)
Emplacement does not alter consumption patterns, so
the rate of energy service consumption and 
the rate of other goods consumption are
unchanged across the emplacement effect
($\rbempl{q}_s = \raempl{q}_s$ and $\rbempl{C}_o = \raempl{C}_o$, respectively).
Thus, 
only movements after the $*$ point are visible as a path in the consumption plane, and
points $\circ$, \emph{a}, \emph{b}, and $*$ 
collapse to the same location in the consumption plane.

Indifference curves are denoted by \iicirc{} and \iibar{}
and represent lines of constant utility through the $\circ$ and $-$ points. 
Prior to the EEU, the consumption basket (of the energy service and other goods)
is represented by the $\circ$ point. 
The budget constraint,
here in real terms, i.e.,
the capacity to purchase either the energy service or other goods and services,
is shown as isoquant \circcirc{}.
The \circcirc{} line is tangent to the lower indifference curve 
(\iicirc{}) at point $\circ$, the optimal consumption
bundle prior to the EEU.
The real budget line \starstar{}
indicates the (higher) capacity to purchase 
combinations of energy services and other goods and services
using the same money needed to purchase
the old consumption bundle but at the new, lower price
for the energy service,
thanks to the EEU.

The substitution effect leads to the cheaper, optimal
consumption bundle at the $\wedge$ point. 
The substitution effect is shown by segments
\starc{} (the indirect component, which represents the decrease in other goods consumption) and
\chat{} (the direct component, which represents the increase in energy service consumption).
Although the substitution effect is calculated 
on the consumption plane, 
its impact 
can be seen in
the energy and expenditures planes 
(Figs.~\ref{fig:ExampleEnergyPathGraph}
and~\ref{fig:ExampleCostPathGraph}, respectively).

The income expansion path is a ray (\rr{}) from the origin through the $\wedge$ point
in the consumption plane.
In the consumption plane, the pre- and post-income-effect 
points ($\wedge$ and $-$, respectively)
lie along the \rr{} ray, due to homotheticity.
The increased consumption rate of the energy service is 
represented by segment \hatd{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.
The increased consumption rate of other goods and services is 
represented by segments \dbar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.


<<ExampleConsPathGraph, echo=FALSE, warning=FALSE, fig.cap="Notional consumption plane. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
orig_line_label_size <- orig_size - 3
star_line_label_size <- star_size - 4
hat_line_label_size <- hat_size - 3
bar_line_label_size <- bar_size - 1
r_line_label_size <- abcd_size
i_line_label_size <- abcd_size
line_label_colour <- "darkgray"
  
labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                          1.05, 1.005, 'degree', 
                            annotation_colour, orig_size,
                          1.09, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.14, 1.0052, 'a', 
                            abcd_colour, abcd_size,
                          1.18, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.22, 1.006, 'b', 
                            abcd_colour, abcd_size,
                          1.258, 1.0022, '","', 
                            annotation_colour, orig_size-3,
                          1.315, 1.001, '"*"', 
                            annotation_colour, star_size,
                          0.7, 1.01, 'degree', 
                            line_label_colour, orig_line_label_size,
                          1.56, 0.97, 'degree',
                            line_label_colour, orig_line_label_size,
                          0.7, 0.995, '"*"', 
                            line_label_colour, star_line_label_size,
                          3.5, 0.981, '"*"', 
                            line_label_colour, star_line_label_size,
                          0.96, 0.98, 'c', 
                            abcd_colour, abcd_size,
                          2.2, 0.9834, '"^"',  
                            annotation_colour, hat_size,
                          0.7, 0.989, '"^"',
                            line_label_colour, hat_line_label_size,
                          3.5, 0.975, '"^"', 
                            line_label_colour, hat_line_label_size,
                          2.52, 0.984, 'd', 
                            abcd_colour, abcd_size,
                          2.43, 1.085, 'bold("_")',  
                            annotation_colour, bar_size,
                          0.7, 1.0873, '"_"',
                            line_label_colour, bar_line_label_size,
                          3.5, 1.073, '"_"',
                            line_label_colour, bar_line_label_size,
                          2.18, 0.97, 'r',
                            line_label_colour, r_line_label_size,
                          2.6, 1.15, 'r',  
                            line_label_colour, r_line_label_size,
                          0.75, 1.027, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          3.4, 0.981, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          0.75, 1.143, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          3.4, 1.084, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Consumption") + 
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.97, 1.15) +
  ggplot2::geom_text(data = labels, 
                     mapping = ggplot2::aes(x = x, y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@



%++++++++++++++++++++++++++++++
\subsection{Software tools}
\label{sec:software_tools}
%++++++++++++++++++++++++++++++

We developed an open source \texttt{R} package called \texttt{ReboundTools}
to standardize and distribute the methods for calculating rebound magnitudes in our framework.
\texttt{ReboundTools} can be found at \url{https://github.com/MatthewHeun/ReboundTools}.
(See \citet{Heun:2021us}.)
\texttt{ReboundTools} provides functions for 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item reading input data from a spreadsheet,

  \item performing rebound calculations, and 
  
  \item generating rebound tables and rebound planes.
    
\end{enumerate*}
%
\texttt{ReboundTools} was used for 
all calculations and all rebound planes in this paper.

To find the path in storage to an example spreadsheet bundled with the package, 
users of \texttt{ReboundTools}
can call the function \texttt{ReboundTools::sample\_eeu\_data\_path()}.
After filling the example spreadsheet with parameters for an EEU, 
users can call two functions
(\texttt{ReboundTools::load\_eeu\_data()} and \texttt{ReboundTools::rebound\_analysis()})
to perform all rebound calculations described in this paper.
The function \texttt{ReboundTools::path\_graphs()} creates 
rebound paths in the energy, expenditure, and consumption planes.
Extensive documentation for \texttt{ReboundTools}
can be found at \url{https://matthewheun.github.io/ReboundTools/}.

In addition, a separate Excel workbook that performs identical rebound calculations 
using the framework of this paper
can be found at the data repository for this paper at
\url{https://doi.org/10.5518/1201}.
(See \citet{Brockway:2022aa}.)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}
\label{sec:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%++++++++++++++++++++++++++++++
\subsection{Case 1: Purchase of a new car}
\label{sec:car_example}
%++++++++++++++++++++++++++++++

Armed with the parameter values from 
Tables~\ref{tab:car_parameters}--\ref{tab:car_elasticity_parameters}, 
and the equations in Section~\ref{PartI-sec:framework} of Part~I,
we calculate important values at each rebound stage,
as shown in Table~\ref{tab:car_stages_table}.
Note that Table~\ref{tab:car_stages_table} applies to the car owner.
Across the macro effect (segment \bartilde{} in Fig.~\ref{fig:CarEnergyGraph}), 
changes occur only in the macroeconomy.
For the car owner, no changes are recorded across the macro effect.
Thus, the $-$ (bar) and $\sim$ (tilde) columns
of Table~\ref{tab:car_stages_table} are identical.

<<car_stages_table, results="asis", echo=FALSE>>=
digs_car <- matrix(c(rep(1, 7), # eta_engr_units
                     rep(3, 7), # eta
                     rep(3, 7), # p_s
                     rep(0, 7), # q_dot_s
                     rep(0, 7), # E_dot_s
                     rep(0, 7), # E_dot_emb
                     rep(0, 7), # C_dot_s
                     rep(0, 7), # C_dot_cap
                     rep(0, 7), # C_dot_md
                     rep(0, 7), # C_dot_o
                     rep(0, 7), # N_dot
                     rep(0, 7)), # M_dot
                   nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:car_stages_table", 
                             caption = "Results for car example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_car, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


Results are represented graphically on energy, expenditure, and consumption planes
in Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:CarConsGraph}.
The energy plane (Fig.~\ref{fig:CarEnergyGraph})
shows the size of each rebound effect
for the car example.
Rebound components for the car upgrade are shown in Table~\ref{tab:car_results}.


<<CarGraphReResults, include=FALSE>>=
Re_empl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<CarEnergyGraph, echo=FALSE, fig.cap="The energy plane for the car example. Macro factor ($k$) is assumed to be 1. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
car_Re_label_angle <- -77
car_Re_arrow_angle <- pi/180 * 3.1

car_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                     63500, 73270, 'degree', 
                                       stage_colour, orig_size, 0,
                                     36900, 73150, 'a', 
                                       abcd_colour, abcd_size, 0,
                                     37520, 73750, 'b', 
                                       abcd_colour, abcd_size, 0,
                                     38200, 73400, '"*"', 
                                       stage_colour, star_size, 0,
                                     36900, 73300, 'c',
                                       abcd_colour, abcd_size, 0,
                                     40650, 73360, '"^"', 
                                       stage_colour, hat_size, 0,
                                     42000, 73370, 'd', 
                                       abcd_colour, abcd_size, 0,
                                     42200, 75300, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                     42200, 77200, '"~"', 
                                       stage_colour, tilde_size, 0,
                                     34800, 73800, 'Hyperconservation', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle,
                                     35150, 74760, 'Re[tot] == 0*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     36830, 74800, paste0("Re[empl] == '", Re_empl_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     36000, 76150, 'Re[sub]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     36300, 75950, paste0("'", Re_sub_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     38800, 76300, 'Re[inc]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     39000, 76090, paste0("'", Re_inc_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     43650, 74050, 'Re[macro]', 
                                       annotation_colour, 
                                       annotation_size - 2,
                                       car_Re_label_angle + 90,
                                     43890, 73900, paste0("'", Re_macro_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     44500, 75000, paste0("Re[tot] == '", Re_tot_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     59600, 75700, 'Re[tot] == 100*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     62000, 76600, 'Backfire', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle)

car_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                 34730, 76250, car_Re_arrow_angle, 2250, annotation_colour, 0.5, # Re_sub
                                 37150, 76383, car_Re_arrow_angle, 2900, annotation_colour, 0.5, # Re_inc
                                 42650, 74100, car_Re_arrow_angle, 1800, annotation_colour, 0.5) # Re_macro

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Energy") +
  ggplot2::geom_spoke(data = car_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = car_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  # Set the limits manually, because we plot beyond these limits
  # with shading.
  ggplot2::xlim(34730, 63500) +
  ggplot2::ylim(73150, 77255) +
  MKHthemes::xy_theme()
@


<<CarCostGraph, echo=FALSE, fig.cap="The expenditure plane for the car example. CV is compensating variation, the increase in consumption of the energy service and decrease in consumption of other goods and services to maintain constant utility. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
car_cost_line_angle <- -33
car_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                   1295, 26600, 'degree', 
                                   stage_colour, orig_size, 0,
                                   777, 26640, 'a', 
                                   abcd_colour, abcd_size, 0,
                                   767, 26576, 'b', 
                                   abcd_colour, abcd_size, 0,
                                   791, 26530, '"*"', 
                                   stage_colour, star_size, 0,
                                   766, 26475, 'c', 
                                   abcd_colour, abcd_size, 0,
                                   835, 26435, '"^"', 
                                   stage_colour, hat_size, 0,
                                   873, 26480, 'd', 
                                   abcd_colour, abcd_size, 0,
                                   845, 27070, 'bold("_")', 
                                   stage_colour, bar_size, 0,
                                   1075, 26885, 'Original~expenditure', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   930, 26495, 'After~exp.~sav.', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   720, 26620, 'After~empl.', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle,
                                   705, 26580, 'After~CV', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Expenditure") + 
  ggplot2::geom_text(data = car_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  ggplot2::scale_x_continuous(limits = c(700, NA)) +
  MKHthemes::xy_theme()
@


<<CarConsGraph, echo=FALSE, warning=FALSE, fig.cap="The consumption plane for the car example. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
car_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                    1.005, 1.0016, 'degree', 
                                      stage_colour, orig_size, 
                                    1.012, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.02, 1.0016, 'a',
                                      abcd_colour, abcd_size,
                                    1.0258, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.034, 1.0017, 'b',
                                      abcd_colour, abcd_size,
                                    1.041, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.05, 1.0002, '"*"', 
                                      annotation_colour, star_size,
                                    1.071, 0.998, '"^"',  
                                      stage_colour, hat_size, 
                                    1.118, 1.0283, 'bold("_")',  
                                      stage_colour, bar_size, 
                                    0.9, 1.008, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    1.165, 0.99, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    0.9, 1.0042, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    1.258, 0.9895, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    0.995, 0.9958, 'c',
                                      abcd_colour, abcd_size,
                                    0.9, 1.0017, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.22, 0.9888, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.115, 0.9965, 'd', 
                                      abcd_colour, abcd_size,
                                    0.9, 1.037, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.275, 1.0215, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.125, 1.037, 'r', 
                                      line_label_colour, r_line_label_size,
                                    1.075, 0.992, 'r', 
                                      line_label_colour, r_line_label_size,
                                    0.91, 1.0109, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.27, 0.9933, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    0.97, 1.0385, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    1.275, 1.025, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    )

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Consumption") + 
  ggplot2::geom_text(data = car_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.9, 1.3) + 
  ggplot2::ylim(NA, 1.04) +
  MKHthemes::xy_theme()
@



<<car_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:car_results", 
                                      caption = "Car example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","), 
        math.style.negative = TRUE)
@


The \empleffect{} has three components:
the direct emplacement effect, 
the embodied energy effect, and 
the maintenance and disposal effect.
Rebound from the direct emplacement effect 
($Re_{dempl}$) is \Sexpr{Re_dempl_car_char_perc}\% always, 
because energy takeback (and, therefore, rebound)
occurs after the EEU is emplaced.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is \Sexpr{Re_emb_car_char_perc}\%,  
due to the higher embodied energy rate
($\Delta \raempl{E}_{emb} = \Sexpr{Delta_E_dot_emb_star_car_char}$~MJ/year)
stemming from the electric battery in the hybrid EV car.
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is small and negative
($\Sexpr{Re_md_car_char_perc}$\%),
because of the slightly lower maintenance and disposal costs
for the hybrid EV car.

The \subeffect{} has two components:
direct and indirect substitution effect rebound.
Rebound from direct substitution ($Re_{dsub}$) is 
positive, as expected (\Sexpr{Re_dsub_car_char_perc}\%). 
The car owner will, on average, prefer more driving purely 
from the change in relative prices because of the fuel economy enhancements
(\Sexpr{mpg_better}~mpg $>$ \Sexpr{mpg_worse}~mpg).
In other words, 
due the relative price change,
the more fuel-efficient car is driven \Sexpr{perc_increase_driving_char}\% further
each year. 
Conversely, the indirect substitution effect ($Re_{isub}$)
is slightly negative ($\Sexpr{Re_isub_car_char_perc}$\%)
to achieve the same level of utility after increased driving. 
Indeed, less money is spent on other goods
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_car_char}$~\$/year).

The \inceffect{} also has two components:
direct and indirect income effect rebound.
The direct income effect
($Re_{dinc}$) is positive
(\Sexpr{Re_dinc_car_char_perc}\%), 
because the car owner allocates some
net savings to additional driving. 
Rebound from the indirect income effect 
($Re_{iinc}$) is positive (\Sexpr{Re_iinc_car_char_perc}\%)
due to higher spending on other goods. 
Thus, the net savings after the substitution effect
($\rasub{N} = \Sexpr{N_dot_hat_car_char}$~\$/year) 
translates into positive direct and indirect income
rebound at the microeconomic level. 
Total microeconomic rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_car_char_perc}$\%.

Finally, we note that 
the link between macroeconomic and microeconomic rebound 
is largely unexplored, and 
we assume a value of $k = 1$ for both examples, initially.
We return to the matter of calibrating $k$
in the Discussion (Section~\ref{sec:calibrating_k}).

With $k$ assumed to be 1
the \macroeffect{} leads to macroeconomic rebound
($Re_{\macro}$) of \Sexpr{Re_macro_car_char_perc}\%,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (transportation).


%++++++++++++++++++++++++++++++
\subsection{Case 2: Purchase of a new electric lamp}
\label{sec:lamp_example}
%++++++++++++++++++++++++++++++

With the parameter values from 
Tables~\ref{tab:lamp_parameters}--\ref{tab:lamp_elasticity_parameters} 
and the equations in Section~\ref{PartI-sec:framework} of Part~I in hand,
we calculate important values at each rebound stage,
as shown in Table~\ref{tab:lamp_stages_table}.
Similar to Table~\ref{tab:car_stages_table}, 
Table~\ref{tab:lamp_stages_table} applies to the lamp owner, 
so no changes are recorded across the macro effect, and
the $-$ (bar) and $\sim$ (tilde) columns
of Table~\ref{tab:lamp_stages_table} are identical.

<<lamp_stages_table, results="asis", echo=FALSE>>=
digs_lamp <- matrix(c(rep(0, 7), # eta_engr_units
                      rep(0, 7), # eta
                      rep(8, 7), # p_s
                      rep(0, 7), # q_dot_s
                      rep(1, 7), # E_dot_s
                      rep(3, 7), # E_dot_emb
                      rep(2, 7), # C_dot_s
                      rep(2, 7), # C_dot_cap
                      rep(2, 7), # C_dot_md
                      rep(0, 7), # C_dot_o
                      rep(2, 7), # N_dot
                      rep(0, 7)), # M_dot
                    nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:lamp_stages_table", 
                             caption = "Results for lamp example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_lamp, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


<<LampGraphReResults, include=FALSE>>=
Re_empl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@


Results are represented graphically on energy, expenditure, and consumption planes
in Figs.~\ref{fig:LampEnergyGraph}--\ref{fig:LampConsGraph}.
The energy plane (Fig.~\ref{fig:LampEnergyGraph})
shows the size of each rebound effect
for the lamp example.
Rebound components for the lamp upgrade are shown in Table~\ref{tab:lamp_results}.

The \empleffect{} rebound components start with
the direct emplacement effect ($Re_{dempl}$),
which is always $\Sexpr{Re_dempl_lamp_char_perc}$\%.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is $\Sexpr{Re_emb_lamp_char_perc}$\%.
Although the LED lamp has higher embodied energy 
($\aempl{E}_{emb} = \Sexpr{E_emb_star_lamp_char}$~MJ)
than the incandescent lamp 
($\bempl{E}_{emb} = \Sexpr{E_emb_orig_lamp_char}$~MJ),
the LED lamp has a much longer lifetime,
meaning that the LED embodied energy \emph{rate}
($\raempl{E}_{emb} = \Sexpr{E_dot_emb_star_lamp_char}$~MJ/year)
is less than the incandescent embodied energy rate
($\rbempl{E}_{emb} = \Sexpr{E_dot_emb_orig_lamp_char}$~MJ/year).
Thus, the change in embodied energy rate ($\Delta \raempl{E}_{emb}$)
is $\Sexpr{Delta_E_dot_emb_star_lamp_char}$~MJ/year, 
and embodied energy rebound is negative
($Re_{emb} = \Sexpr{Re_emb_lamp_char_perc}$\%).
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is \Sexpr{Re_md_lamp_char_perc}\%,
because we assume no difference in maintenance and disposal costs between 
the incandescent lamp and the LED lamp.%
\footnote{
  Maintenance cost rates for both incandescent and LED lamps are likely to be equal 
  and negligible;
  lamps are usually installed and forgotten.
  Real-world disposal cost differences between the incandescent and LED technologies
  are also likely to be negligible. 
  However, if ``disposal'' includes recycling processes, 
  cost rates may be different between the two technologies
  due to the wide variety of materials in LED lamps compared to incandescent lamps.
}

Direct \subeffect{} rebound 
($Re_{dsub}$) is \Sexpr{Re_dsub_lamp_char_perc}\%
due to the much higher LED lamp efficacy
($\amacro{\eta} = \Sexpr{eta_better}$~lm/W) 
compared to the incandescent lamp
($\bempl{\eta} = \Sexpr{eta_worse}$~lm/W),
leading to increased demand for lighting
(from $\rbsub{q}_s = \Sexpr{q_dot_s_star_lamp_char}$~lm-hr/year
to $\rasub{q}_s = \Sexpr{q_dot_s_hat_lamp_char}$~lm-hr/year)
as shown by segment \chat{} in Fig.~\ref{fig:LampConsGraph}.
To maintain constant utility, 
consumption of other goods is reduced
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_lamp_char}$~\$/year), 
as shown by segment \starc{} in Fig.~\ref{fig:LampConsGraph},
yielding indirect substitution effect rebound
($Re_{isub}$) of $\Sexpr{Re_isub_lamp_char_perc}$\%.

\Inceffect{} rebound arises from spending net energy cost savings
associated with converting from the incandescent lamp to the LED lamp
($\rbinc{N} = \Sexpr{N_dot_hat_lamp_char}$~\$/year).
Direct income effect rebound 
($Re_{dinc}$) is \Sexpr{Re_dinc_lamp_char_perc}\%,
positive but small, 
as the lamp owner allocates
some of the net savings to increased demand for lighting.
The indirect income effect rebound is large
($Re_{iinc} = \Sexpr{Re_iinc_lamp_char_perc}$\%),
due to the energy implications of increased spending on other goods.
Total microeconomic level rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_lamp_char_perc}$\%.

Finally, \macroeffect{} rebound
($Re_{\macro}$) is \Sexpr{Re_macro_lamp_char_perc}\%
with $k$ assumed to be 1,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (lighting).
Univariate sensitivity studies for both examples (car and lamp)
can be found in Appendix~\ref{sec:sensitivity_analyses}.


<<LampEnergyGraph, echo = FALSE, warning=FALSE, fig.cap="The energy plane for the lamp example. Macro factor ($k$) is assumed to be 1. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
lamp_Re_label_angle <- -65
lamp_Re_arrow_angle <- pi/180 * 13
lamp_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                      240, 90411, 'degree', 
                                        stage_colour, orig_size, 0,
                                      27, 90411.5, 'a', 
                                        abcd_colour, abcd_size, 0,
                                      14, 90408.5, '"b,"', 
                                        abcd_colour, abcd_size, 0,
                                      20, 90406.5, '"*"', 
                                        stage_colour, star_size, 0,
                                      23, 90393, 'c', 
                                        abcd_colour, abcd_size, 0,
                                      61, 90391, '"^"', 
                                        stage_colour, hat_size, 0,
                                      67, 90395, '"d"', 
                                        abcd_colour, abcd_size, 0,
                                      68, 90433, 'bold("_")',
                                        stage_colour, bar_size, 0,
                                      68, 90467, '"~"', 
                                        stage_colour, tilde_size, 0,
                                      0, 90405, 'Hyperconservation', 
                                        annotation_colour, 
                                        annotation_size - 1,
                                        lamp_Re_label_angle,
                                      16, 90425, 'Re[tot] == 0*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                     6, 90422, paste0("Re[empl] == '", Re_empl_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle,
                                      1, 90444.2, 'Re[sub]', 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      6, 90440.5, paste0("'", Re_sub_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      24, 90450, 'Re[inc]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      29, 90446, paste0("'", Re_inc_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      86, 90425.7, 'Re[macro]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      91, 90421, paste0("'", Re_macro_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      202, 90450, 'Re[tot] == 100*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      105, 90432, paste0("Re[tot] == '", Re_tot_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      230, 90457, 'Backfire',
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle)

lamp_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                  -6, 90440, lamp_Re_arrow_angle, 18.8, annotation_colour, example_arrow_size, # Re_sub arrow
                                  13, 90444.35, lamp_Re_arrow_angle, 30, annotation_colour, example_arrow_size, # Re_inc arrow
                                  74, 90420, lamp_Re_arrow_angle, 30, annotation_colour, example_arrow_size) # Re_macro arrow

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Energy") + 
  ggplot2::geom_spoke(data = lamp_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = lamp_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<LampCostGraph, echo = FALSE, fig.cap="Expenditure plane for the lamp example. CV is compensating variation, the increase in consumption of the energy service and decrease in consumption of other goods and services to maintain constant utility. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
lamp_cost_line_angle <- -23.6
lamp_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                    8.6, 27921.7, 'degree', 
                                      stage_colour, orig_size, 0,
                                    0.85, 27921.7, 'a', 
                                      abcd_colour, abcd_size, 0,
                                    1.05, 27920.7, '"b"', 
                                      abcd_colour, abcd_size, 0,
                                    0.75, 27920, '"*"',
                                      stage_colour, star_size, 0,
                                    0.8, 27916.5, 'c', 
                                      abcd_colour, abcd_size, 0,
                                    2.2, 27915.7, '"^"', 
                                      stage_colour, hat_size, 0,
                                    2.36, 27916.5, 'd', 
                                      abcd_colour, abcd_size, 0,
                                    2.45, 27927.7, 'bold("_")', 
                                      stage_colour, bar_size, 0,
                                    5.25, 27925, 'Original~expenditure',
                                      annotation_colour, annotation_size, lamp_cost_line_angle,
                                    3.75, 27917.2, 'After~emplacement',
                                      annotation_colour, annotation_size, lamp_cost_line_angle,
                                    1.54, 27917.3, 'After~CV',
                                      annotation_colour, annotation_size-1, lamp_cost_line_angle,
                                    4.1, 27918.6, 'After~expected~savings',
                                      annotation_colour, annotation_size, lamp_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Expenditure") + 
  ggplot2::geom_text(data = lamp_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  ggplot2::scale_x_continuous(breaks = seq(2, 8, by = 2)) +
  ggplot2::scale_y_continuous(breaks = seq(27916, 27928, by = 2)) +

  MKHthemes::xy_theme()
@


<<LampConsGraph, echo=FALSE, warning=FALSE, fig.cap="Consumption plane for the lamp example. See Table~\\ref{tab:path_graph_segments} for meanings of path segments.", fig.width=6, fig.height=4, fig.align = "center">>=
lamp_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                     1.05, 1.00002, 'degree', 
                                       stage_colour, orig_size,
                                     1.097, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.155, 1.000019, 'a', 
                                       abcd_colour, abcd_size,
                                     1.2, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.26, 1.0000195, 'b', 
                                       abcd_colour, abcd_size,
                                     1.3, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.37, 1.000001, '"*"', 
                                       stage_colour, star_size,
                                     0.7, 1.000074, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     1.57, 0.999811, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     0.7, 0.999988, '"*"', 
                                       line_label_colour, star_line_label_size,
                                     3.5, 0.999897, '"*"',
                                       line_label_colour, star_line_label_size,
                                     0.96, 0.99984, 'c', 
                                       abcd_colour, abcd_size,
                                     2.4, 0.999825, '"^"',
                                       stage_colour, hat_size,
                                     0.7, 0.999892, '"^"',
                                       line_label_colour, hat_line_label_size,
                                     3.4, 0.999804, '"^"', 
                                       line_label_colour, hat_line_label_size,
                                     2.49, 0.999865, 'd',
                                       abcd_colour, abcd_size,
                                     2.5, 1.00027, 'bold("_")', 
                                       stage_colour, bar_size,
                                     0.7, 1.000305, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     3.5, 1.000215, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     2.46, 0.9998, 'r', 
                                       abcd_colour, r_line_label_size,
                                     2.46, 1.0004, 'r',
                                       abcd_colour, r_line_label_size,
                                     0.75, 1.00016, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     3.4, 0.99985, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     1.21, 1.00038, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     3.4, 1.000255, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Consumption") + 
    ggplot2::geom_text(data = lamp_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.99979, 1.0004) +
  MKHthemes::xy_theme()
@


<<lamp_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:lamp_results", 
                                      caption = "Lamp example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion}
\label{sec:discussion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%++++++++++++++++++++++++++++++
\subsection{A first attempt at calibrating $k$}
\label{sec:calibrating_k}
%++++++++++++++++++++++++++++++

<<Calibrate_k, echo = FALSE>>=
Re_tot_expected <- 0.54
calibrated_k <- rebound_results %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::calibrate_k(Re_tot_expected)

# Land on k = 3 as a median value.
# Do a sensitivity study with those k values to recalculate everything.
k_cal_vals <- list(Car = list(k = 3),
                   Lamp = list(k = 3))

rebound_analysis_with_cal_k <- rebound_data %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::parametric_analysis(parameterization = k_cal_vals,
                                    include_orig_point = FALSE)
Re_macro_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_macro")
Re_macro_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_macro")
Re_tot_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_tot")
Re_tot_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_tot")
@

Few rebound studies have explored the macroeconomic level
between microeconomic and total rebound.
Inspired by \citet{Borenstein:2015aa} and others, 
the framework developed in Section~\ref{PartI-sec:framework} of Part~I
links macroeconomic rebound to microeconomic rebound 
via the macro factor~($k$) that scales
magnitudes in the microeconomic portion of the framework. 
(See Section~\ref{PartI-sec:macro_effect_main_paper} of Part~I.)

For the results presented in Section~\ref{sec:results} of this paper, 
we assumed a placeholder value of $k = 1$,
meaning that every \$1 of spending by the device owner in the income effect
generates only \$1 of additional economic activity in the broader economy.
In combination, the framework presented in Section~\ref{PartI-sec:framework} of Part~I, 
the results obtained in Section~\ref{sec:results} of this paper, and
recent calculations of total rebound in general equilibrium frameworks allow, 
for the first time, 
a discussion about calibrating $k$.
After calibrating $k$, 
macro rebound and total rebound can be calculated.

To calibrate the macro factor ($k$),
we treat macro rebound ($Re_{\macro}$) as a residual.
The macro factor ($k$) becomes an unknown parameter whose value is to be chosen
such that $Re_{\macro}$
is sufficient to achieve an expected value for total rebound ($Re_{tot}$).%
\footnote{
  This approach means that the calibrated value of $k$ incorporates all 
  macroeconomic rebound sub-effects included in the studies
  whose total rebound value we calibrate against.
}
%
We take the expected value for $Re_{tot}$ from 
\citet{Brockway:2021ww}.
Four of 33 studies reviewed by \citet{Brockway:2021ww}
examined total rebound from only consumer EEUs in a computable general
equilibrium (CGE) framework. 
The average total rebound ($Re_{tot}$) 
for the four consumer studies is \Sexpr{Re_tot_expected*100}\%.%
\footnote{
  The average total rebound among all 33 studies stood at 63\%,
  supporting the claim by \citet{Turner:2013aa} that consumer
  and producer rebounds vary.
}
%
The calibrated values of $k$ that give identical 
$Re_{tot} = \Sexpr{Re_tot_expected*100}$\% 
for both examples are
$k = \Sexpr{formatC(calibrated_k[["Car"]], digits = 2)}$
for the car example and
$k = \Sexpr{formatC(calibrated_k[["Lamp"]], digits = 2)}$ 
for the lamp example.

Qualitative differences in benefits from EEUs as well as the considerable 
variance in $Re_{tot}$ in 33 surveyed studies~\citep{Brockway:2021ww}
indicates that total rebound from one EEU is likely to be different from 
total rebound from another EEU. 
For a first approximation of a calibration for $k$,
we take $k \approx 3$,
being between the values of $k$ 
calculated from the car and lamp examples.
Note that $k \approx 3$ implies that 
every \$1 of net savings spent by the device owner
generates \$3 of economic 
activity in the broader economy
due to the income effect.
We multiply $k \raempl{N}$ by the energy intensity of the economy ($I_E$) to 
find the energy implications of macro-effect respending throughout the economy.

There are three ways to interpret $k \approx 3$.
First, $k \approx 3$ can be considered the average long-run 
economic growth generated by the device owner's spending of freed cash.
Efficiency increases in equipment drive a significant part of 
long-run productivity growth \citep{Greenwood1997}, therefore a large
long-run multiplier is plausible,
even if the initial productivity
change occurred in household production which is not accounted in GDP.
(See Section~\ref{PartI-sec:macro_effect_main_paper} of Part~I 
for further discussion of this point.)
Second, it could be that growth is less than 
\$3 for every \$1 of respending,
but that the macroeconomic ``energy price effect'' (a decline in 
energy prices due to the fallen demand) induces consumption at a higher
energy intensity than that of the pre-EEU economy. 
Third, from the demand-side perspective
entertained by \citet{Borenstein:2015aa}, 
$k \approx 3$ could be interpreted as 
a marginal propensity to consume (MPC)
of approximately $0.75$. 
(See Fig.~\ref{PartI-fig:k_vs_mpc} 
in Appendix~\ref{PartI-sec:income_macro_mpc} of Part~I.)
$\MPC \approx 0.75$ is a reasonable value, 
being in the upper half of recent estimates from \citet{Carroll2017}.
Although the cause of the growth in economic activity and energy consumption from an EEU 
is a supply-side productivity shock,
the subsequent demand-side effects may well be interpreted as a multiplier effect, 
caused by higher real income instead of by higher monetary income.

After calibrating $k \approx 3$, 
we can calculate all rebound components in our framework.
Emplacement ($Re_{empl}$), substitution ($Re_{sub}$), and income ($Re_{inc}$) rebound
magnitudes are unchanged after calibrating $k \approx 3$.
However, we see that choosing a placeholder value of $k = 1$
resulted in a low value for $Re_{\macro}$ and, therefore, $Re_{tot}$
in Section~\ref{sec:results}.
In Figs.~\ref{fig:CarEnergyGraph} and~\ref{fig:LampEnergyGraph},
the macro effect segments (\bartilde{})
should be three times longer than they appear.
In Tables~\ref{tab:car_results} and~\ref{tab:lamp_results},
the values of macro rebound ($Re_{\macro}$) should triple to
\Sexpr{formatC(Re_macro_car_k_3*100, digits = 3)}\% and
\Sexpr{formatC(Re_macro_lamp_k_3*100, digits = 3)}\%, and
the values of total rebound ($Re_{tot}$) should increase to 
\Sexpr{sprintf("%.1f", round(Re_tot_car_k_3*100, 1))}\% and
\Sexpr{formatC(Re_tot_lamp_k_3*100, digits = 3)}\%
for the car and lamp examples,
respectively.
For the rest of this paper, 
we use the calibrated value of $k \approx 3$.


%++++++++++++++++++++++++++++++
\subsection{Comparison between the car and lamp case studies}
\label{sec:case_study_comparison}
%++++++++++++++++++++++++++++++

<<Formatters, include=FALSE>>=
# Functions to extract and format numbers for rebound calculations below.
# The goal of these functions is to provide a short function call 
# to fit into the table nicely.
f_car <- function(Re_name) {
  rebound_analysis_with_cal_k %>% 
    dplyr::filter(.data[["Case"]] == "Car") %>% 
    magrittr::extract2(Re_name) %>% 
    magrittr::multiply_by(100) %>% 
    formatC(format = "f", digits = 1)
}
f_lmp <- function(Re_name) {
  rebound_analysis_with_cal_k %>% 
    dplyr::filter(.data[["Case"]] == "Lamp") %>% 
    magrittr::extract2(Re_name) %>% 
    magrittr::multiply_by(100) %>% 
    formatC(format = "f", digits = 1)
}
@

Tables~\ref{tab:car_results} and~\ref{tab:lamp_results}
and our calibration of $k \approx 3$ in Section~\ref{sec:calibrating_k} 
enable fuller comparisons between the car and lamp examples. 
Several points can be made.

First, 
the magnitude of every rebound effect is different between the two examples, 
the exception being direct emplacement rebound ($Re_{dempl}$)
which is always 0.0 by definition.
The implication is that every EEU needs to be analyzed separately. 
Values for rebound effects  
for one EEU should never be assumed to apply to a different EEU.

Second, 
one cannot know \emph{a-priori} which rebound effects
will be large and which will be small
for a given EEU.
Furthermore, some rebound effects are dependent upon economic parameters,
such as energy intensity ($I_E$).
Thus, it is important to calculate the magnitude of all rebound effects 
for each EEU in each economy.

Third,
the two examples illustrate the fact that 
embodied energy rebound ($Re_{emb}$) can be positive or negative,
as discussed in Section~\ref{PartI-sec:empl_effect_main_paper} of Part~I.
The car's embodied energy rebound is positive ($\Sexpr{f_car("Re_emb")}$\%) 
because of the high embodied energy of the EV's battery
relative to the internal combustion engine vehicle. 
Although the LED lamp's embodied energy is larger than the 
incandescent lamp's embodied energy, 
the LED lamp's embodied energy rebound is negative ($\Sexpr{f_lmp("Re_emb")}$\%),
due to the longer life of the LED lamp compared to the incandescent lamp.
Thus, each EEU should be analyzed independently for its embodied energy rebound.

Fourth,
macro effect rebound is quite different between the two examples, 
owing to differences in freed cash.
(For the car, $Re_{macro}$ is $\Sexpr{f_car("Re_macro")}$\%.
For the lamp, $Re_{macro}$ is $\Sexpr{f_lmp("Re_macro")}$\%.)
The efficiency gain for the lamp is far greater than the efficiency gain for the car,
leading to much different rates of net income ($\raempl{N}$) and
different macro rebound values.

% I think there is really no claim in this.
% Fifth,
% in both examples the macro effect rebound ($Re_{macro}$) is much larger than
% any single micro rebound component. 
% However, the sum of micro rebound components 
% ($Re_{micro} = Re_{empl} + Re_{sub} + Re_{inc}$) 
% is close in magnitude to the macro rebound ($Re_{macro}$).
% These observations are likely to be the result of 
% $Re_{macro}$ being the sum of several macroeconomic sub-effects,
% among which we don't discriminate in this framework.
% (See Table~\ref{PartI-tab:rebound_typology} in Part~I
% for a list of macro rebound effects.)


%++++++++++++++++++++++++++++++
\subsection{Comparison to previous rebound estimates} 
\label{sec:comparison_to_other_rebound_estimates}
%++++++++++++++++++++++++++++++

Tables~\ref{tab:rebound_car_comparisons} and~\ref{tab:rebound_lamp_comparisons}
compare car and lamp results (with $k \approx 3$) to 
results from previous studies.
% For punctuation of "rather" here, see https://linguaholic.com/linguablog/comma-before-rather/.
The comparison studies in Tables~\ref{tab:rebound_car_comparisons} and~\ref{tab:rebound_lamp_comparisons}
are neither comprehensive nor definitive of car and lamp EEUs;
rather, they are examples
that show the sort of calculations and estimations 
carried out in the general literature using a variety of methods.
That said, many of the comparison studies are highly cited in their field
and carry reasonable academic weight suitable for our purposes. 
Tables~\ref{tab:rebound_car_comparisons} and~\ref{tab:rebound_lamp_comparisons}
and their associated references 
enable two types of observations: 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item on the coverage of rebound components, and
  
  \item on their magnitudes and associated calculation or estimation methods.
    
\end{enumerate*}

<<CarLiteratureComparisonTable, child="pieces/Re_car_comparison_table.Rnw">>=
@

<<LampLiteratureComparisonTable, child="pieces/Re_lamp_comparison_table.Rnw">>=
@

First, we can say that none of the comparison studies
report all rebound effects, as we have done
in Sections~\ref{sec:car_example}, \ref{sec:lamp_example}, and~\ref{sec:calibrating_k}. 
Further, none of the studies report 
emplacement rebound ($Re_{empl} = Re_{emb} + Re_{\md}$).
None of the other studies includes
all of direct and indirect, substitution and income microeconomic rebound effects, and
none of the other studies report macro rebound ($Re_{macro}$) by itself.
In fact, only 4 or 5 of the 10 studies
in each category (car and lamp, respectively) report total rebound ($Re_{tot}$).
By carefully including all rebound components in the framework and by 
elucidating all rebound components in Part~II, 
we are adding conceptual clarity to the field of energy rebound.

We also observe that studies that provide total rebound 
are based on a top-down calculation of overall, economy-wide rebound, 
rather than a bottom-up ``sum-of-components'' approach 
that we employ.
That finding is instructive---it supports the view that
a comprehensive framework that sets out individual rebound components
has been missing---and something that informed the objective for Part~I of this paper.
Top-down estimations or calculations of total, economy-wide rebound 
may also inhibit comparison, 
because the effects included or excluded 
may not be clear, 
giving an appearance of a ``black box'' calculation approach.
That said, without the top-down approaches,
we would not have the information needed to calibrate 
the macro factor ($k$) in Section~\ref{sec:calibrating_k}.

Second, helpful insights can be gained
from comparison of rebound magnitudes and calculation methods.
Greatest alignment between our values and earlier values for rebound magnitudes
appears within the direct (microeconomic) rebound ($Re_{dir}$).
Our car ($\Sexpr{f_car("Re_dir")}$\%) and lamp ($\Sexpr{f_lmp("Re_dir")}$\%) values
are in the lower half of the comparison studies
for both the case of the car (10\% to 49\%) and lamp (10\% to 55\%).
This alignment may be due to the easier determination
of direct rebound, from either empirical data
(e.g., \citet{Small:2005aa}) or
via own price elasticities (e.g., \citet{Chitnis:2015}).
The empirical data approach appears to give lower rebound values,
closer to our values.

For indirect (microeconomic) rebound ($Re_{indir}$),
there is little agreement on the magnitude of rebound effects.
Our values for 
car ($\Sexpr{f_car("Re_indir")}$\%) and 
lamp ($\Sexpr{f_lmp("Re_indir")}$\%) rebound magnitudes
are higher than those found in the comparison studies
for either the car (6\% to 23\%) or lamp (8\% to 16\%) cases.
The most likely cause of our larger indirect rebound values
is that we include both micro and macro rebound levels,
whereas the comparison studies 
focus mainly on microeconomic rebound only
(commonly via cross price elasticities).
In other words, 
comparisons of our indirect rebound values with the comparison studies
may be too simple and not very meaningful,
as we include macro-level effects in indirect rebound. 

For total rebound ($Re_{tot}$),
our values of
$\Sexpr{f_car("Re_tot")}$\% (car) and
$\Sexpr{f_lmp("Re_tot")}$\% (lamp)
are very close to the comparison studies for the car example (49\% to 51\%), but
nearly double the values from the comparison studies for the lamp example (43\% to 51\%).
Beyond that, comparisons (as noted earlier) are inhibited
by methodological differences between previous studies (top-down methods)
and our bottom up approach for calculating total rebound.


%++++++++++++++++++++++++++++++
% \subsection{Implications for CO$_2$ emissions}
% \label{sec:implications_for_CO2}
%++++++++++++++++++++++++++++++

% **** 
% This section is a response to Referee 1.
% Do we like it/want to keep it?
% Is it in the right location? ---MKH
% ****
% 
% To the extent that energy rebound takes back energy savings
% from EEUs, 
% it is a threat to a low carbon future,
% as noted by \citet{van-den-Bergh:2017aa} and \citet{Brockway:2017a}.
% However, the results above highlight 
% two aspects that make it difficult to determine
% the precise impact of rebound on CO$_2$ emissions.
% 
% First, we see that rebound is measured at the final energy stage,
% while CO$_2$ emissions are the result of
% primary energy consumption (coal, oil, natural gas, wind, solar, hydro, etc.).
% Determining the CO$_2$ implications of rebound requires
% untangling the amount of each primary energy source 
% associated with each type of final energy consumed.
% Such untangling will be different for each economy.
% Furthermore, this untangling would need to be accomplished
% for each rebound effect, something that is
% beyond the scope of this framework.
% 
% Second, we note that the various rebound effects take place 
% at different times throughout the life of a device.
% E.g., the emplacement effect ($Re_{empl}$) includes 
% embodying of energy during manufacture and distribution, 
% but its rebound effect ($Re_{emb}$) also takes account of device longevity.
% The emplacement effect also includes maintenance and disposal 
% activities ($Re_{\md}$); 
% maintenance occurs throughout the life of the device, but  
% disposal occurs at end of life.
% The macro effect also occurs occurs throughout the life of the device, but
% it depends on the magnitude of adjustments
% in the substitution and income effects.
% It will be difficult to know, \emph{a-priori},
% the source primary energies for each adjustment
% for each rebound effect
% during societal energy transitions.
% 
% Thus, further work will be required to utilize 
% this rebound framework
% (and other frameworks that aspire to describe both direct and indirect rebound effects)
% for precise determination of the CO$_2$ emissions impacts of rebound.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this paper (Part~II), we add clarity to the field of energy rebound
by 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item developing of the first (to our knowledge) 
        visualizations of rebound effects
        in energy, expenditure, and consumption spaces 
        
  \item documenting new calculations of rebound for automobile and lighting  
        upgrades, and 
        
  \item creating open source software tools to calculate and visualize rebound 
        for any energy efficiency upgrade.
  
\end{enumerate*}
%
We encourage energy analysts and economists to use visualizations
like the energy, expenditure, and consumption 
rebound planes to document rebound calculations going forward.
Our hope is that additional clarity will 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item narrow the gap between economists and energy analysts,
  
  \item lead to deeper interdisciplinary understanding of rebound phenomena, and
  
  \item enable energy and climate policy
        that takes full account of rebound.

\end{enumerate*}

From the development and application of the framework in Part~II, 
we draw two important conclusions.
First, the car and lamp examples (Section~\ref{sec:results}) show that
        the framework enables
        quantification of rebound magnitudes at microeconomic and macroeconomic levels, including 
        energy, expenditure, and consumption aspects of 
        direct and indirect rebound 
        for emplacement, substitution, income, and macro effects.
Second, the examples show that magnitudes of all rebound effects
        vary with the type of EEU performed.

Further work could be pursued in several areas. 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item Additional empirical studies could be performed
        to calculate the magnitude of different 
        rebound effects in a variety of real-life EEUs.

  \item Deeper study of macro rebound is needed, including improved determination 
        of values of the macro factor ($k$) and its relation to the MPC.
        
  \item The rebound implications of the distribution of $\MPC$ values 
        across socioeconomic groups~\citep{Carroll2017}
        could be explored.
        
  \item The rebound effects of fossil-energy taxes 
        could be studied,
        especially for the web of interconnected dynamic effects
        among rebound components that are functions
        of the energy intensity of the economy ($I_E$).
        
  \item Sensitivities of rebound components to model parameters
        could be investigated more fully 
        than in Appendix~\ref{sec:sensitivity_analyses}, although
        this will be challenging work because
        many rebound parameters are covariant.
        For example, post-EEU efficiency ($\amacro{\eta}$)
        is unlikely to be independent of post-EEU capital cost ($\amacro{C}_{cap}$).

  \item This framework could be embedded 
        in energy-economy models to better include rebound effects 
        in discussions of macro energy modeling, energy policy, and 
        CO$_2$ emissions mitigation.
        
\end{enumerate*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Competing interests}
\label{sec:competing_interests}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Declarations of interest: none.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Author contributions}
\label{sec:author_contributions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Author contributions for this paper (Part~II of the two-part paper) are shown in Table~\ref{tab:credit2}.

\begin{table}[h]
\begin{center}
\caption{Author contributions.} 
\begin{tabular}{r c c c}
  \toprule
                              & MKH          & GS           & PEB          \\
  \midrule
  Conceptualization           & \rating{100} & \rating{100} &              \\
  Methodology                 & \rating{100} & \rating{100} & \rating{100} \\
  Software                    & \rating{100} &              & \rating{100} \\
  Validation                  & \rating{100} &              & \rating{100} \\
  Formal analysis             & \rating{100} & \rating{100} &              \\
  Investigation               & \rating{100} & \rating{100} & \rating{100} \\
  Resources                   & \rating{100} & \rating{100} & \rating{100} \\
  Data curation               &              &              & \rating{100} \\
  Writing--original draft     & \rating{100} & \rating{100} &              \\
  Writing--review \& editing  & \rating{100} & \rating{100} & \rating{100} \\
  Visualization               & \rating{100} & \rating{100} &              \\
  Supervision                 & \rating{100} &              &              \\
  Project administration      & \rating{100} &              &              \\
  Funding acquisition         &              &              & \rating{100} \\
\bottomrule
\end{tabular}
\label{tab:credit2}
\end{center}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data repository}
\label{sec:data_repository}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Data and example calculations in spreadsheet format are stored at the
Research Data Leeds Repository
(\url{https://doi.org/10.5518/1201}).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
\label{sec:acknowledgements}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%List funding sources in this standard way to facilitate compliance to funder's requirements: Funding: This work was supported by the National Institutes of Health [grant numbers xxxx, yyyy]; the Bill \& Melinda Gates Foundation, Seattle, WA [grant number zzzz]; and the United States Institutes of Peace [grant number aaaa].

%It is not necessary to include detailed descriptions on the program or type of grants and awards. When funding is from a block grant or other resources available toa university, college, or other research institution, submit the name of the institute or organization that provided the funding.

%If no funding has been provided for the research, please include the following sentence: This research did not receive any specific grant from funding agencies  in the public, commercial, or not-for-profit sectors.

Paul Brockway’s time was funded by the UK Research and Innovation (UKRI) 
Council, supported under EPSRC Fellowship award EP/R024254/1.
The authors benefited from discussions with 
Daniele Girardi (University of Massachusetts at Amherst) and 
Christopher Blackburn (Bureau of Economic Analysis).
The authors are grateful for comments from internal reviewers
Becky Haney and Jeremy Van Antwerp (Calvin University); 
Nathan Chan (University of Massachusetts at Amherst); and 
Zeke Marshall (University of Leeds).
The authors appreciate the many constructive comments 
on a working paper version of this article from 
Jeroen C.J.M.\ van den Bergh (Vrije Universiteit Amsterdam),
Kenneth Gillingham (Yale University), 
Harry Saunders (Carnegie Institution for Science), and
David Stern (Australian National University).
Finally, the authors thank the students of MKH's Fall 2019 
Thermal Systems Design course (ENGR333) at Calvin University
who studied energy rebound for many energy conversion devices
using an early version of this framework.

% No need for this section label, because BibTeX already provides a "References" heading.
% \section*{References}

{
\scriptsize
\bibliography{HSB_refs}
}


\appendix
\counterwithin{figure}{section}
\counterwithin{table}{section}

% Gives a helpful "Appendices" label
\section*{Appendices}

% Labels each appendix as A, B, C, etc. instead of Appendix A, Appendix B, Appendix C, etc.
\renewcommand{\thesection}{\Alph{section}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nomenclature}
\label{sec:nomenclature}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/nomenclature_results.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mathematical details of rebound planes}
\label{sec:graph_details}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/rebound_path_graph_details.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Univariate sensitivity analyses}
\label{sec:sensitivity_analyses}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%t

<<SensitivityAppendix, child="pieces/sensitivity.Rnw">>=
@


\end{document}
